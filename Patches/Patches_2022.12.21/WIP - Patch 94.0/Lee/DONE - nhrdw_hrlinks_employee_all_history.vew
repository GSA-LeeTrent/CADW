USE new_hrdw;
           	                         
 CREATE OR REPLACE VIEW `new_hrdw`.`nhrdw_hrlinks_employee_all_history` AS select `job`.`EMPLID` AS `EMPLID`,`job`.`EMPL_RCD` AS `EMPL_RCD`,`job`.`EFFSEQ` AS `EFFSEQ`,`job`.`EFFDT` AS `EFFDT`,`job`.`GVT_WIP_STATUS` AS `GVT_WIP_STATUS`,`job`.`GVT_NOA_CODE` AS `GVT_NOA_CODE`,`job`.`GVT_STATUS_TYPE` AS `GVT_STATUS_TYPE`,`job`.`GVT_SF52_NBR` AS `GVT_SF52_NBR`,`job`.`EMPL_STATUS` AS `EMPL_STATUS`,`job`.`SETID_DEPT` AS `SETID_DEPT`,`pers`.`NAME` AS `NAME`,`job`.`POSITION_ENTRY_DT` AS `POSITION_ENTRY_DT`,`job`.`POSITION_NBR` AS `POSITION_NBR`,`job`.`REPORTS_TO` AS `REPORTS_TO`,`job`.`GVT_STEP` AS `GVT_STEP`,`job`.`GVT_PAY_PLAN` AS `GVT_PAY_PLAN`,`bemail`.`EMAIL_ADDR` AS `EMAIL_ADDR`,coalesce(`empl`.`REHIRE_DT`,`empl`.`HIRE_DT`) AS `LATEST_HIRE_DATE` from ((((`new_hrdw`.`ps_gvt_job` `job` join `new_hrdw`.`ps_gvt_pers_data` `pers` on(((`pers`.`EMPLID` = `job`.`EMPLID`) and (`pers`.`EMPL_RCD` = `job`.`EMPL_RCD`) and (`pers`.`EFFSEQ` = `job`.`EFFSEQ`) and (`pers`.`EFFDT` = `job`.`EFFDT`)))) join `new_hrdw`.`ps_gvt_pers_nid` `nid` on(((`nid`.`EMPLID` = `job`.`EMPLID`) and (`nid`.`EMPL_RCD` = `job`.`EMPL_RCD`) and (`nid`.`EFFSEQ` = `job`.`EFFSEQ`) and (`nid`.`EFFDT` = `job`.`EFFDT`)))) join `new_hrdw`.`ps_gvt_employment` `empl` on(((`empl`.`EMPLID` = `job`.`EMPLID`) and (`empl`.`EMPL_RCD` = `job`.`EMPL_RCD`) and (`empl`.`EFFSEQ` = `job`.`EFFSEQ`) and (`empl`.`EFFDT` = `job`.`EFFDT`)))) left join `new_hrdw`.`ps_email_addresses` `bemail` on(((`bemail`.`EMPLID` = `job`.`EMPLID`) and (`bemail`.`E_ADDR_TYPE` = 'BUSN')))) where (`job`.`GVT_WIP_STATUS` in ('PRO','COR','INI','REQ'));