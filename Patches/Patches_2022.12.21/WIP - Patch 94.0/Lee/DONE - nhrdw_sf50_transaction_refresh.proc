DROP PROCEDURE IF EXISTS new_hrdw.nhrdw_sf50_transaction_refresh;

DELIMITER $$
CREATE DEFINER=`HRDWCORPDATA`@`%` PROCEDURE `nhrdw_sf50_transaction_refresh`()
begin

                      DECLARE l_rowcount BIGINT DEFAULT 0;
  

                      truncate table NHRDW_SF50_TRANSACTION;

                      truncate table NHRDW_SF50_DERIVE_EMPL_STATUS;
                      
                      truncate table NHRDW_PERSONNEL_ACTION;   

                      truncate table NHRDW_PERSONNEL_ACTION_POSITION_INFO;
                      
                      truncate table nhrdw_personnel_action_org_and_loc_info;   

                      truncate table nhrdw_personnel_action_additional_info;   
                      

                      
                                             
       -- Identify Same Day Prior Actions


                      call nhrdw_process_log_trk (-7001, 'I', 'Refresh SF50 Transaction : Identify Same Day Prior Actions' );
	  
                      INSERT INTO NHRDW_SF50_TRANSACTION
                      (
                       EMPLID                        
                      ,EMPL_RCD                      
                      ,EFFDT                         
                      ,EFFSEQ   
                      ,SETID_DEPT
                      ,ACTION_EFFDT                     
                      ,ACT_STATUS                    
                      ,GVT_NOA_CODE  
                      ,FIRST_NOA_CODE    
                      ,SECOND_NOA_CODE   
                      ,GVT_NOA_DESCR     
                      ,EMPL_JOB_STATUS           
                      ,GVT_WIP_STATUS           
                      ,GVT_STATUS_TYPE               
                      ,DEPTID                        
                      ,JOBCODE                       
                      ,POSITION_NBR                  
                      ,EMPL_STATUS  
                      ,COMPANY        
                      ,GVT_SUB_AGENCY   
                      ,GVT_SUBELEMENT_CODE                       
                      ,ACT_PR_EFFDT                  
                      ,ACT_PR_EFFSEQ                 
                      ,ACT_PR_GVT_NOA_CODE           
                      ,ACT_PR_GVT_WIP_STATUS         
                      ,ACT_PR_GVT_STATUS_TYPE        
                      ,ACT_PR_DEPTID                 
                      ,ACT_PR_JOBCODE                
                      ,ACT_PR_POSITION_NBR           
                      ,ACT_PR_EMPL_STATUS 
                      ,ACT_PR_COMPANY        
                      ,ACT_PR_GVT_SUB_AGENCY  
                      ,ACT_PR_GVT_SUBELEMENT_CODE
                      ,CHANGE_IN_SUBELEMENT_CODE
                      ,CHANGE_IN_DEPT
                      ,DISABILITY_VETERAN_LEAVE_BEGIN_DATE         
                      ,DISABILITY_VETERAN_LEAVE_END_DATE         
                      ,TRANSACTION_STATUS           
                      ,SUPV_LVL_ID
                      ,ACT_PR_SUPV_LVL_ID
                      ,CHANGE_IN_SUPV_LVL_ID
                      ,ACT_PR_EMPL_JOB_STATUS
                      ,CHANGE_EMPL_JOB_STATUS                      
                      )
                      SELECT    
                        ACT.EMPLID              EMPLID        
                      , ACT.EMPL_RCD            EMPL_RCD      
                      , ACT.EFFDT               EFFDT          
                      , ACT.EFFSEQ              EFFSEQ 
                      , ACT.SETID_DEPT   
                      , CASE WHEN ACT.GVT_NOA_CODE LIKE '3%' THEN DATE_ADD(ACT.EFFDT, INTERVAL -1 DAY )  ELSE  ACT.EFFDT  END     
                      , 'SAMEDAY'               ACT_STATUS     
                      , ACT.GVT_NOA_CODE        GVT_NOA_CODE  
                      , CASE WHEN ACT.GVT_WIP_STATUS = 'COR' THEN '002' ELSE ACT.GVT_NOA_CODE END  FIRST_NOA_CODE
                      , CASE WHEN ACT.GVT_WIP_STATUS = 'COR' THEN  ACT.GVT_NOA_CODE ELSE NULL END  SECOND_NOA_CODE
                      , CONCAT(COALESCE(GVNOA.DESCR25,' ') ,' ',COALESCE(GVNOA.DESCR25_2,' ')) GVT_NOA_DESC  
                      , nhrdw_get_empl_job_status ( ACT.GVT_NOA_CODE, ACT_PR.GVT_NOA_CODE ,ACT.GVT_LEG_AUTH_1,ACT.GVT_LEG_AUTH_2,ACT.EMPL_STATUS)
                      , ACT.GVT_WIP_STATUS      GVT_WIP_STATUS
                      , ACT.GVT_STATUS_TYPE     GVT_STATUS_TYPE
                      , ACT.DEPTID              DEPTID        
                      , ACT.JOBCODE             JOBCODE      
                      , ACT.POSITION_NBR        POSITION_NBR  
                      , ACT.EMPL_STATUS         EMPL_STATUS  
                      , ACT.COMPANY             COMPANY        
                      , ACT.GVT_SUB_AGENCY      GVT_SUB_AGENCY  
                      , concat(ACT.COMPANY,ACT.GVT_SUB_AGENCY)   GVT_SUBELEMENT_CODE      
                      , ACT_PR.EFFDT            ACT_PR_EFFDT          
                      , ACT_PR.EFFSEQ           ACT_PR_EFFSEQ    
                      , ACT_PR.GVT_NOA_CODE     ACT_PR_GVT_NOA_CODE    
                      , ACT_PR.GVT_WIP_STATUS   ACT_PR_GVT_WIP_STATUS  
                      , ACT_PR.GVT_STATUS_TYPE  ACT_PR_GVT_STATUS_TYPE  
                      , ACT_PR.DEPTID           ACT_PR_DEPTID          
                      , ACT_PR.JOBCODE          ACT_PR_JOBCODE          
                      , ACT_PR.POSITION_NBR     ACT_PR_POSITION_NBR    
                      , ACT_PR.EMPL_STATUS      ACT_PR_EMPL_STATUS      
                      , ACT_PR.COMPANY          ACT_PR_COMPANY           
                      , ACT_PR.GVT_SUB_AGENCY   ACT_PR_GVT_SUB_AGENCY  
                      , concat(ACT_PR.COMPANY,ACT_PR.GVT_SUB_AGENCY)   ACT_PR_GVT_SUBELEMENT_CODE
                      , nhrdw_get_change_in_subelement_code (concat(ACT.COMPANY,ACT.GVT_SUB_AGENCY)  , concat(ACT_PR.COMPANY,ACT_PR.GVT_SUB_AGENCY) ) CHANGE_IN_SUBELEMENT_CODE
                      , nhrdw_get_change_in_dept (ACT.DEPTID , ACT_PR.DEPTID )  CHANGE_IN_DEPT 
                      , CASE WHEN ACT.GVT_NOA_CODE LIKE '982' THEN ACT.EFFDT ELSE NULL END  
                      , CASE WHEN ACT.GVT_NOA_CODE LIKE '982' THEN DATE_ADD(DATE_ADD(ACT.EFFDT, INTERVAL 1 YEAR ), INTERVAL -1 DAY ) ELSE  NULL  END          
                      ,'COMPLETED' TRANSACTION_STATUS
                      ,topos.SUPV_LVL_ID           SUPV_LVL_ID
                      ,frpos.SUPV_LVL_ID        ACT_PR_SUPV_LVL_ID
                      ,nhrdw_get_change_in_supv_lvl_id(topos.SUPV_LVL_ID , frpos.SUPV_LVL_ID )  CHANGE_IN_SUPV_LVL_ID    
                      ,nhrdw_get_empl_job_status ( ACT_PR.GVT_NOA_CODE, ACT_PR.GVT_NOA_CODE ,ACT_PR.GVT_LEG_AUTH_1,ACT_PR.GVT_LEG_AUTH_2,ACT_PR.EMPL_STATUS) 
                      ,case when nhrdw_get_empl_job_status ( ACT.GVT_NOA_CODE, ACT_PR.GVT_NOA_CODE ,ACT.GVT_LEG_AUTH_1,ACT.GVT_LEG_AUTH_2,ACT.EMPL_STATUS) != 'Prior Status' Then 'Y' Else 'N' End
                      from  PS_GVT_JOB ACT
                      join  PS_GVT_JOB ACT_PR ON    
                                       ACT.EMPLID       = ACT_PR.EMPLID
                                 and   ACT.EMPL_RCD     = ACT_PR.EMPL_RCD
                                 and   ACT.SETID_DEPT   = ACT_PR.SETID_DEPT
                                 AND   ACT_PR.GVT_WIP_STATUS IN ('PRO','COR')
                                 AND   ACT_PR.GVT_NOA_CODE NOT IN ('000') 
                                 and   ACT_PR.EFFDT     =
                                        (SELECT MAX(DCS1.EFFDT)
                                         from  PS_GVT_JOB DCS1
                                         where DCS1.EMPLID           =  ACT.EMPLID
                                         and   DCS1.EMPL_RCD         =  ACT.EMPL_RCD
                                         and   DCS1.SETID_DEPT       =  ACT.SETID_DEPT
                                         and   DCS1.GVT_WIP_STATUS  IN ('PRO','COR')
                                         AND   DCS1.GVT_NOA_CODE NOT IN ('000')
                                         and   DCS1.EFFDT            =  ACT.EFFDT
                                         and   substr(DCS1.EFFSEQ,1,1)     != substr(ACT.EFFSEQ,1,1)
                                         and   DCS1.EFFSEQ           =
                                               (SELECT MAX(DCS2.EFFSEQ)
                                                from   PS_GVT_JOB DCS2
                                                where  DCS2.EMPLID    = ACT.EMPLID
                                                and    DCS2.EMPL_RCD  = ACT.EMPL_RCD
                                                and    DCS2.EFFDT     = ACT.EFFDT
                                                and    DCS2.SETID_DEPT =  ACT.SETID_DEPT
                                                and    substr(DCS2.EFFSEQ,1,1)     != substr(ACT.EFFSEQ,1,1)
                                                and    DCS2.GVT_WIP_STATUS  IN ('PRO','COR')    
                                                AND    DCS2.GVT_NOA_CODE NOT IN ('000')
                                                and    DCS2.EFFSEQ    < ACT.EFFSEQ )    
                                 and   ACT_PR.EFFSEQ        =
                                       (SELECT MAX(DCS3.EFFSEQ)
                                        from   PS_GVT_JOB DCS3
                                        where  DCS3.EMPLID    = ACT.EMPLID
                                        and    DCS3.EMPL_RCD  = ACT.EMPL_RCD
                                        and    DCS3.EFFDT     = ACT.EFFDT
                                        and    DCS3.SETID_DEPT       =  ACT.SETID_DEPT
                                        and    DCS3.GVT_WIP_STATUS  IN ('PRO','COR')
                                        and    DCS3.GVT_NOA_CODE NOT IN ('000')    
                                        and    substr(DCS3.EFFSEQ,1,1)     != substr(ACT.EFFSEQ,1,1)
                                        and    DCS3.EFFSEQ    < ACT.EFFSEQ ) )
                      left outer join PS_GVT_NOAC_TBL     gvnoa  on gvnoa.GVT_NOA_CODE   = ACT.GVT_NOA_CODE AND gvnoa.action = ACT.action
                                                                                                                          and gvnoa.EFFDT =  (SELECT MAX(DEP_ED.EFFDT) FROM PS_GVT_NOAC_TBL DEP_ED
                                                                                                                        WHERE DEP_ED.GVT_NOA_CODE  = ACT.GVT_NOA_CODE
                                                                                                                          and DEP_ED.action  = ACT.action
                                                                                                                          AND DEP_ED.EFFDT <= ACT.EFFDT ) 				  
                     LEFT OUTER JOIN  PS_POSITION_DATA topos on  topos.position_nbr = ACT.position_nbr               
                      		                           AND topos.EFFDT  =                                      
                      		                              (SELECT MAX(topos_ed.EFFDT) FROM PS_POSITION_DATA topos_ed
                      		                               WHERE topos_ed.position_nbr = ACT.position_nbr          
                      		                               AND topos_ed.EFFDT <= ACT.effdt ) 		         
                     LEFT OUTER JOIN  PS_POSITION_DATA frpos on  frpos.position_nbr = ACT_PR.position_nbr               
                      		                           AND frpos.EFFDT  =                                      
                      		                              (SELECT MAX(frpos_ed.EFFDT) FROM PS_POSITION_DATA frpos_ed
                      		                               WHERE frpos_ed.position_nbr = ACT_PR.position_nbr         
                      		                               AND frpos_ed.EFFDT <= act_pr.effdt ) 
                      where   ACT.GVT_WIP_STATUS IN ('PRO','COR')
                        AND   ACT.GVT_NOA_CODE NOT IN ('000') 
                      ;
                     
                      commit;  
 
       -- Identify Actions that doesn't have have sameday Prior Actions

                      call nhrdw_process_log_trk (-7001, 'I', 'Refresh SF50 Transaction : Identify Actions that does not have have sameday Prior Actions' );
        
                      
                      INSERT INTO NHRDW_SF50_TRANSACTION
                      (
                       EMPLID                        
                      ,EMPL_RCD                      
                      ,EFFDT                         
                      ,EFFSEQ                        
                      ,SETID_DEPT
                      ,ACTION_EFFDT                     
                      ,ACT_STATUS                    
                      ,GVT_NOA_CODE     
                      ,FIRST_NOA_CODE    
                      ,SECOND_NOA_CODE   
                      ,GVT_NOA_DESCR 
                      ,EMPL_JOB_STATUS                        
                      ,GVT_WIP_STATUS                
                      ,GVT_STATUS_TYPE               
                      ,DEPTID                        
                      ,JOBCODE                       
                      ,POSITION_NBR                  
                      ,EMPL_STATUS    
                      ,COMPANY        
                      ,GVT_SUB_AGENCY 
                      ,GVT_SUBELEMENT_CODE                            
                      ,ACT_PR_EFFDT                  
                      ,ACT_PR_EFFSEQ                 
                      ,ACT_PR_GVT_NOA_CODE           
                      ,ACT_PR_GVT_WIP_STATUS         
                      ,ACT_PR_GVT_STATUS_TYPE        
                      ,ACT_PR_DEPTID                 
                      ,ACT_PR_JOBCODE                
                      ,ACT_PR_POSITION_NBR           
                      ,ACT_PR_EMPL_STATUS  
                      ,ACT_PR_COMPANY        
                      ,ACT_PR_GVT_SUB_AGENCY  
                      ,ACT_PR_GVT_SUBELEMENT_CODE
                      ,CHANGE_IN_SUBELEMENT_CODE
                      ,CHANGE_IN_DEPT
                      ,DISABILITY_VETERAN_LEAVE_BEGIN_DATE         
                      ,DISABILITY_VETERAN_LEAVE_END_DATE    
                      ,TRANSACTION_STATUS        
                      ,SUPV_LVL_ID
                      ,ACT_PR_SUPV_LVL_ID
                      ,CHANGE_IN_SUPV_LVL_ID
                      ,ACT_PR_EMPL_JOB_STATUS
                      ,CHANGE_EMPL_JOB_STATUS                      
                      )
                      SELECT    
                        ACT.EMPLID              EMPLID        
                      , ACT.EMPL_RCD            EMPL_RCD      
                      , ACT.EFFDT               EFFDT          
                      , ACT.EFFSEQ              EFFSEQ        
                      , ACT.SETID_DEPT
                      , CASE WHEN ACT.GVT_NOA_CODE LIKE '3%' THEN DATE_ADD(ACT.EFFDT, INTERVAL -1 DAY )  ELSE  ACT.EFFDT  END     
                      , 'PRIOR'                 ACT_STATUS      
                      , ACT.GVT_NOA_CODE        GVT_NOA_CODE  
                      , CASE WHEN ACT.GVT_WIP_STATUS = 'COR' THEN '002' ELSE ACT.GVT_NOA_CODE END  FIRST_NOA_CODE
                      , CASE WHEN ACT.GVT_WIP_STATUS = 'COR' THEN  ACT.GVT_NOA_CODE ELSE NULL END  SECOND_NOA_CODE
                      , CONCAT(COALESCE(GVNOA.DESCR25,' ') ,' ',COALESCE(GVNOA.DESCR25_2,' ')) GVT_NOA_DESC  
                      , nhrdw_get_empl_job_status ( ACT.GVT_NOA_CODE, ACT_PR.GVT_NOA_CODE ,ACT.GVT_LEG_AUTH_1,ACT.GVT_LEG_AUTH_2,ACT.EMPL_STATUS)
                      , ACT.GVT_WIP_STATUS      GVT_WIP_STATUS
                      , ACT.GVT_STATUS_TYPE     GVT_STATUS_TYPE
                      , ACT.DEPTID              DEPTID        
                      , ACT.JOBCODE             JOBCODE      
                      , ACT.POSITION_NBR        POSITION_NBR  
                      , ACT.EMPL_STATUS         EMPL_STATUS      
                      , ACT.COMPANY             COMPANY         
                      , ACT.GVT_SUB_AGENCY      GVT_SUB_AGENCY  
                      , concat(ACT.COMPANY,ACT.GVT_SUB_AGENCY)   GVT_SUBELEMENT_CODE     
                      , ACT_PR.EFFDT            ACT_PR_EFFDT          
                      , ACT_PR.EFFSEQ           ACT_PR_EFFSEQ    
                      , ACT_PR.GVT_NOA_CODE     ACT_PR_GVT_NOA_CODE    
                      , ACT_PR.GVT_WIP_STATUS   ACT_PR_GVT_WIP_STATUS  
                      , ACT_PR.GVT_STATUS_TYPE  ACT_PR_GVT_STATUS_TYPE  
                      , ACT_PR.DEPTID           ACT_PR_DEPTID          
                      , ACT_PR.JOBCODE          ACT_PR_JOBCODE          
                      , ACT_PR.POSITION_NBR     ACT_PR_POSITION_NBR    
                      , ACT_PR.EMPL_STATUS      ACT_PR_EMPL_STATUS            
                      , ACT_PR.COMPANY          ACT_PR_COMPANY         
                      , ACT_PR.GVT_SUB_AGENCY   ACT_PR_GVT_SUB_AGENCY  
                      , concat(ACT_PR.COMPANY,ACT_PR.GVT_SUB_AGENCY)   ACT_PR_GVT_SUBELEMENT_CODE
                      , nhrdw_get_change_in_subelement_code (concat(ACT.COMPANY,ACT.GVT_SUB_AGENCY)  , concat(ACT_PR.COMPANY,ACT_PR.GVT_SUB_AGENCY) )
                      , nhrdw_get_change_in_dept (ACT.DEPTID , ACT_PR.DEPTID ) CHANGE_IN_DEPT
                      , CASE WHEN ACT.GVT_NOA_CODE LIKE '982' THEN ACT.EFFDT ELSE NULL END  
                      , CASE WHEN ACT.GVT_NOA_CODE LIKE '982' THEN DATE_ADD(DATE_ADD(ACT.EFFDT, INTERVAL 1 YEAR ), INTERVAL -1 DAY ) ELSE  NULL  END            
                      ,'COMPLETED' TRANSACTION_STATUS
                      ,topos.SUPV_LVL_ID           SUPV_LVL_ID
                      ,frpos.SUPV_LVL_ID        ACT_PR_SUPV_LVL_ID
                      ,nhrdw_get_change_in_supv_lvl_id(topos.SUPV_LVL_ID , frpos.SUPV_LVL_ID )  CHANGE_IN_SUPV_LVL_ID   
                      ,nhrdw_get_empl_job_status ( ACT_PR.GVT_NOA_CODE, ACT_PR.GVT_NOA_CODE ,ACT_PR.GVT_LEG_AUTH_1,ACT_PR.GVT_LEG_AUTH_2,ACT_PR.EMPL_STATUS) 
                      ,case when nhrdw_get_empl_job_status ( ACT.GVT_NOA_CODE, ACT_PR.GVT_NOA_CODE ,ACT.GVT_LEG_AUTH_1,ACT.GVT_LEG_AUTH_2,ACT.EMPL_STATUS) != 'Prior Status' Then 'Y' Else 'N' End
                      from  PS_GVT_JOB ACT
                      JOIN  PS_GVT_JOB ACT_PR   ON          
                                      ACT.EMPLID       = ACT_PR.EMPLID 
                                and   ACT.EMPL_RCD     = ACT_PR.EMPL_RCD
                                and   ACT.SETID_DEPT       =  ACT_PR.SETID_DEPT
                                AND   ACT_PR.GVT_WIP_STATUS IN ('PRO','COR')
                                and   ACT_PR.GVT_NOA_CODE NOT IN ('000')  
                                and   ACT_PR.EFFDT     =
                                       (SELECT MAX(DCD1.EFFDT)
                                        from  PS_GVT_JOB DCD1
                                        where DCD1.EMPLID          =  ACT.EMPLID
                                        and   DCD1.EMPL_RCD        =  ACT.EMPL_RCD
                                        and   DCD1.SETID_DEPT      =  ACT.SETID_DEPT
                                        and   (DCD1.GVT_WIP_STATUS IN ('PRO','COR'))
                                        and   DCD1.GVT_NOA_CODE NOT IN ('000')  
                                        and   DCD1.EFFDT           <  ACT.EFFDT
                                        and   DCD1.EFFSEQ          =
                                              (SELECT MAX(DCD2.EFFSEQ)
                                               from   PS_GVT_JOB DCD2
                                               where  DCD2.EMPLID    = ACT.EMPLID
                                               and    DCD2.EMPL_RCD = ACT.EMPL_RCD
                                               and    DCD2.SETID_DEPT      =  ACT.SETID_DEPT
                                               and    DCD2.GVT_WIP_STATUS IN ('PRO','COR')
                                               and    DCD2.GVT_NOA_CODE NOT IN ('000')  
                                               and    DCD2.EFFDT     = DCD1.EFFDT)
                                       )        
                                and   ACT_PR.EFFSEQ        =
                                      (SELECT MAX(DCD3.EFFSEQ)
                                       from   PS_GVT_JOB DCD3
                                       where  DCD3.EMPLID    = ACT.EMPLID
                                       and    DCD3.EMPL_RCD  = ACT.EMPL_RCD
                                       and    DCD3.SETID_DEPT    =  ACT.SETID_DEPT
                                       AND    DCD3.GVT_WIP_STATUS IN ('PRO','COR')
                                       and    DCD3.EFFDT       <  ACT.EFFDT
                                       and    DCD3.EFFDT     = ACT_PR.EFFDT
                                       and    DCD3.GVT_NOA_CODE NOT IN ('000')  
                                       -- and    DCD3.EFFDT     = ACT_PR.EFFDT
                                       )   
                      left outer join PS_GVT_NOAC_TBL     gvnoa  on gvnoa.GVT_NOA_CODE   = ACT.GVT_NOA_CODE AND gvnoa.action = ACT.action
                                                                                                                          and gvnoa.EFFDT =  (SELECT MAX(DEP_ED.EFFDT) FROM PS_GVT_NOAC_TBL DEP_ED
                                                                                                                        WHERE DEP_ED.GVT_NOA_CODE  = ACT.GVT_NOA_CODE
                                                                                                                          and DEP_ED.action  = ACT.action
                                                                                                                          AND DEP_ED.EFFDT <= ACT.EFFDT ) 				  
                     LEFT OUTER JOIN  PS_POSITION_DATA topos on  topos.position_nbr = ACT.position_nbr               
                      		                           AND topos.EFFDT  =                                      
                      		                              (SELECT MAX(topos_ed.EFFDT) FROM PS_POSITION_DATA topos_ed
                      		                               WHERE topos_ed.position_nbr = ACT.position_nbr          
                      		                               AND topos_ed.EFFDT <= ACT.effdt ) 		         
                     LEFT OUTER JOIN  PS_POSITION_DATA frpos on  frpos.position_nbr = ACT_PR.position_nbr               
                      		                           AND frpos.EFFDT  =                                      
                      		                              (SELECT MAX(frpos_ed.EFFDT) FROM PS_POSITION_DATA frpos_ed
                      		                               WHERE frpos_ed.position_nbr = ACT_PR.position_nbr         
                      		                               AND frpos_ed.EFFDT <= act_pr.effdt ) 
                      WHERE  ACT.GVT_WIP_STATUS IN ('PRO','COR')
                      and    ACT.GVT_NOA_CODE NOT IN ('000')  	   
                      AND    NOT EXISTS ( SELECT 'X'
                                          FROM   NHRDW_SF50_TRANSACTION SDAY
                                          WHERE  ACT.EMPLID    = SDAY.EMPLID
                                          AND    ACT.EMPL_RCD  = SDAY.EMPL_RCD
                                          AND    ACT.EFFDT     = SDAY.EFFDT
                                          AND    ACT.EFFSEQ    = SDAY.EFFSEQ 
                                          and    ACT.GVT_NOA_CODE NOT IN ('000')  
                                          AND    SDAY.ACT_STATUS = 'SAMEDAY' )
                      ;       
                         
                      commit;                     
 
       -- Identify Actions that doesn't have any prior day actions 

                      call nhrdw_process_log_trk (-7001, 'I', 'Refresh SF50 Transaction : Identify Actions that does not have any prior day actions' );
                      
                      INSERT INTO NHRDW_SF50_TRANSACTION
                      (
                       EMPLID                                                 
                      ,EMPL_RCD                      
                      ,EFFDT                         
                      ,EFFSEQ                        
                      ,SETID_DEPT
                      ,ACTION_EFFDT                     
                      ,ACT_STATUS                    
                      ,GVT_NOA_CODE     
                      ,FIRST_NOA_CODE    
                      ,SECOND_NOA_CODE   
                      ,GVT_NOA_DESCR 
                      ,EMPL_JOB_STATUS                        
                      ,GVT_WIP_STATUS                
                      ,GVT_STATUS_TYPE               
                      ,DEPTID                        
                      ,JOBCODE                       
                      ,POSITION_NBR                  
                      ,EMPL_STATUS  
                      ,COMPANY        
                      ,GVT_SUB_AGENCY  
                      ,GVT_SUBELEMENT_CODE                              
                      ,ACT_PR_EFFDT                  
                      ,ACT_PR_EFFSEQ                 
                      ,ACT_PR_GVT_NOA_CODE           
                      ,ACT_PR_GVT_WIP_STATUS         
                      ,ACT_PR_GVT_STATUS_TYPE        
                      ,ACT_PR_DEPTID                 
                      ,ACT_PR_JOBCODE                
                      ,ACT_PR_POSITION_NBR           
                      ,ACT_PR_EMPL_STATUS    
                      ,ACT_PR_COMPANY        
                      ,ACT_PR_GVT_SUB_AGENCY  
                      ,ACT_PR_GVT_SUBELEMENT_CODE
                      ,CHANGE_IN_SUBELEMENT_CODE
                      ,CHANGE_IN_DEPT
                      ,DISABILITY_VETERAN_LEAVE_BEGIN_DATE         
                      ,DISABILITY_VETERAN_LEAVE_END_DATE    
                      ,TRANSACTION_STATUS        
                      ,SUPV_LVL_ID
                      ,ACT_PR_SUPV_LVL_ID
                      ,CHANGE_IN_SUPV_LVL_ID
                      ,ACT_PR_EMPL_JOB_STATUS
                      ,CHANGE_EMPL_JOB_STATUS                      
                      )
                      SELECT    
                        ACT.EMPLID              EMPLID        
                      , ACT.EMPL_RCD            EMPL_RCD      
                      , ACT.EFFDT               EFFDT          
                      , ACT.EFFSEQ              EFFSEQ        
                      , ACT.SETID_DEPT
                      , CASE WHEN ACT.GVT_NOA_CODE LIKE '3%' THEN DATE_ADD(ACT.EFFDT, INTERVAL -1 DAY ) ELSE  ACT.EFFDT  END     
                      , 'NOPRIOR'                 ACT_STATUS      
                      , ACT.GVT_NOA_CODE        GVT_NOA_CODE  
                      , CASE WHEN ACT.GVT_WIP_STATUS = 'COR' THEN '002' ELSE ACT.GVT_NOA_CODE END  FIRST_NOA_CODE
                      , CASE WHEN ACT.GVT_WIP_STATUS = 'COR' THEN  ACT.GVT_NOA_CODE ELSE NULL END  SECOND_NOA_CODE
                      , CONCAT(COALESCE(GVNOA.DESCR25,' ') ,' ',COALESCE(GVNOA.DESCR25_2,' ')) GVT_NOA_DESC  
                      , nhrdw_get_empl_job_status ( ACT.GVT_NOA_CODE, NULL ,ACT.GVT_LEG_AUTH_1,ACT.GVT_LEG_AUTH_2,ACT.EMPL_STATUS)
                      , ACT.GVT_WIP_STATUS      GVT_WIP_STATUS
                      , ACT.GVT_STATUS_TYPE     GVT_STATUS_TYPE
                      , ACT.DEPTID              DEPTID        
                      , ACT.JOBCODE             JOBCODE      
                      , ACT.POSITION_NBR        POSITION_NBR  
                      , ACT.EMPL_STATUS         EMPL_STATUS      
                      , ACT.COMPANY             COMPANY         
                      , ACT.GVT_SUB_AGENCY      GVT_SUB_AGENCY  
                      , concat(ACT.COMPANY,ACT.GVT_SUB_AGENCY)   GVT_SUBELEMENT_CODE    
                      , null ACT_PR_EFFDT          
                      , null ACT_PR_EFFSEQ    
                      , null ACT_PR_GVT_NOA_CODE    
                      , null ACT_PR_GVT_WIP_STATUS  
                      , null ACT_PR_GVT_STATUS_TYPE  
                      , null ACT_PR_DEPTID          
                      , null ACT_PR_JOBCODE          
                      , null ACT_PR_POSITION_NBR    
                      , NULL ACT_PR_EMPL_STATUS            
                      , NULL ACT_PR_COMPANY         
                      , NULL ACT_PR_GVT_SUB_AGENCY
                      , NULL ACT_PR_GVT_SUBELEMENT_CODE
                      , nhrdw_get_change_in_subelement_code (concat(ACT.COMPANY,ACT.GVT_SUB_AGENCY)  , NULL ) CHANGE_IN_SUBELEMENT_CODE
                      , nhrdw_get_change_in_dept (ACT.DEPTID , NULL ) CHANGE_IN_DEPT
                      , CASE WHEN ACT.GVT_NOA_CODE LIKE '982' THEN ACT.EFFDT ELSE NULL END  
                      , CASE WHEN ACT.GVT_NOA_CODE LIKE '982' THEN DATE_ADD(DATE_ADD(ACT.EFFDT, INTERVAL 1 YEAR ), INTERVAL -1 DAY ) ELSE  NULL  END       
                      ,'COMPLETED' TRANSACTION_STATUS
                      ,topos.SUPV_LVL_ID           SUPV_LVL_ID
                      ,NULL                        ACT_PR_SUPV_LVL_ID
                      ,nhrdw_get_change_in_supv_lvl_id(topos.SUPV_LVL_ID , NULL )  CHANGE_IN_SUPV_LVL_ID   
                      ,NULL
                      ,'Y'
                      from  PS_GVT_JOB ACT           
                      left outer join PS_GVT_NOAC_TBL     gvnoa  on gvnoa.GVT_NOA_CODE   = ACT.GVT_NOA_CODE AND gvnoa.action = ACT.action
                                                                                                                          and gvnoa.EFFDT =  (SELECT MAX(DEP_ED.EFFDT) FROM PS_GVT_NOAC_TBL DEP_ED
                                                                                                                        WHERE DEP_ED.GVT_NOA_CODE  = ACT.GVT_NOA_CODE
                                                                                                                          and DEP_ED.action  = ACT.action
                                                                                                                          AND DEP_ED.EFFDT <= ACT.EFFDT ) 				  
                     LEFT OUTER JOIN  PS_POSITION_DATA topos on  topos.position_nbr = ACT.position_nbr               
                      		                           AND topos.EFFDT  =                                      
                      		                              (SELECT MAX(topos_ed.EFFDT) FROM PS_POSITION_DATA topos_ed
                      		                               WHERE topos_ed.position_nbr = ACT.position_nbr          
                      		                               AND topos_ed.EFFDT <= ACT.effdt ) 		         
                      where ACT.GVT_WIP_STATUS IN ('PRO','COR')
                      and   ACT.GVT_NOA_CODE NOT IN ('000')  
                      AND    NOT EXISTS ( SELECT 'X'
                                          FROM   NHRDW_SF50_TRANSACTION SDAY
                                          WHERE  ACT.EMPLID    = SDAY.EMPLID
                                          AND    ACT.EMPL_RCD  = SDAY.EMPL_RCD
                                          AND    ACT.EFFDT     = SDAY.EFFDT
                                          AND    ACT.GVT_NOA_CODE NOT IN ('000')  
                                          AND    ACT.EFFSEQ    = SDAY.EFFSEQ);
                                                         
                                    
                      commit;
                  

       -- Update the Transactions that were already corrected with the Transaction Status Corrected.                  

                      call nhrdw_process_log_trk (-7001, 'I', 'Refresh SF50 Transaction : Update the Transactions that were already corrected with the Transaction Status Corrected' );
                      
                      update  NHRDW_SF50_TRANSACTION as sf50
                      set    sf50.TRANSACTION_STATUS = 'CORRECTED' 
                      where  exists ( select 'x'
                                      from   PS_GVT_JOB job
                                      where  sf50.emplid     = job.emplid
                                      and    sf50.empl_rcd   = job.empl_rcd
                                      and    job.GVT_NOA_CODE NOT IN ('000')  
                                      and    substr(sf50.EFFSEQ,1,1)     =  substr(job.EFFSEQ,1,1) 
                      		            and    job.GVT_WIP_STATUS          = 'COR'
                      		            and    sf50.EFFSEQ                 < job.EFFSEQ
                                      and    sf50.EFFDT                  =  job.EFFDT  
                                    --  and    sf50.gvt_noa_code           =  job.gvt_noa_code
                                    );    
                      
                      
                      commit; 

                      set l_rowcount := ROW_COUNT();
                                    
                      call nhrdw_process_log_trk (-7001, 'I', concat('Refresh SF50 Transaction : Update the Transactions that were already corrected with the Transaction Status Corrected',l_rowcount) );



                     UPDATE NHRDW_SF50_TRANSACTION as sf50                                                                                                                                                                              
                     					  INNER JOIN PS_GVT_JOB job                                                                                                                                                                              
                                                              on  sf50.emplid     = job.emplid                                                                                                                                          
                                                           and    sf50.empl_rcd   = job.empl_rcd                                                                                                                                        
                                                           and    job.GVT_NOA_CODE NOT IN ('000')                                                                                                                                       
                                                           and    substr(sf50.EFFSEQ,1,1)     =  substr(job.EFFSEQ,1,1)                                                                                                                 
                                           		            and    job.GVT_WIP_STATUS          = 'COR'                                                                                                                                   
                                           		            and    sf50.EFFSEQ                 < job.EFFSEQ                                                                                                                              
                                                           and    sf50.EFFDT                  =  job.EFFDT                                                                                                                              
                                                           and    job.EFFSEQ =  ( select max(job_es.effseq) FROM ps_gvt_jOB job_es                                                                                                      
                                                                                   where job_es.empl_rcd   = sf50.empl_rcd                                                                                                              
                                                                                   and job_es.EFFDT                  =  sf50.EFFDT                                                                                                      
                                                                                   and job_es.GVT_NOA_CODE NOT IN ('000')                                                                                                               
                                                                                   and job_es.GVT_WIP_STATUS       = 'COR'                                                                                                              
                                                                                   and job_es.emplid     = sf50.emplid                                                                                                                  
                                                                                   and substr(job_es.EFFSEQ,1,1)     =  substr(sf50.EFFSEQ,1,1)                                                                                         
                     														 )                                                                                                                                                                                     
                     SET   CORRECTED_ACTION_EFFDT        =  JOB.EFFDT                                                                                                                                                                   
                          ,CORRECTED_ACTION_EFFSEQ       =  JOB.EFFSEQ                                                                                                                                                                  
                     ;                                                                                                                                                                                                                  


           set l_rowcount := ROW_COUNT();
                                    
           call nhrdw_process_log_trk (-7001, 'I', concat('Refresh SF50 Transaction : Update the Transactions that were already corrected with the Corrective Action Details ',l_rowcount) );

 
       -- Identify Transactions where NOA Code was corrected.                  

                      call nhrdw_process_log_trk (-7001, 'I', 'Refresh SF50 Transaction : Identify Transactions where NOA Code was corrected' );
                      
                      update  NHRDW_SF50_TRANSACTION as sf50
                      inner join    PS_GVT_JOB job on  job.emplid     = sf50.emplid
                                             and job.empl_rcd   = sf50.empl_rcd
                                             and substr(job.EFFSEQ,1,1)     =  substr(sf50.EFFSEQ,1,1) 
                                             and job.GVT_WIP_STATUS          IN ('PRO','COR')
                                             and job.GVT_NOA_CODE NOT IN ('000')  
                                             and job.EFFSEQ                 < sf50.EFFSEQ
                                             and job.EFFDT                  =  sf50.EFFDT  
                                    and job.EFFSEQ        =
                                                                      (SELECT MAX(DCD.EFFSEQ)
                                                                       from   PS_GVT_JOB DCD
                                                                       where  DCD.EMPLID    = sf50.EMPLID
                                                                       and    DCD.EMPL_RCD  = sf50.EMPL_RCD
                                                                       AND    DCD.GVT_WIP_STATUS IN ('PRO','COR')
                                                                       and    DCD.GVT_NOA_CODE NOT IN ('000')  
                                                                       and    DCD.EFFDT     =  sf50.EFFDT 
                                                                       and    substr(DCD.EFFSEQ,1,1)     =  substr(sf50.EFFSEQ,1,1)       
                                                                       and    sf50.EFFSEQ  > dcd.EFFSEQ         
                                                                       ) 
                      set     sf50.CORRECTION_EFFDT          = job.EFFDT        
                             ,sf50.CORRECTION_EFFSEQ         = job.EFFSEQ       
                             ,sf50.CORRECTION_GVT_NOA_CODE   = job.GVT_NOA_CODE 
                      where  sf50.GVT_WIP_STATUS             = 'COR' ;
                      
                      commit;

       -- Derive Employee Status                   
                       

                      call nhrdw_process_log_trk (-7001, 'I', 'Refresh SF50 Transaction : Derive Employee Status Phase 1' );
                      
                      insert into  NHRDW_SF50_DERIVE_EMPL_STATUS 
                      (
                       EMPLID                 
                      ,EMPL_RCD               
                      ,EFFDT                  
                      ,EFFSEQ    
                      ,TYPE_OF_RECORD             
                      ,GVT_NOA_CODE           
                      ,EMPL_JOB_STATUS              
                      ,ACT_PR_FR_EFFDT           
                      ,ACT_PR_FR_EFFSEQ          
                      ,ACT_PR_FR_GVT_NOA_CODE   
                      ,ACT_PR_FR_EMPL_JOB_STATUS  
                      ) 
                      select  act.emplid
                            , act.empl_rcd
                      	  , act.effdt
                      	  , act.effseq	 
                            , 'PRIOR'	  
                      	  , act.GVT_NOA_CODE
                      	  , act.EMPL_JOB_STATUS
                      	  , ftr.effdt
                      	  , ftr.effseq	  
                      	  , ftr.GVT_NOA_CODE
                      	  , ftr.EMPL_JOB_STATUS
                      from  nhrdw_sf50_transaction act
                      join  nhrdw_sf50_transaction ftr on     ftr.transaction_status = 'COMPLETED'
                      and   ftr.empl_job_status not in ('Prior Status') 
                      and   act.empl_rcd = ftr.empl_rcd
                      and   act.emplid = ftr.emplid
                      and   ACT.effdt = ftr.effdt
                      and   ACT.SETID_DEPT      =  ftr.SETID_DEPT
                      and   ftr.effseq < act.effseq
                      and   ftr.effdt = ( select MAX(ftr_ed.effdt) 
                      					from   nhrdw_sf50_transaction ftr_ed
                                          where  ftr_ed.emplid = act.emplid
                                          and    ftr_ed.empl_rcd = act.empl_rcd 
                                          and    ftr_ed.effdt  = ACT.effdt
                                          and    ftr_ed.SETID_DEPT      =  ACT.SETID_DEPT
                                          and    ftr_ed.effseq <  ACT.effseq
                                          and    ftr_ed.empl_job_status not in ('Prior Status') 
                                          and    ftr_ed.transaction_status = 'COMPLETED' 
                                          and    ftr_ed.effseq = (select MAX(ftr_ed1.effseq)
                                                                  from   nhrdw_sf50_transaction ftr_ed1
                                                                  where  ftr_ed1.emplid = act.emplid
                                                                  and    ftr_ed1.empl_rcd = act.empl_rcd 
                                                                  and    ftr_ed1.effdt = ftr_ed.effdt 
                                                                  and    ftr_ed1.SETID_DEPT      =  ftr_ed.SETID_DEPT
                      											                      and    ftr_ed1.effseq <  ACT.effseq
                                                                  and    ftr_ed1.empl_job_status not in ('Prior Status') 
                                                                  and    ftr_ed1.transaction_status = 'COMPLETED' 
                      										  )
                                       )  
                      and   ftr.EFFSEQ        =
                            (SELECT MAX(DCS3.EFFSEQ)
                             from   nhrdw_sf50_transaction DCS3
                             where  DCS3.EMPLID    = act.EMPLID
                             and    DCS3.EMPL_RCD  = act.EMPL_RCD
                             and    DCS3.EFFDT     = ftr.EFFDT
                             and    DCS3.SETID_DEPT =  act.SETID_DEPT
                      	     and    DCS3.effseq < ACT.effseq
                             and    DCS3.empl_job_status not in ('Prior Status') 
                             and    DCS3.transaction_status = 'COMPLETED' 
                            )      
                      where act.empl_job_status not in ('Prior Status') 
                      and   act.transaction_status = 'COMPLETED';
                      

                      call nhrdw_process_log_trk (-7001, 'I', 'Refresh SF50 Transaction : Derive Employee Status Phase 2' );

                      commit;                      

                      insert into  NHRDW_SF50_DERIVE_EMPL_STATUS 
                      (
                       EMPLID                 
                      ,EMPL_RCD               
                      ,EFFDT                  
                      ,EFFSEQ    
                      ,TYPE_OF_RECORD             
                      ,GVT_NOA_CODE           
                      ,EMPL_JOB_STATUS           
                      ,ACT_PR_FR_EFFDT           
                      ,ACT_PR_FR_EFFSEQ          
                      ,ACT_PR_FR_GVT_NOA_CODE   
                      ,ACT_PR_FR_EMPL_JOB_STATUS    
                      ) 
                      select  act.emplid
                            , act.empl_rcd
                      	  , act.effdt
                      	  , act.effseq	  
                      	  , 'PRIOR'
                      	  , act.GVT_NOA_CODE
                      	  , act.EMPL_JOB_STATUS
                      	  , ftr.effdt
                      	  , ftr.effseq	  
                      	  , ftr.GVT_NOA_CODE
                      	  , ftr.EMPL_JOB_STATUS
                      from  nhrdw_sf50_transaction act
                      left outer join nhrdw_sf50_transaction ftr on     ftr.transaction_status = 'COMPLETED'
                      and   ftr.empl_job_status not in ('Prior Status') 
                      and   act.empl_rcd = ftr.empl_rcd
                      and   act.emplid = ftr.emplid
                      and   act.SETID_DEPT =  ftr.SETID_DEPT
                      and   ftr.effdt <  ACT.effdt
                      and   ftr.effdt = ( select MAX(ftr_ed.effdt) 
                      					from   nhrdw_sf50_transaction ftr_ed
                                          where  ftr_ed.emplid = act.emplid
                                          and    ftr_ed.empl_rcd = act.empl_rcd 
                                          and    ftr_ed.SETID_DEPT =  act.SETID_DEPT
                                          and    ftr_ed.effdt <  ACT.effdt
                                          and    ftr_ed.empl_job_status not in ('Prior Status') 
                                          and    ftr_ed.transaction_status = 'COMPLETED' 
                                          and    ftr_ed.effseq = (select MAX(ftr_ed1.effseq)
                                                                  from   nhrdw_sf50_transaction ftr_ed1
                                                                  where  ftr_ed1.emplid = act.emplid
                                                                  and    ftr_ed1.empl_rcd = act.empl_rcd 
                                                                  and    ftr_ed1.effdt = ftr_ed.effdt 
                                                                  and    ftr_ed1.SETID_DEPT =  ftr_ed.SETID_DEPT
                                                                  and    ftr_ed1.empl_job_status not in ('Prior Status') 
                                                                  and    ftr_ed1.transaction_status = 'COMPLETED' 
                      										  )
                                       )  
                      and   ftr.EFFSEQ        =
                            (SELECT MAX(DCS3.EFFSEQ)
                             from   nhrdw_sf50_transaction DCS3
                             where  DCS3.EMPLID    = act.EMPLID
                             and    DCS3.EMPL_RCD  = act.EMPL_RCD
                             and    DCS3.EFFDT     = ftr.EFFDT
                             and    DCS3.SETID_DEPT =  ftr.SETID_DEPT
                             and    DCS3.empl_job_status not in ('Prior Status') 
                             and    DCS3.transaction_status = 'COMPLETED' 
                            )        
                      where act.empl_job_status not in ('Prior Status') 
                      and   act.transaction_status = 'COMPLETED'
                      AND   NOT EXISTS (   SELECT ACT_ED.EMPLID   
                                             FROM NHRDW_SF50_DERIVE_EMPL_STATUS ACT_ED
                       	 	              WHERE  ACT_ED.EMPLID = ACT.EMPLID
                      					  AND    ACT_ED.EMPL_RCD = ACT.EMPL_RCD
                      					  AND    ACT_ED.EFFDT = ACT.EFFDT
                      					  AND    ACT_ED.EFFSEQ = ACT.EFFSEQ 
                      					  AND    ACT_ED.TYPE_OF_RECORD = 'PRIOR' );
                      	
                      commit;                      


                      call nhrdw_process_log_trk (-7001, 'I', 'Refresh SF50 Transaction : Update  Employee Status Phase 1' );

                      commit;  
                      
                      update  NHRDW_SF50_TRANSACTION ACT
                      join NHRDW_SF50_DERIVE_EMPL_STATUS prr 
                      on   act.empl_rcd = prr.empl_rcd
                      and   act.emplid = prr.emplid
                      and   act.effdt = prr.effdt
                      and   act.effseq = prr.effseq
                      AND   prr.type_of_record = 'PRIOR'
                      and   prr.act_pr_fr_empl_job_status not in ('Active','Temporary Promotion NTE','IPA Detail NTE','Detail NTE','Phased Retirement')
                      SET    ACT.empl_job_status = prr.act_pr_fr_empl_job_status     
                      where act.GVT_NOA_CODE IN ('740','702','713','616')
                      and   act.transaction_status = 'COMPLETED';  
                      
                      commit;                      

                      update  NHRDW_SF50_TRANSACTION ACT
                      join NHRDW_SF50_DERIVE_EMPL_STATUS prr 
                      on   act.empl_rcd = prr.empl_rcd
                      and   act.emplid = prr.emplid
                      and   act.effdt = prr.effdt
                      and   act.effseq = prr.effseq
                      AND   prr.type_of_record = 'PRIOR'
                      and   prr.act_pr_fr_empl_job_status = 'Temporary Promotion NTE'
                      SET   act.CHANGE_EMPL_JOB_STATUS = 'N'  
                      where act.GVT_NOA_CODE = '703'
                      and   act.transaction_status = 'COMPLETED';  
                      
                      commit;  
                      
                      call nhrdw_process_log_trk (-7001, 'I', 'Refresh SF50 Transaction : Update  Employee Status Phase 2' );

                      
                      update  NHRDW_SF50_TRANSACTION ACT
                      join NHRDW_SF50_DERIVE_EMPL_STATUS prr 
                      on   act.empl_rcd = prr.empl_rcd
                      and   act.emplid = prr.emplid
                      and   act.effdt = prr.effdt
                      and   act.effseq = prr.effseq
                      AND   prr.type_of_record = 'PRIOR'
                      and   prr.act_pr_fr_empl_job_status not in ('Active','Detail NTE','IPA Detail NTE','Phased Retirement')
                      SET    ACT.empl_job_status = prr.act_pr_fr_empl_job_status     
                      where act.GVT_NOA_CODE IN ('732','932')
                      and   act.transaction_status = 'COMPLETED';  
                      
                      commit;                      

                      call nhrdw_process_log_trk (-7001, 'I', 'Refresh SF50 Transaction : Update  Employee Status Phase 3' );

                      commit;  

				  
                      update  NHRDW_SF50_TRANSACTION ACT
                      join NHRDW_SF50_DERIVE_EMPL_STATUS prr 
                      on   act.empl_rcd = prr.empl_rcd
                      and   act.emplid = prr.emplid
                      and   act.effdt = prr.effdt
                      and   act.effseq = prr.effseq
                      AND   prr.type_of_record = 'PRIOR'
                      and   prr.act_pr_fr_empl_job_status not in ('Suspension NTE','Leave Without Pay NTE','USERRA Status/Qualifying for Reservist Differential','USERRA Status/Not Qualifying for Reservist Differential',
                                                                    'Absent - Uniformed Service','Furlough NTE','Suspension - Indefinite','Placement in Nonpay Status','Furlough','Sabbatical NTE') 
                      SET    ACT.empl_job_status = prr.act_pr_fr_empl_job_status     
                      where act.GVT_NOA_CODE IN ('292','293','280')
                      and   act.transaction_status = 'COMPLETED';  

                      commit;                      	

                      call nhrdw_process_log_trk (-7001, 'I', 'Refresh SF50 Transaction : Insert Future Employee Status Phase 1' );

                      commit;  
					  
                      insert into  NHRDW_SF50_DERIVE_EMPL_STATUS 
                      (
                       EMPLID                 
                      ,EMPL_RCD               
                      ,EFFDT                  
                      ,EFFSEQ    
                      ,TYPE_OF_RECORD             
                      ,GVT_NOA_CODE           
                      ,EMPL_JOB_STATUS              
                      ,ACT_PR_FR_EFFDT           
                      ,ACT_PR_FR_EFFSEQ          
                      ,ACT_PR_FR_GVT_NOA_CODE   
                      ,ACT_PR_FR_EMPL_JOB_STATUS  
                      ) 
                      select  act.emplid
                            , act.empl_rcd
                      	  , act.effdt
                      	  , act.effseq	 
                            , 'FUTURE'	  
                      	  , act.GVT_NOA_CODE
                      	  , act.EMPL_JOB_STATUS
                      	  , ftr.effdt
                      	  , ftr.effseq	  
                      	  , ftr.GVT_NOA_CODE
                      	  , ftr.EMPL_JOB_STATUS
                      from  nhrdw_sf50_transaction act
                      join nhrdw_sf50_transaction ftr on     ftr.transaction_status = 'COMPLETED'
                      and   ftr.empl_job_status not in ('Prior Status') 
                      and   act.empl_rcd = ftr.empl_rcd
                      and   act.emplid = ftr.emplid
                      and   ACT.effdt = ftr.effdt
                      and   ACT.SETID_DEPT =  ftr.SETID_DEPT
                      and   ftr.effseq > act.effseq
                      and   ftr.effdt = ( select min(ftr_ed.effdt) 
                      					from   nhrdw_sf50_transaction ftr_ed
                                          where  ftr_ed.emplid = act.emplid
                                          and    ftr_ed.empl_rcd = act.empl_rcd 
                                          and    ftr_ed.effdt  = ACT.effdt
                                          and    ftr_ed.SETID_DEPT =  ACT.SETID_DEPT
                                          and    ftr_ed.effseq >  ACT.effseq
                                          and    ftr_ed.empl_job_status not in ('Prior Status') 
                                          and    ftr_ed.transaction_status = 'COMPLETED' 
                                          and    ftr_ed.effseq = (select min(ftr_ed1.effseq)
                                                                  from   nhrdw_sf50_transaction ftr_ed1
                                                                  where  ftr_ed1.emplid = act.emplid
                                                                  and    ftr_ed1.empl_rcd = act.empl_rcd 
                                                                  and    ftr_ed1.effdt = ftr_ed.effdt 
                                                                  and    ftr_ed1.SETID_DEPT =  ftr_ed.SETID_DEPT
                      										                      	and    ftr_ed1.effseq >  ACT.effseq
                                                                  and    ftr_ed1.empl_job_status not in ('Prior Status') 
                                                                  and    ftr_ed1.transaction_status = 'COMPLETED' 
                      										  )
                                       )  
                      and   ftr.EFFSEQ        =
                            (SELECT MIN(DCS3.EFFSEQ)
                             from   nhrdw_sf50_transaction DCS3
                             where  DCS3.EMPLID    = act.EMPLID
                             and    DCS3.EMPL_RCD  = act.EMPL_RCD
                             and    DCS3.EFFDT     = ftr.EFFDT
                             and    DCS3.SETID_DEPT =  ftr.SETID_DEPT
                      	     and    DCS3.effseq > ACT.effseq
                             and    DCS3.empl_job_status not in ('Prior Status') 
                             and    DCS3.transaction_status = 'COMPLETED' 
                            )      
                      where act.empl_job_status not in ('Prior Status') 
                      and   act.transaction_status = 'COMPLETED';
                      
                      commit;                     
					  
                      call nhrdw_process_log_trk (-7001, 'I', 'Refresh SF50 Transaction : Insert Future Employee Status Phase 2' );

                      commit;  
					  
                      insert into  NHRDW_SF50_DERIVE_EMPL_STATUS 
                      (
                       EMPLID                 
                      ,EMPL_RCD               
                      ,EFFDT                  
                      ,EFFSEQ    
                      ,TYPE_OF_RECORD             
                      ,GVT_NOA_CODE           
                      ,EMPL_JOB_STATUS              
                      ,ACT_PR_FR_EFFDT           
                      ,ACT_PR_FR_EFFSEQ          
                      ,ACT_PR_FR_GVT_NOA_CODE   
                      ,ACT_PR_FR_EMPL_JOB_STATUS    
                      ) 
                      select  act.emplid
                            , act.empl_rcd
                      	  , act.effdt
                      	  , act.effseq	  
                      	  , 'FUTURE'
                      	  , act.GVT_NOA_CODE
                      	  , act.EMPL_JOB_STATUS
                      	  , ftr.effdt
                      	  , ftr.effseq	  
                      	  , ftr.GVT_NOA_CODE
                      	  , ftr.EMPL_JOB_STATUS
                      from  nhrdw_sf50_transaction act
                      left outer join nhrdw_sf50_transaction ftr on     ftr.transaction_status = 'COMPLETED'
                      and   ftr.empl_job_status not in ('Prior Status') 
                      and   act.empl_rcd = ftr.empl_rcd
                      and   act.emplid = ftr.emplid
                      and   act.SETID_DEPT =  ftr.SETID_DEPT
                      and   ftr.effdt >  ACT.effdt
                      and   ftr.effdt = ( select min(ftr_ed.effdt) 
                      					from   nhrdw_sf50_transaction ftr_ed
                                          where  ftr_ed.emplid = act.emplid
                                          and    ftr_ed.empl_rcd = act.empl_rcd 
                                          and    ftr_ed.SETID_DEPT =  act.SETID_DEPT
                                          and    ftr_ed.effdt >  ACT.effdt
                                          and    ftr_ed.empl_job_status not in ('Prior Status') 
                                          and    ftr_ed.transaction_status = 'COMPLETED' 
                                          and    ftr_ed.effseq = (select min(ftr_ed1.effseq)
                                                                  from   nhrdw_sf50_transaction ftr_ed1
                                                                  where  ftr_ed1.emplid = act.emplid
                                                                  and    ftr_ed1.empl_rcd = act.empl_rcd 
                                                                  and    ftr_ed1.effdt = ftr_ed.effdt 
                                                                  and    ftr_ed1.SETID_DEPT =  ftr_ed.SETID_DEPT
                                                                  and    ftr_ed1.empl_job_status not in ('Prior Status') 
                                                                  and    ftr_ed1.transaction_status = 'COMPLETED' 
                      										  )
                                       )  
                      and   ftr.EFFSEQ        =
                            (SELECT MIN(DCS3.EFFSEQ)
                             from   nhrdw_sf50_transaction DCS3
                             where  DCS3.EMPLID    = act.EMPLID
                             and    DCS3.EMPL_RCD  = act.EMPL_RCD
                             and    DCS3.EFFDT     = ftr.EFFDT
                             and    DCS3.SETID_DEPT =  ftr.SETID_DEPT
                             and    DCS3.empl_job_status not in ('Prior Status') 
                             and    DCS3.transaction_status = 'COMPLETED' 
                            )        
                      where act.empl_job_status not in ('Prior Status') 
                      and   act.transaction_status = 'COMPLETED'
                      AND   NOT EXISTS (   SELECT ACT_ED.EMPLID   
                                             FROM NHRDW_SF50_DERIVE_EMPL_STATUS ACT_ED
                       	 	              WHERE  ACT_ED.EMPLID = ACT.EMPLID
                      					  AND    ACT_ED.EMPL_RCD = ACT.EMPL_RCD
                      					  AND    ACT_ED.EFFDT = ACT.EFFDT
                      					  AND    ACT_ED.EFFSEQ = ACT.EFFSEQ 
                      					  AND    ACT_ED.TYPE_OF_RECORD = 'FUTURE');
                      	

                      commit;                     
					  
                      call nhrdw_process_log_trk (-7001, 'I', 'Refresh SF50 Transaction : Update Future Employee Status Phase' );

                      commit;  
                      
                      update  NHRDW_SF50_TRANSACTION ACT
                      join NHRDW_SF50_DERIVE_EMPL_STATUS ftr 
                      on   act.empl_rcd = ftr.empl_rcd
                      and   act.emplid = ftr.emplid
                      and   act.effdt = ftr.effdt
                      and   act.effseq = ftr.effseq
                      AND   ftr.type_of_record = 'FUTURE'
                      SET    ACT.EFFECTIVE_STATUS_END_DATE = CASE WHEN ftr.ACT_PR_FR_GVT_NOA_CODE in ('732','932') THEN  ftr.ACT_PR_FR_EFFDT when FTR.ACT_PR_FR_EFFDT = act.effdt then ftr.ACT_PR_FR_EFFDT else DATE_ADD(ftr.ACT_PR_FR_EFFDT, INTERVAL -1 DAY )  END         
                      where act.empl_job_status not in ('Prior Status') 
                      and   act.transaction_status = 'COMPLETED';  
                      
                      call nhrdw_process_log_trk (-7001, 'I', 'Refresh SF50 Transaction : Change in Agency Code Subelement Phase I' );

                      commit; 



                     insert into  NHRDW_SF50_DERIVE_EMPL_STATUS 
                     (
                      EMPLID                 
                     ,EMPL_RCD               
                     ,EFFDT                  
                     ,EFFSEQ    
                     ,TYPE_OF_RECORD             
                     ,GVT_NOA_CODE           
                     ,EMPL_JOB_STATUS   
                     ,GVT_SUBELEMENT_CODE            
                     ,ACT_PR_FR_EFFDT           
                     ,ACT_PR_FR_EFFSEQ          
                     ,ACT_PR_FR_GVT_NOA_CODE   
                     ,ACT_PR_FR_EMPL_JOB_STATUS 
                     ,ACT_PR_FR_GVT_SUBELEMENT_CODE 
                     ,EFFECTIVE_END_DATE
                     ) 
                     select  act.emplid
                        , act.empl_rcd
                     	  , act.effdt
                     	  , act.effseq	 
                        , 'SUBELEMENT'	  
                     	  , act.GVT_NOA_CODE
                     	  , act.EMPL_JOB_STATUS
                     	  , act.GVT_SUBELEMENT_CODE
                     	  , ftr.effdt
                     	  , ftr.effseq	  
                     	  , ftr.GVT_NOA_CODE
                     	  , ftr.EMPL_JOB_STATUS
                     	  ,	ftr.GVT_SUBELEMENT_CODE
                     	  , CASE WHEN  ftr.effdt IS NULL THEN NULL  WHEN  ftr.effdt = act.effdt then ftr.effdt else DATE_ADD(ftr.effdt, INTERVAL -1 DAY )  END 
                     from  nhrdw_sf50_transaction act
                     join nhrdw_sf50_transaction ftr on     ftr.transaction_status = 'COMPLETED'
                     and   act.empl_rcd = ftr.empl_rcd
                     and   act.emplid = ftr.emplid
                     and   ACT.effdt = ftr.effdt
                     and   ACT.SETID_DEPT =  ftr.SETID_DEPT
                     and   ftr.effseq > act.effseq
                     and   ( act.CHG_GVT_SUBELEMENT_CODE != ftr.CHG_GVT_SUBELEMENT_CODE or ftr.GVT_NOA_CODE like '3%' )
                     and   ftr.effdt = ( select min(ftr_ed.effdt) 
                     					from   nhrdw_sf50_transaction ftr_ed
                                         where  ftr_ed.emplid = ftr.emplid
                                         and    ftr_ed.empl_rcd = ftr.empl_rcd 
                                         and    ftr_ed.effdt  = ACT.effdt
                                         and    ftr_ed.SETID_DEPT =  ACT.SETID_DEPT
                                         and    ftr_ed.effseq >  ACT.effseq
                                         and    (ftr_ed.CHG_GVT_SUBELEMENT_CODE != act.CHG_GVT_SUBELEMENT_CODE or ftr_ed.GVT_NOA_CODE like '3%' )
                                         and    ftr_ed.transaction_status = 'COMPLETED' 
                                         and    ftr_ed.effseq = (select min(ftr_ed1.effseq)
                                                                 from   nhrdw_sf50_transaction ftr_ed1
                                                                 where  ftr_ed1.emplid = ftr_ed.emplid
                                                                 and    ftr_ed1.empl_rcd = ftr_ed.empl_rcd 
                                                                 and    ftr_ed1.effdt = ftr_ed.effdt 
                                                                 and    ftr_ed1.SETID_DEPT =  ftr_ed.SETID_DEPT
                     										                      	 and    ftr_ed1.effseq >  ACT.effseq
                     										                      	 and    (ftr_ed1.CHG_GVT_SUBELEMENT_CODE != ACT.CHG_GVT_SUBELEMENT_CODE or ftr_ed1.GVT_NOA_CODE like '3%' )
                                                                 and    ftr_ed1.transaction_status = 'COMPLETED' 
                     										                        )
                                      )  
                     and   ftr.EFFSEQ        =
                           (SELECT MIN(DCS3.EFFSEQ)
                            from   nhrdw_sf50_transaction DCS3
                            where  DCS3.EMPLID    = ftr.EMPLID
                            and    DCS3.EMPL_RCD  = ftr.EMPL_RCD
                            and    DCS3.EFFDT     = ftr.EFFDT
                            and    DCS3.SETID_DEPT =  ftr.SETID_DEPT
                     	      and    DCS3.effseq > ACT.effseq
                     	      and    (DCS3.CHG_GVT_SUBELEMENT_CODE != act.CHG_GVT_SUBELEMENT_CODE or DCS3.GVT_NOA_CODE like '3%' )
                            and    DCS3.transaction_status = 'COMPLETED' 
                           )      
                     where  act.CHANGE_IN_SUBELEMENT_CODE = 'Y'
                     and    act.transaction_status = 'COMPLETED';


                      call nhrdw_process_log_trk (-7001, 'I', 'Refresh SF50 Transaction : Change in Agency Code Subelement Phase II' );

                      commit; 

                     
                     insert into  NHRDW_SF50_DERIVE_EMPL_STATUS 
                     (
                      EMPLID                 
                     ,EMPL_RCD               
                     ,EFFDT                  
                     ,EFFSEQ    
                     ,TYPE_OF_RECORD             
                     ,GVT_NOA_CODE           
                     ,EMPL_JOB_STATUS   
                     ,GVT_SUBELEMENT_CODE           
                     ,ACT_PR_FR_EFFDT           
                     ,ACT_PR_FR_EFFSEQ          
                     ,ACT_PR_FR_GVT_NOA_CODE   
                     ,ACT_PR_FR_EMPL_JOB_STATUS 
                     ,ACT_PR_FR_GVT_SUBELEMENT_CODE 
                     ,EFFECTIVE_END_DATE
                     ) 
                     select  act.emplid
                           , act.empl_rcd
                     	  , act.effdt
                     	  , act.effseq	 
                           , 'SUBELEMENT'	  
                     	  , act.GVT_NOA_CODE
                     	  , act.EMPL_JOB_STATUS
                     	  , act.GVT_SUBELEMENT_CODE
                     	  , ftr.effdt
                     	  , ftr.effseq	  
                     	  , ftr.GVT_NOA_CODE
                     	  , ftr.EMPL_JOB_STATUS
                     	  ,	ftr.GVT_SUBELEMENT_CODE
                     	  , CASE WHEN  ftr.effdt IS NULL THEN NULL  WHEN  ftr.effdt = act.effdt then ftr.effdt else DATE_ADD(ftr.effdt, INTERVAL -1 DAY )  END 
                     from  nhrdw_sf50_transaction act
                     left outer join nhrdw_sf50_transaction ftr on     ftr.transaction_status = 'COMPLETED'
                     and   act.empl_rcd = ftr.empl_rcd
                     and   act.emplid = ftr.emplid
                     and   act.SETID_DEPT =  ftr.SETID_DEPT
                     and   ftr.effdt >  ACT.effdt
                     and   (act.CHG_GVT_SUBELEMENT_CODE != ftr.CHG_GVT_SUBELEMENT_CODE  or ftr.GVT_NOA_CODE like '3%' )
                     and   ftr.effdt = ( select min(ftr_ed.effdt) 
                     					from   nhrdw_sf50_transaction ftr_ed
                                         where  ftr_ed.emplid = ftr.emplid
                                         and    ftr_ed.empl_rcd = ftr.empl_rcd 
                                         and    ftr_ed.SETID_DEPT =  ftr.SETID_DEPT
                                         and    ftr_ed.effdt >  ACT.effdt
                                         -- and    ftr_ed.effseq >  ACT.effseq
                                         and    (ftr_ed.CHG_GVT_SUBELEMENT_CODE != ACT.CHG_GVT_SUBELEMENT_CODE or ftr_ed.GVT_NOA_CODE like '3%' )
                                         and    ftr_ed.transaction_status = 'COMPLETED' 
                                         and    ftr_ed.effseq = (select min(ftr_ed1.effseq)
                                                                 from   nhrdw_sf50_transaction ftr_ed1
                                                                 where  ftr_ed1.emplid = ftr_ed.emplid
                                                                 and    ftr_ed1.empl_rcd = ftr_ed.empl_rcd 
                                                                 and    ftr_ed1.effdt = ftr_ed.effdt 
                                                                 and    ftr_ed1.SETID_DEPT =  ftr_ed.SETID_DEPT
                     										                      	 and    (ftr_ed1.CHG_GVT_SUBELEMENT_CODE != ACT.CHG_GVT_SUBELEMENT_CODE or ftr_ed1.GVT_NOA_CODE like '3%' )
                                                                 and    ftr_ed1.transaction_status = 'COMPLETED' 
                     										  )
                                      )  
                     and   ftr.EFFSEQ        =
                           (SELECT MIN(DCS3.EFFSEQ)
                            from   nhrdw_sf50_transaction DCS3
                            where  DCS3.EMPLID    = ftr.EMPLID
                            and    DCS3.EMPL_RCD  = ftr.EMPL_RCD
                            and    DCS3.EFFDT     = ftr.EFFDT
                            and    DCS3.SETID_DEPT =  ftr.SETID_DEPT
                     	      and    (DCS3.CHG_GVT_SUBELEMENT_CODE != ACT.CHG_GVT_SUBELEMENT_CODE or DCS3.GVT_NOA_CODE like '3%' )
                            and    DCS3.transaction_status = 'COMPLETED' 
                           )        
                     where  act.CHANGE_IN_SUBELEMENT_CODE = 'Y'
                     and    act.transaction_status = 'COMPLETED'
                     AND   NOT EXISTS (   SELECT    ACT_ED.EMPLID   
                                            FROM    NHRDW_SF50_DERIVE_EMPL_STATUS ACT_ED
                      	 	                 WHERE    ACT_ED.EMPLID = ACT.EMPLID
                     					              AND     ACT_ED.EMPL_RCD = ACT.EMPL_RCD
                     					              AND     ACT_ED.EFFDT = ACT.EFFDT
                     					              AND     ACT_ED.EFFSEQ = ACT.EFFSEQ 
                     					              AND     ACT_ED.TYPE_OF_RECORD = 'SUBELEMENT');
                     					              

 

                      call nhrdw_process_log_trk (-7001, 'I', 'Refresh SF50 Transaction : Change in Department Phase I' );

                      commit;  

                     insert into  NHRDW_SF50_DERIVE_EMPL_STATUS 
                     (
                      EMPLID                 
                     ,EMPL_RCD               
                     ,EFFDT                  
                     ,EFFSEQ    
                     ,TYPE_OF_RECORD             
                     ,GVT_NOA_CODE           
                     ,EMPL_JOB_STATUS   
                     ,DEPTID        
                     ,ACT_PR_FR_EFFDT           
                     ,ACT_PR_FR_EFFSEQ          
                     ,ACT_PR_FR_GVT_NOA_CODE   
                     ,ACT_PR_FR_EMPL_JOB_STATUS 
                     ,ACT_PR_FR_DEPTID
                     ,EFFECTIVE_END_DATE
                     ) 
                     select  act.emplid
                        , act.empl_rcd
                     	  , act.effdt
                     	  , act.effseq	 
                        , 'DEPTID'  
                     	  , act.GVT_NOA_CODE
                     	  , act.EMPL_JOB_STATUS
                     	  , act.DEPTID
                     	  , ftr.effdt
                     	  , ftr.effseq	  
                     	  , ftr.GVT_NOA_CODE
                     	  , ftr.EMPL_JOB_STATUS
                     	  ,	ftr.DEPTID
                     	  , CASE WHEN  ftr.effdt IS NULL THEN NULL  WHEN  ftr.effdt = act.effdt then ftr.effdt else DATE_ADD(ftr.effdt, INTERVAL -1 DAY )  END 
                     from  nhrdw_sf50_transaction act
                     join nhrdw_sf50_transaction ftr on     ftr.transaction_status = 'COMPLETED'
                     and   act.empl_rcd = ftr.empl_rcd
                     and   act.emplid = ftr.emplid
                     and   ACT.effdt = ftr.effdt
                     and   act.SETID_DEPT =  ftr.SETID_DEPT
                     and   ftr.effseq > act.effseq
                     and   (act.CHG_DEPTID != ftr.CHG_DEPTID or ftr.GVT_NOA_CODE like '3%' )
                     and   ftr.effdt = ( select min(ftr_ed.effdt) 
                     					from   nhrdw_sf50_transaction ftr_ed
                                         where  ftr_ed.emplid = ftr.emplid
                                         and    ftr_ed.empl_rcd = ftr.empl_rcd 
                                         and    ftr_ed.effdt  = ACT.effdt
                                         and    ftr_ed.SETID_DEPT =  ACT.SETID_DEPT
                                         and    ftr_ed.effseq >  ACT.effseq
                                         and    (ftr_ed.CHG_DEPTID != act.CHG_DEPTID or ftr_ed.GVT_NOA_CODE like '3%' )
                                         and    ftr_ed.transaction_status = 'COMPLETED' 
                                         and    ftr_ed.effseq = (select min(ftr_ed1.effseq)
                                                                 from   nhrdw_sf50_transaction ftr_ed1
                                                                 where  ftr_ed1.emplid = ftr_ed.emplid
                                                                 and    ftr_ed1.empl_rcd = ftr_ed.empl_rcd 
                                                                 and    ftr_ed1.effdt = ftr_ed.effdt
                                                                 and    ftr_ed1.SETID_DEPT =  ftr_ed.SETID_DEPT 
                     									                      		 and    ftr_ed1.effseq >  ACT.effseq
                     											                       and    (ftr_ed1.CHG_DEPTID != ACT.CHG_DEPTID or ftr_ed1.GVT_NOA_CODE like '3%' )
                                                                 and    ftr_ed1.transaction_status = 'COMPLETED' 
                     										  )
                                      )  
                     and   ftr.EFFSEQ        =
                           (SELECT MIN(DCS3.EFFSEQ)
                            from   nhrdw_sf50_transaction DCS3
                            where  DCS3.EMPLID    = ftr.EMPLID
                            and    DCS3.EMPL_RCD  = ftr.EMPL_RCD
                            and    DCS3.EFFDT     = ftr.EFFDT
                            and    DCS3.SETID_DEPT =  ftr.SETID_DEPT 
                     	      and    DCS3.effseq > ACT.effseq
                     	      and    (DCS3.CHG_DEPTID != act.CHG_DEPTID or DCS3.GVT_NOA_CODE like '3%' )
                            and    DCS3.transaction_status = 'COMPLETED' 
                           )      
                     where  act.CHANGE_IN_DEPT = 'Y'
                     and    act.transaction_status = 'COMPLETED';


                      call nhrdw_process_log_trk (-7001, 'I', 'Refresh SF50 Transaction : Change in Department Phase II' );

                      commit;  
 

                     
                     insert into  NHRDW_SF50_DERIVE_EMPL_STATUS 
                     (
                      EMPLID                 
                     ,EMPL_RCD               
                     ,EFFDT                  
                     ,EFFSEQ    
                     ,TYPE_OF_RECORD             
                     ,GVT_NOA_CODE           
                     ,EMPL_JOB_STATUS   
                     ,DEPTID        
                     ,ACT_PR_FR_EFFDT           
                     ,ACT_PR_FR_EFFSEQ          
                     ,ACT_PR_FR_GVT_NOA_CODE   
                     ,ACT_PR_FR_EMPL_JOB_STATUS 
                     ,ACT_PR_FR_DEPTID
                     ,EFFECTIVE_END_DATE
                     ) 
                     select  act.emplid
                           , act.empl_rcd
                     	  , act.effdt
                     	  , act.effseq	 
                           , 'DEPTID'	  
                     	  , act.GVT_NOA_CODE
                     	  , act.EMPL_JOB_STATUS
                     	  , act.DEPTID
                     	  , ftr.effdt
                     	  , ftr.effseq	  
                     	  , ftr.GVT_NOA_CODE
                     	  , ftr.EMPL_JOB_STATUS
                     	  ,	ftr.DEPTID
                     	  , CASE WHEN  ftr.effdt IS NULL THEN NULL  WHEN  ftr.effdt = act.effdt then ftr.effdt else DATE_ADD(ftr.effdt, INTERVAL -1 DAY )  END 
                     from  nhrdw_sf50_transaction act
                     left outer join nhrdw_sf50_transaction ftr on     ftr.transaction_status = 'COMPLETED'
                     and   act.empl_rcd = ftr.empl_rcd
                     and   act.emplid = ftr.emplid
                     and   act.SETID_DEPT =  ftr.SETID_DEPT 
                     and   ftr.effdt >  ACT.effdt
                     and   ( act.CHG_DEPTID != ftr.CHG_DEPTID  or ftr.GVT_NOA_CODE like '3%' )
                     and   ftr.effdt = ( select min(ftr_ed.effdt) 
                     					from   nhrdw_sf50_transaction ftr_ed
                                         where  ftr_ed.emplid = ftr.emplid
                                         and    ftr_ed.empl_rcd = ftr.empl_rcd 
                                         and    ftr_ed.SETID_DEPT =  ftr.SETID_DEPT 
                                         and    ftr_ed.effdt >  ACT.effdt
                                         -- and    ftr_ed.effseq >  ACT.effseq
                                         and    ( ftr_ed.CHG_DEPTID != ACT.CHG_DEPTID  or ftr_ed.GVT_NOA_CODE like '3%' )
                                         and    ftr_ed.transaction_status = 'COMPLETED' 
                                         and    ftr_ed.effseq = (select min(ftr_ed1.effseq)
                                                                 from   nhrdw_sf50_transaction ftr_ed1
                                                                 where  ftr_ed1.emplid = ftr_ed.emplid
                                                                 and    ftr_ed1.empl_rcd = ftr_ed.empl_rcd 
                                                                 and    ftr_ed1.effdt = ftr_ed.effdt 
                                                                 and    ftr_ed1.SETID_DEPT =  ftr_ed.SETID_DEPT 
                     											                       and    ( ftr_ed1.CHG_DEPTID != ACT.CHG_DEPTID    or ftr_ed1.GVT_NOA_CODE like '3%' )   
                                                                 and    ftr_ed1.transaction_status = 'COMPLETED' 
                     										  )
                                      )  
                     and   ftr.EFFSEQ        =
                           (SELECT MIN(DCS3.EFFSEQ)
                            from   nhrdw_sf50_transaction DCS3
                            where  DCS3.EMPLID    = ftr.EMPLID
                            and    DCS3.EMPL_RCD  = ftr.EMPL_RCD
                            and    DCS3.EFFDT     = ftr.EFFDT
                            and    DCS3.SETID_DEPT =  ftr.SETID_DEPT 
                     	      and    ( DCS3.CHG_DEPTID != ACT.CHG_DEPTID  or DCS3.GVT_NOA_CODE like '3%' )
                            and    DCS3.transaction_status = 'COMPLETED' 
                           )        
                     where  act.CHANGE_IN_DEPT = 'Y'
                     and    act.transaction_status = 'COMPLETED'
                     AND   NOT EXISTS (   SELECT    ACT_ED.EMPLID   
                                            FROM    NHRDW_SF50_DERIVE_EMPL_STATUS ACT_ED
                      	 	                 WHERE    ACT_ED.EMPLID = ACT.EMPLID
                     					              AND     ACT_ED.EMPL_RCD = ACT.EMPL_RCD
                     					              AND     ACT_ED.EFFDT = ACT.EFFDT
                     					              AND     ACT_ED.EFFSEQ = ACT.EFFSEQ 
                     					              AND     ACT_ED.TYPE_OF_RECORD = 'DEPTID');
                     					              

                      call nhrdw_process_log_trk (-7001, 'I', 'Refresh SF50 Transaction : Change in Supervisory Level Phase I' );

                      commit; 



                     insert into  NHRDW_SF50_DERIVE_EMPL_STATUS 
                     (
                      EMPLID                 
                     ,EMPL_RCD               
                     ,EFFDT                  
                     ,EFFSEQ    
                     ,TYPE_OF_RECORD             
                     ,GVT_NOA_CODE           
                     ,EMPL_JOB_STATUS   
                     ,SUPV_LVL_ID            
                     ,ACT_PR_FR_EFFDT           
                     ,ACT_PR_FR_EFFSEQ          
                     ,ACT_PR_FR_GVT_NOA_CODE   
                     ,ACT_PR_FR_EMPL_JOB_STATUS 
                     ,ACT_PR_FR_SUPV_LVL_ID
                     ,EFFECTIVE_END_DATE
                     ) 
                     select  act.emplid
                        , act.empl_rcd
                     	  , act.effdt
                     	  , act.effseq	 
                        , 'SUPV_LVL_ID'	  
                     	  , act.GVT_NOA_CODE
                     	  , act.EMPL_JOB_STATUS
                     	  , act.SUPV_LVL_ID
                     	  , ftr.effdt
                     	  , ftr.effseq	  
                     	  , ftr.GVT_NOA_CODE
                     	  , ftr.EMPL_JOB_STATUS
                     	  ,	ftr.SUPV_LVL_ID
                     	  , CASE WHEN  ftr.effdt IS NULL THEN NULL  WHEN  ftr.effdt = act.effdt then ftr.effdt else DATE_ADD(ftr.effdt, INTERVAL -1 DAY )  END 
                     from  nhrdw_sf50_transaction act
                     join nhrdw_sf50_transaction ftr on     ftr.transaction_status = 'COMPLETED'
                     and   act.empl_rcd = ftr.empl_rcd
                     and   act.emplid = ftr.emplid
                     and   ACT.effdt = ftr.effdt
                     and   ACT.SETID_DEPT =  ftr.SETID_DEPT
                     and   ftr.effseq > act.effseq
                     and   ( act.CHG_SUPV_LVL_ID != ftr.CHG_SUPV_LVL_ID or ftr.GVT_NOA_CODE like '3%' )
                     and   ftr.effdt = ( select min(ftr_ed.effdt) 
                     					from   nhrdw_sf50_transaction ftr_ed
                                         where  ftr_ed.emplid = ftr.emplid
                                         and    ftr_ed.empl_rcd = ftr.empl_rcd 
                                         and    ftr_ed.effdt  = ACT.effdt
                                         and    ftr_ed.SETID_DEPT =  ACT.SETID_DEPT
                                         and    ftr_ed.effseq >  ACT.effseq
                                         and    (ftr_ed.CHG_SUPV_LVL_ID != act.CHG_SUPV_LVL_ID or ftr_ed.GVT_NOA_CODE like '3%' )
                                         and    ftr_ed.transaction_status = 'COMPLETED' 
                                         and    ftr_ed.effseq = (select min(ftr_ed1.effseq)
                                                                 from   nhrdw_sf50_transaction ftr_ed1
                                                                 where  ftr_ed1.emplid = ftr_ed.emplid
                                                                 and    ftr_ed1.empl_rcd = ftr_ed.empl_rcd 
                                                                 and    ftr_ed1.effdt = ftr_ed.effdt 
                                                                 and    ftr_ed1.SETID_DEPT =  ftr_ed.SETID_DEPT
                     										                      	 and    ftr_ed1.effseq >  ACT.effseq
                     										                      	 and    (ftr_ed1.CHG_SUPV_LVL_ID != ACT.CHG_SUPV_LVL_ID or ftr_ed1.GVT_NOA_CODE like '3%' )
                                                                 and    ftr_ed1.transaction_status = 'COMPLETED' 
                     										                        )
                                      )  
                     and   ftr.EFFSEQ        =
                           (SELECT MIN(DCS3.EFFSEQ)
                            from   nhrdw_sf50_transaction DCS3
                            where  DCS3.EMPLID    = ftr.EMPLID
                            and    DCS3.EMPL_RCD  = ftr.EMPL_RCD
                            and    DCS3.EFFDT     = ftr.EFFDT
                            and    DCS3.SETID_DEPT =  ftr.SETID_DEPT
                     	      and    DCS3.effseq > ACT.effseq
                     	      and    (DCS3.CHG_SUPV_LVL_ID != act.CHG_SUPV_LVL_ID or DCS3.GVT_NOA_CODE like '3%' )
                            and    DCS3.transaction_status = 'COMPLETED' 
                           )      
                     where  act.CHANGE_IN_SUPV_LVL_ID  = 'Y'
                     and    act.transaction_status = 'COMPLETED';


                      call nhrdw_process_log_trk (-7001, 'I', 'Refresh SF50 Transaction : Change in Supervisory Level Phase II' );

                      commit; 

                     
                     insert into  NHRDW_SF50_DERIVE_EMPL_STATUS 
                     (
                      EMPLID                 
                     ,EMPL_RCD               
                     ,EFFDT                  
                     ,EFFSEQ    
                     ,TYPE_OF_RECORD             
                     ,GVT_NOA_CODE           
                     ,EMPL_JOB_STATUS   
                     ,SUPV_LVL_ID           
                     ,ACT_PR_FR_EFFDT           
                     ,ACT_PR_FR_EFFSEQ          
                     ,ACT_PR_FR_GVT_NOA_CODE   
                     ,ACT_PR_FR_EMPL_JOB_STATUS 
                     ,ACT_PR_FR_SUPV_LVL_ID
                     ,EFFECTIVE_END_DATE
                     ) 
                     select  act.emplid
                           , act.empl_rcd
                     	  , act.effdt
                     	  , act.effseq	 
                        , 'SUPV_LVL_ID'	  
                     	  , act.GVT_NOA_CODE
                     	  , act.EMPL_JOB_STATUS
                     	  , act.SUPV_LVL_ID
                     	  , ftr.effdt
                     	  , ftr.effseq	  
                     	  , ftr.GVT_NOA_CODE
                     	  , ftr.EMPL_JOB_STATUS
                     	  ,	ftr.SUPV_LVL_ID
                     	  , CASE WHEN  ftr.effdt IS NULL THEN NULL  WHEN  ftr.effdt = act.effdt then ftr.effdt else DATE_ADD(ftr.effdt, INTERVAL -1 DAY )  END 
                     from  nhrdw_sf50_transaction act
                     left outer join nhrdw_sf50_transaction ftr on     ftr.transaction_status = 'COMPLETED'
                     and   act.empl_rcd = ftr.empl_rcd
                     and   act.emplid = ftr.emplid
                     and   act.SETID_DEPT =  ftr.SETID_DEPT
                     and   ftr.effdt >  ACT.effdt
                     and   (act.CHG_SUPV_LVL_ID != ftr.CHG_SUPV_LVL_ID  or ftr.GVT_NOA_CODE like '3%' )
                     and   ftr.effdt = ( select min(ftr_ed.effdt) 
                     					from   nhrdw_sf50_transaction ftr_ed
                                         where  ftr_ed.emplid = ftr.emplid
                                         and    ftr_ed.empl_rcd = ftr.empl_rcd 
                                         and    ftr_ed.SETID_DEPT =  ftr.SETID_DEPT
                                         and    ftr_ed.effdt >  ACT.effdt
                                         -- and    ftr_ed.effseq >  ACT.effseq
                                         and    (ftr_ed.CHG_SUPV_LVL_ID != ACT.CHG_SUPV_LVL_ID or ftr_ed.GVT_NOA_CODE like '3%' )
                                         and    ftr_ed.transaction_status = 'COMPLETED' 
                                         and    ftr_ed.effseq = (select min(ftr_ed1.effseq)
                                                                 from   nhrdw_sf50_transaction ftr_ed1
                                                                 where  ftr_ed1.emplid = ftr_ed.emplid
                                                                 and    ftr_ed1.empl_rcd = ftr_ed.empl_rcd 
                                                                 and    ftr_ed1.effdt = ftr_ed.effdt 
                                                                 and    ftr_ed1.SETID_DEPT =  ftr_ed.SETID_DEPT
                     										                      	 and    (ftr_ed1.CHG_SUPV_LVL_ID != ACT.CHG_SUPV_LVL_ID or ftr_ed1.GVT_NOA_CODE like '3%' )
                                                                 and    ftr_ed1.transaction_status = 'COMPLETED' 
                     										  )
                                      )  
                     and   ftr.EFFSEQ        =
                           (SELECT MIN(DCS3.EFFSEQ)
                            from   nhrdw_sf50_transaction DCS3
                            where  DCS3.EMPLID    = ftr.EMPLID
                            and    DCS3.EMPL_RCD  = ftr.EMPL_RCD
                            and    DCS3.EFFDT     = ftr.EFFDT
                            and    DCS3.SETID_DEPT =  ftr.SETID_DEPT
                     	      and    (DCS3.CHG_SUPV_LVL_ID != ACT.CHG_SUPV_LVL_ID or DCS3.GVT_NOA_CODE like '3%' )
                            and    DCS3.transaction_status = 'COMPLETED' 
                           )        
                     where  act.CHANGE_IN_SUPV_LVL_ID = 'Y'
                     and    act.transaction_status = 'COMPLETED'
                     AND   NOT EXISTS (   SELECT    ACT_ED.EMPLID   
                                            FROM    NHRDW_SF50_DERIVE_EMPL_STATUS ACT_ED
                      	 	                 WHERE    ACT_ED.EMPLID = ACT.EMPLID
                     					              AND     ACT_ED.EMPL_RCD = ACT.EMPL_RCD
                     					              AND     ACT_ED.EFFDT = ACT.EFFDT
                     					              AND     ACT_ED.EFFSEQ = ACT.EFFSEQ 
                     					              AND     ACT_ED.TYPE_OF_RECORD = 'SUPV_LVL_ID');

                      call nhrdw_process_log_trk (-7001, 'I', 'Refresh SF50 Transaction : Insert SF50 Personnel Action' );

                      commit;  

                      INSERT INTO NHRDW_PERSONNEL_ACTION 
                      (
                       SF50_TRANSACTION_CONTROL_ID
                      ,EMPLID
                      ,EMPL_RCD
                      ,EFFDT
                      ,EFFSEQ
                      ,ACTION_EFFDT
                      ,FOURDIGIT_FISCAL_YEAR_OF_EFFDT
                      ,FISCAL_YEAR_ACTION_EFFDT
                      ,ACTION
                      ,ACTION_DT
                      ,ACTION_REASON
                      ,ACTION_DESCR
                      ,ACTION_DESCRSHORT
                      ,ACTION_REASON_DESCR
                      ,ACT_STATUS
                      ,GVT_NOA_CODE
                      ,GVT_NOA_DESC
                      ,GVT_NOA_CODE_DESC
                      ,ACT_EMPL_JOB_STATUS
                      ,EFFECTIVE_STATUS_START_DATE
                      ,EFFECTIVE_STATUS_END_DATE
                      ,ACT_GVT_WIP_STATUS
                      ,ACT_GVT_STATUS_TYPE
                      ,ACT_EMPL_STATUS
                      ,FRM_EMPL_STATUS
                      ,ACT_GVT_SUB_ELEMENT_CODE
                      ,AGENCY_DEPT_MOVEMENT_INDICATOR
                      ,ACT_PR_EFFDT
                      ,ACT_PR_EFFSEQ
                      ,ACT_PR_GVT_NOA_CODE
                      ,ACT_PR_GVT_WIP_STATUS
                      ,ACT_PR_GVT_STATUS_TYPE
                      ,FRM_GVT_SUB_ELEMENT_CODE
                      ,TRANSACTION_STATUS
                      ,FIRST_NOA_CODE
                      ,SECOND_NOA_CODE
                      ,ACT_GVT_LEG_AUTH_1
                      ,ACT_GVT_LEG_AUTH_2
                      ,ACT_GVT_PAR_AUTH_D1
                      ,ACT_GVT_PAR_AUTH_D1_2
                      ,ACT_GVT_PAR_AUTH_D2
                      ,ACT_GVT_PAR_AUTH_D2_2
                      ,ACT_GVT_PAR_NTE_DATE
                      ,ACT_AGENCY_CODE
                      ,ACT_GVT_SUB_AGENCY
                      ,ACT_DEPTID
                      ,ACT_DEPT_GSA_REGION
                      ,ACT_DEPT_GSA_SSO
				              ,ACT_DEPT_GSA_SSO_DESCR
                      ,ACT_JOBCODE
                      ,ACT_POSITION_NBR
                      ,ACT_BUSINESS_UNIT
                      ,ACT_GVT_POI
                      ,ACT_GVT_POI_DESCR
                      ,ACT_SF50_POI_APPROVER_TITLE
                      ,ACT_SF50_POI_APPROVER_NAME
                      ,ACT_DEPT_ENTRY_DT
                      ,ACT_GRADE_ENTRY_DT
                      ,ACT_STEP_ENTRY_DT
                      ,ACT_POSITION_ENTRY_DT
                      ,ACT_JOB_ENTRY_DT
                      ,ACT_GVT_WORK_SCHED
                      ,ACT_GRADE
                      ,ACT_GVT_STEP
                      ,ACT_GVT_PAY_PLAN
                      ,ACT_SAL_ADMIN_PLAN
                      ,ACT_GVT_PAY_BASIS
                      ,ACT_GVT_PAY_RATE_DETER
                      ,ACT_GVT_COMPRATE
                      ,ACT_GVT_LOCALITY_ADJ
                      ,ACT_ADJUSTED_BASIC_PAY
                      ,FRM_AGENCY_CODE
                      ,FRM_GVT_SUB_AGENCY
                      ,FRM_DEPTID
                      ,FRM_DEPT_GSA_REGION
                      ,FRM_DEPT_GSA_SSO
					            ,FRM_DEPT_GSA_SSO_DESCR
                      ,FRM_JOBCODE
                      ,FRM_POSITION_NBR
                      ,FRM_BUSINESS_UNIT
                      ,FRM_GVT_POI
                      ,FRM_GVT_POI_DESCR
                      ,FRM_DEPT_ENTRY_DT
                      ,FRM_GRADE_ENTRY_DT
                      ,FRM_STEP_ENTRY_DT
                      ,FRM_POSITION_ENTRY_DT
                      ,FRM_JOB_ENTRY_DT
                      ,FRM_GVT_WORK_SCHED
                      ,FRM_GRADE
                      ,FRM_GVT_STEP
                      ,FRM_GVT_PAY_PLAN
                      ,FRM_SAL_ADMIN_PLAN
                      ,FRM_GVT_PAY_BASIS
                      ,FRM_GVT_PAY_RATE_DETER
                      ,FRM_GVT_COMPRATE
                      ,FRM_GVT_LOCALITY_ADJ
                      ,FRM_ADJUSTED_BASIC_PAY
                      ,ACT_GVT_XFER_FROM_AGCY
                      ,ACT_GVT_XFER_TO_AGCY
                      ,ACT_GVT_ANN_IND
                      ,FRM_GVT_ANN_IND
                      ,ACT_GVT_ANNUITY_OFFSET
                      ,FRM_GVT_ANNUITY_OFFSET
                      ,ACT_GVT_RETIRE_PLAN
                      ,FRM_GVT_RETIRE_PLAN
                      ,ACT_GVT_FEGLI
                      ,FRM_GVT_FEGLI
                      ,ACT_GVT_FEGLI_DESCR
                      ,FRM_GVT_FEGLI_DESCR
                      ,ACT_GVT_RTND_PAY_PLAN
                      ,ACT_GVT_RTND_SAL_PLAN
                      ,ACT_GVT_RTND_GRADE
                      ,ACT_GVT_RTND_STEP
                      ,ACT_GVT_RTND_GVT_STEP
                      ,ACT_GVT_FERS_COVERAGE
                      ,ACT_GVT_PREV_RET_COVRG
                      ,ACT_GVT_TYPE_OF_APPT
                      ,ACT_GVT_SF52_NBR
                      ,ACT_GVT_LEO_POSITION
                      ,ACT_GVT_DETL_POSN_NBR
                      ,ACT_REPORTS_TO
                      ,FRM_GVT_RTND_PAY_PLAN
                      ,FRM_GVT_RTND_SAL_PLAN
                      ,FRM_GVT_RTND_GRADE
                      ,FRM_GVT_RTND_STEP
                      ,FRM_GVT_RTND_GVT_STEP
                      ,FRM_GVT_FERS_COVERAGE
                      ,FRM_GVT_PREV_RET_COVRG
                      ,FRM_GVT_TYPE_OF_APPT
                      ,FRM_GVT_SF52_NBR
                      ,FRM_GVT_LEO_POSITION
                      ,FRM_GVT_DETL_POSN_NBR
                      ,ACT_STD_HOURS
                      ,FRM_STD_HOURS
                      ,ACT_GVT_POSN_OCCUPIED
                      ,FRM_GVT_POSN_OCCUPIED
                      ,ACT_FLSA_STATUS
                      ,FRM_FLSA_STATUS
                      ,ACT_BARG_UNIT
                      ,FRM_BARG_UNIT
                      ,ACT_BARG_UNIT_DESCR
                      ,FRM_BARG_UNIT_DESCR
                      ,ACT_LOCATION
                      ,FRM_LOCATION
                      ,ACT_GVT_FUNC_CLASS                                       
                      ,FRM_GVT_FUNC_CLASS                                    
                      ,DISABILITY_VETERAN_LEAVE_BEGIN_DATE
                      ,DISABILITY_VETERAN_LEAVE_END_DATE
                      ,ACT_SETID_DEPT
                      ,FRM_SETID_DEPT
                      ,ACT_SETID_LOCATION
                      ,FRM_SETID_LOCATION
                      ,ACT_EMPL_STATUS_DESCR           
                      ,ACT_FLSA_STATUS_DESCR           
                      ,ACT_GVT_WORK_SCHED_DESCR        
                      ,ACT_GVT_PAY_RATE_DETER_DESCR    
                      ,ACT_GVT_PAY_BASIS_DESCR         
                      ,ACT_GVT_RETIRE_PLAN_DESCR       
                      ,ACT_GVT_ANN_IND_DESCR           
                      ,ACT_GVT_PREV_RET_COVRG_DESCR              
                      ,ACT_GVT_FERS_COVERAGE_DESCR              
                      ,ACT_GVT_TYPE_OF_APPT_DESCR                   
                      ,ACT_GVT_POSN_OCCUPIED_DESCR                             
                      ,ACT_GVT_LEO_POSITION_DESCR                                     	                  
                      ,FRM_EMPL_STATUS_DESCR           
                      ,FRM_FLSA_STATUS_DESCR           
                      ,FRM_GVT_WORK_SCHED_DESCR        
                      ,FRM_GVT_PAY_RATE_DETER_DESCR    
                      ,FRM_GVT_PAY_BASIS_DESCR         
                      ,FRM_GVT_RETIRE_PLAN_DESCR       
                      ,FRM_GVT_ANN_IND_DESCR           
                      ,FRM_GVT_PREV_RET_COVRG_DESCR              
                      ,FRM_GVT_FERS_COVERAGE_DESCR              
                      ,FRM_GVT_TYPE_OF_APPT_DESCR                   
                      ,FRM_GVT_POSN_OCCUPIED_DESCR                             
                      ,FRM_GVT_LEO_POSITION_DESCR      					  
                      ,ACT_GVT_FUNC_CLASS_DESCR                                                 
                      ,FRM_GVT_FUNC_CLASS_DESCR                                                 
                      ,EFFECTIVE_SUBELEMENT_END_DATE  
                      ,EFFECTIVE_DEPT_END_DATE        
                      ,CHANGE_IN_DEPT                 
                      ,CHANGE_IN_SUBELEMENT_CODE      
                      ,CHANGE_IN_JOB_STATUS
                      ,CHANGE_IN_SUPV_LVL_ID 
                      ,EFFECTIVE_SUPV_LVL_ID_END_DATE  
                      ,ACT_MSS_TRANSACTION_NBR      
                      ,ACT_MSS_TRANSACTION_TYPE     
                      ,ACT_MSS_CADW_TRANSACTION_NBR 
                      ,FRM_MSS_TRANSACTION_NBR      
                      ,FRM_MSS_TRANSACTION_TYPE     
                      ,FRM_MSS_CADW_TRANSACTION_NBR 
                      )
                        select
                       sf50.SF50_TRANSACTION_CONTROL_ID
                      ,sf50.EMPLID                        
                      ,sf50.EMPL_RCD                      
                      ,sf50.EFFDT                         
                      ,sf50.EFFSEQ    
                      ,sf50.ACTION_EFFDT
                      ,YEAR(DATE_FORMAT(DATE_ADD(sf50.ACTION_EFFDT,INTERVAL 3 MONTH) ,'%Y-09-30')) FOURDIGIT_FISCAL_YEAR_OF_EFFDT
                      ,CONCAT('FY',SUBSTR(YEAR(DATE_FORMAT(DATE_ADD(sf50.ACTION_EFFDT,INTERVAL 3 MONTH) ,'%Y-09-30')),3,2)) FISCAL_YEAR_ACTION_EFFDT
                      ,TOJOB.ACTION            
                      ,TOJOB.ACTION_DT
                      ,TOJOB.ACTION_REASON          
                      ,toatb.ACTION_DESCR          ACTION_DESCR         
                      ,toatb.ACTION_DESCRSHORT     ACTION_DESCRSHORT    
                      ,toact_r.DESCR               ACTION_REASON_DESCR  
                      ,sf50.ACT_STATUS                    
                      ,sf50.GVT_NOA_CODE  
                      ,CONCAT(COALESCE(GVNOA.DESCR25,' ') ,' ',COALESCE(GVNOA.DESCR25_2,' ')) GVT_NOA_DESC  
                      ,CONCAT(sf50.GVT_NOA_CODE, '-', COALESCE(GVNOA.DESCR25,' ') ,' ',COALESCE(GVNOA.DESCR25_2,' ')) GVT_NOA_CODE_DESC  
                      ,CASE WHEN sf50.EMPL_JOB_STATUS = 'Prior Status' then npaest.EMPL_JOB_STATUS else sf50.EMPL_JOB_STATUS end  ACT_EMPL_JOB_STATUS      
                      ,CASE WHEN sf50.GVT_NOA_CODE IN ('732','932') THEN DATE_ADD(sf50.ACTION_EFFDT, INTERVAL 1 DAY )  WHEN sf50.GVT_NOA_CODE LIKE '3%' THEN sf50.EFFDT  ELSE  sf50.ACTION_EFFDT  END     
                      ,sf50.EFFECTIVE_STATUS_END_DATE      
                      ,sf50.GVT_WIP_STATUS   ACT_GVT_WIP_STATUS             
                      ,sf50.GVT_STATUS_TYPE  ACT_GVT_STATUS_TYPE                              
                      ,sf50.EMPL_STATUS      ACT_EMPL_STATUS
                      ,frjob.EMPL_STATUS     FRM_EMPL_STATUS
                      ,concat(sf50.COMPANY, sf50.GVT_SUB_AGENCY)  ACT_GVT_SUB_ELEMENT_CODE   
                      ,nhrdw_find_agency_dept_movement(sf50.GVT_NOA_CODE,concat(sf50.COMPANY, sf50.GVT_SUB_AGENCY),concat(sf50.ACT_PR_COMPANY, sf50.ACT_PR_GVT_SUB_AGENCY),sf50.DEPTID,sf50.ACT_PR_DEPTID)   AGENCY_DEPT_MOVEMENT_INDICATOR             
                      ,sf50.ACT_PR_EFFDT                  
                      ,sf50.ACT_PR_EFFSEQ                 
                      ,sf50.ACT_PR_GVT_NOA_CODE           
                      ,sf50.ACT_PR_GVT_WIP_STATUS         
                      ,sf50.ACT_PR_GVT_STATUS_TYPE        
                      ,concat(sf50.ACT_PR_COMPANY, sf50.ACT_PR_GVT_SUB_AGENCY)  FRM_GVT_SUB_ELEMENT_CODE                                     
                      ,sf50.TRANSACTION_STATUS 
                      ,CASE WHEN SF50.GVT_WIP_STATUS = 'COR' THEN '002' ELSE SF50.GVT_NOA_CODE END  FIRST_NOA_CODE
                      ,CASE WHEN SF50.GVT_WIP_STATUS = 'COR' THEN  SF50.GVT_NOA_CODE ELSE NULL END  SECOND_NOA_CODE
                      ,TOJOB.GVT_LEG_AUTH_1                      ACT_GVT_LEG_AUTH_1           
                      ,TOJOB.GVT_LEG_AUTH_2                      ACT_GVT_LEG_AUTH_2           
                      ,TOJOB.GVT_PAR_AUTH_D1                     ACT_GVT_PAR_AUTH_D1          
                      ,TOJOB.GVT_PAR_AUTH_D1_2                   ACT_GVT_PAR_AUTH_D1_2        
                      ,TOJOB.GVT_PAR_AUTH_D2                     ACT_GVT_PAR_AUTH_D2          
                      ,TOJOB.GVT_PAR_AUTH_D2_2                   ACT_GVT_PAR_AUTH_D2_2        
                      ,TOJOB.GVT_PAR_NTE_DATE                    ACT_GVT_PAR_NTE_DATE         
                      ,TOJOB.COMPANY                             ACT_AGENCY_CODE                   
                      ,TOJOB.GVT_SUB_AGENCY                      ACT_GVT_SUB_AGENCY            
                      ,TOJOB.DEPTID                              ACT_DEPTID                   
                      ,nhrdw_get_gsa_region(TOJOB.SETID_DEPT,TOJOB.DEPTID )                                                                     ACT_DEPT_GSA_REGION       
                      ,toosr.X_FIELDVALUE                          ACT_DEPT_GSA_SSO
					            ,toosr.SHORT_DESC                          ACT_DEPT_GSA_SSO_DESCR
                      ,TOJOB.JOBCODE                             ACT_JOBCODE                   
                      ,TOJOB.POSITION_NBR                        ACT_POSITION_NBR              
                      ,TOJOB.BUSINESS_UNIT                       ACT_BUSINESS_UNIT             
                      ,TOJOB.GVT_POI                             ACT_GVT_POI   
                      ,TOPOI.DESCR                               ACT_GVT_POI_DESCR   
                      ,TOPSG.GVT_ORG_TTL_DESCR                   ACT_SF50_POI_APPROVER_TITLE
                      ,TOPSG.GVT_PO_NAME                         ACT_SF50_POI_APPROVER_NAME
                      ,TOJOB.DEPT_ENTRY_DT                       ACT_DEPT_ENTRY_DT             
                      ,TOJOB.GRADE_ENTRY_DT                      ACT_GRADE_ENTRY_DT            
                      ,TOJOB.STEP_ENTRY_DT                       ACT_STEP_ENTRY_DT             
                      ,TOJOB.POSITION_ENTRY_DT                   ACT_POSITION_ENTRY_DT         
                      ,TOJOB.JOB_ENTRY_DT                        ACT_JOB_ENTRY_DT              
                      ,TOJOB.GVT_WORK_SCHED                      ACT_GVT_WORK_SCHED            
                      ,TOJOB.GRADE                               ACT_GRADE                     
                      ,TOJOB.GVT_STEP                            ACT_GVT_STEP                  
                      ,TOJOB.GVT_PAY_PLAN                        ACT_GVT_PAY_PLAN   
                      ,TOJOB.SAL_ADMIN_PLAN                      ACT_SAL_ADMIN_PLAN                 
                      ,TOJOB.GVT_PAY_BASIS                       ACT_GVT_PAY_BASIS             
                      ,TOJOB.GVT_PAY_RATE_DETER                  ACT_GVT_PAY_RATE_DETER        
                      ,TOJOB.GVT_COMPRATE                        ACT_GVT_COMPRATE              
                      ,TOJOB.GVT_LOCALITY_ADJ                    ACT_GVT_LOCALITY_ADJ   
                      ,round(TOJOB.GVT_COMPRATE + TOJOB.GVT_LOCALITY_ADJ, 2) ACT_ADJUSTED_BASIC_PAY       
                      ,FRJOB.COMPANY                             FRM_AGENCY_CODE                   
                      ,FRJOB.GVT_SUB_AGENCY                      FRM_GVT_SUB_AGENCY            
                      ,FRJOB.DEPTID                              FRM_DEPTID                   
                      ,nhrdw_get_gsa_region(FRJOB.SETID_DEPT,FRJOB.DEPTID )                                                                     FRM_DEPT_GSA_REGION       
                      ,frosr.X_FIELDVALUE                          FRM_DEPT_GSA_SSO
					            ,frosr.SHORT_DESC                          FRM_DEPT_GSA_SSO_DESCR
                      ,FRJOB.JOBCODE                             FRM_JOBCODE                   
                      ,FRJOB.POSITION_NBR                        FRM_POSITION_NBR              
                      ,FRJOB.BUSINESS_UNIT                       FRM_BUSINESS_UNIT             
                      ,FRJOB.GVT_POI                             FRM_GVT_POI  
                      ,FRPOI.DESCR                               FRM_GVT_POI_DESCR                    
                      ,FRJOB.DEPT_ENTRY_DT                       FRM_DEPT_ENTRY_DT             
                      ,FRJOB.GRADE_ENTRY_DT                      FRM_GRADE_ENTRY_DT            
                      ,FRJOB.STEP_ENTRY_DT                       FRM_STEP_ENTRY_DT             
                      ,FRJOB.POSITION_ENTRY_DT                   FRM_POSITION_ENTRY_DT         
                      ,FRJOB.JOB_ENTRY_DT                        FRM_JOB_ENTRY_DT              
                      ,FRJOB.GVT_WORK_SCHED                      FRM_GVT_WORK_SCHED            
                      ,FRJOB.GRADE                               FRM_GRADE                     
                      ,FRJOB.GVT_STEP                            FRM_GVT_STEP                  
                      ,FRJOB.GVT_PAY_PLAN                        FRM_GVT_PAY_PLAN  
                      ,FRJOB.SAL_ADMIN_PLAN                      FRM_SAL_ADMIN_PLAN             
                      ,FRJOB.GVT_PAY_BASIS                       FRM_GVT_PAY_BASIS             
                      ,FRJOB.GVT_PAY_RATE_DETER                  FRM_GVT_PAY_RATE_DETER        
                      ,FRJOB.GVT_COMPRATE                        FRM_GVT_COMPRATE     
                      ,FRJOB.GVT_LOCALITY_ADJ                    FRM_GVT_LOCALITY_ADJ        
                      ,round(FRJOB.GVT_COMPRATE + FRJOB.GVT_LOCALITY_ADJ, 2) FRM_ADJUSTED_BASIC_PAY       
                      ,TOJOB.GVT_XFER_FROM_AGCY	                 GVT_XFER_FROM_AGCY    			
                      ,TOJOB.GVT_XFER_TO_AGCY                    GVT_XFER_TO_AGCY
                      ,TOJOB.GVT_ANN_IND                         ACT_GVT_ANN_IND
                      ,FRJOB.GVT_ANN_IND                         FRM_GVT_ANN_IND
                      ,TOJOB.GVT_ANNUITY_OFFSET                  ACT_GVT_ANNUITY_OFFSET
                      ,FRJOB.GVT_ANNUITY_OFFSET                  FRM_GVT_ANNUITY_OFFSET
                      ,TOJOB.GVT_RETIRE_PLAN                     ACT_GVT_RETIRE_PLAN
                      ,FRJOB.GVT_RETIRE_PLAN                     FRM_GVT_RETIRE_PLAN 
                      ,TOJOB.GVT_FEGLI                           ACT_GVT_FEGLI
                      ,FRJOB.GVT_FEGLI                           FRM_GVT_FEGLI
                      ,TOFEG.DESCR50                             ACT_GVT_FEGLI_DESCR 
                      ,FRFEG.DESCR50                             FRM_GVT_FEGLI_DESCR 
                      ,TOJOB.GVT_RTND_PAY_PLAN                   ACT_GVT_RTND_PAY_PLAN   
                      ,TOJOB.GVT_RTND_SAL_PLAN                   ACT_GVT_RTND_SAL_PLAN   
                      ,TOJOB.GVT_RTND_GRADE                      ACT_GVT_RTND_GRADE      
                      ,TOJOB.GVT_RTND_STEP                       ACT_GVT_RTND_STEP       
                      ,TOJOB.GVT_RTND_GVT_STEP                   ACT_GVT_RTND_GVT_STEP   
                      ,TOJOB.GVT_FERS_COVERAGE                   ACT_GVT_FERS_COVERAGE   
                      ,TOJOB.GVT_PREV_RET_COVRG                  ACT_GVT_PREV_RET_COVRG 
                      ,TOJOB.GVT_TYPE_OF_APPT                    ACT_GVT_TYPE_OF_APPT    
                      ,TOJOB.GVT_SF52_NBR                        ACT_GVT_SF52_NBR        
                      ,TOJOB.GVT_LEO_POSITION                    ACT_GVT_LEO_POSITION    
                      ,TOJOB.GVT_DETL_POSN_NBR                   ACT_GVT_DETL_POSN_NBR   
                      ,TOJOB.REPORTS_TO                          ACT_REPORTS_TO          
                      ,FRJOB.GVT_RTND_PAY_PLAN                   FRM_GVT_RTND_PAY_PLAN   
                      ,FRJOB.GVT_RTND_SAL_PLAN                   FRM_GVT_RTND_SAL_PLAN   
                      ,FRJOB.GVT_RTND_GRADE                      FRM_GVT_RTND_GRADE      
                      ,FRJOB.GVT_RTND_STEP                       FRM_GVT_RTND_STEP       
                      ,FRJOB.GVT_RTND_GVT_STEP                   FRM_GVT_RTND_GVT_STEP   
                      ,FRJOB.GVT_FERS_COVERAGE                   FRM_GVT_FERS_COVERAGE   
                      ,FRJOB.GVT_PREV_RET_COVRG                  FRM_GVT_PREV_RET_COVRG 
                      ,FRJOB.GVT_TYPE_OF_APPT                    FRM_GVT_TYPE_OF_APPT    
                      ,FRJOB.GVT_SF52_NBR                        FRM_GVT_SF52_NBR        
                      ,FRJOB.GVT_LEO_POSITION                    FRM_GVT_LEO_POSITION    
                      ,FRJOB.GVT_DETL_POSN_NBR                   FRM_GVT_DETL_POSN_NBR   
                      ,TOJOB.STD_HOURS * 2                       ACT_STD_HOURS
                      ,FRJOB.STD_HOURS * 2                       FRM_STD_HOURS
                      ,TOJOB.GVT_POSN_OCCUPIED                   ACT_GVT_POSN_OCCUPIED
                      ,FRJOB.GVT_POSN_OCCUPIED                   FRM_GVT_POSN_OCCUPIED
                      ,TOJOB.FLSA_STATUS                         ACT_FLSA_STATUS
                      ,FRJOB.FLSA_STATUS                         FRM_FLSA_STATUS  
                      ,TOJOB.BARG_UNIT                           ACT_BARG_UNIT
                      ,FRJOB.BARG_UNIT                           FRM_BARG_UNIT 
                      ,tobrg.DESCR                               ACT_BARG_UNIT_DESCR
                      ,frbrg.DESCR                               FRM_BARG_UNIT_DESCR
                      ,TOJOB.LOCATION                            ACT_LOCATION
                      ,FRJOB.LOCATION                            FRM_LOCATION  	                                	                                                                            
                      ,TOJOB.GVT_FUNC_CLASS                      ACT_GVT_FUNC_CLASS                                       
                      ,FRJOB.GVT_FUNC_CLASS                      FRM_GVT_FUNC_CLASS
                      ,SF50.DISABILITY_VETERAN_LEAVE_BEGIN_DATE  DISABILITY_VETERAN_LEAVE_BEGIN_DATE          
                      ,SF50.DISABILITY_VETERAN_LEAVE_END_DATE    DISABILITY_VETERAN_LEAVE_END_DATE 
                      ,TOJOB.SETID_DEPT                          ACT_SETID_DEPT             
                      ,FRJOB.SETID_DEPT                          FRM_SETID_DEPT           
                      ,TOJOB.SETID_LOCATION                      ACT_SETID_LOCATION          
                      ,FRJOB.SETID_LOCATION                      FRM_SETID_LOCATION  
                      ,toest.XLATLONGNAME                        ACT_EMPL_STATUS_DESCR           
                      ,tofst.XLATLONGNAME                        ACT_FLSA_STATUS_DESCR           
                      ,towsh.XLATLONGNAME                        ACT_GVT_WORK_SCHED_DESCR        
                      ,toprd.XLATLONGNAME                        ACT_GVT_PAY_RATE_DETER_DESCR    
                      ,topbs.XLATLONGNAME                        ACT_GVT_PAY_BASIS_DESCR         
                      ,tortp.XLATLONGNAME                        ACT_GVT_RETIRE_PLAN_DESCR       
                      ,toann.XLATLONGNAME                        ACT_GVT_ANN_IND_DESCR           
                      ,toprc.XLATLONGNAME                        ACT_GVT_PREV_RET_COVRG_DESCR              
                      ,tofrs.XLATLONGNAME                        ACT_GVT_FERS_COVERAGE_DESCR              
                      ,toapt.XLATLONGNAME                        ACT_GVT_TYPE_OF_APPT_DESCR                   
                      ,topop.XLATLONGNAME                        ACT_GVT_POSN_OCCUPIED_DESCR                             
                      ,toleo.XLATLONGNAME                        ACT_GVT_LEO_POSITION_DESCR                                     	                  
                      ,frest.XLATLONGNAME                        FRM_EMPL_STATUS_DESCR           
                      ,frfst.XLATLONGNAME                        FRM_FLSA_STATUS_DESCR           
                      ,frwsh.XLATLONGNAME                        FRM_GVT_WORK_SCHED_DESCR        
                      ,frprd.XLATLONGNAME                        FRM_GVT_PAY_RATE_DETER_DESCR    
                      ,frpbs.XLATLONGNAME                        FRM_GVT_PAY_BASIS_DESCR         
                      ,frrtp.XLATLONGNAME                        FRM_GVT_RETIRE_PLAN_DESCR       
                      ,frann.XLATLONGNAME                        FRM_GVT_ANN_IND_DESCR           
                      ,frprc.XLATLONGNAME                        FRM_GVT_PREV_RET_COVRG_DESCR              
                      ,frfrs.XLATLONGNAME                        FRM_GVT_FERS_COVERAGE_DESCR              
                      ,frapt.XLATLONGNAME                        FRM_GVT_TYPE_OF_APPT_DESCR                   
                      ,frpop.XLATLONGNAME                        FRM_GVT_POSN_OCCUPIED_DESCR                             
                      ,frleo.XLATLONGNAME                        FRM_GVT_LEO_POSITION_DESCR      																			
                      ,tofcl.XLATLONGNAME                        ACT_GVT_FUNC_CLASS_DESCR                             
                      ,frfcl.XLATLONGNAME                        FRM_GVT_FUNC_CLASS_DESCR      																			
                      ,agyst.EFFECTIVE_END_DATE                  EFFECTIVE_SUBELEMENT_END_DATE  
                      ,orgst.EFFECTIVE_END_DATE                  EFFECTIVE_DEPT_END_DATE        
                      ,sf50.CHANGE_IN_DEPT                       CHANGE_IN_DEPT            
                      ,sf50.CHANGE_IN_SUBELEMENT_CODE            CHANGE_IN_SUBELEMENT_CODE 
                      ,sf50.CHANGE_EMPL_JOB_STATUS
                      ,sf50.CHANGE_IN_SUPV_LVL_ID                CHANGE_IN_SUPV_LVL_ID 
                      ,supst.EFFECTIVE_END_DATE                  EFFECTIVE_SUPV_LVL_ID_END_DATE        
                      ,TOT38.Z_TRANS_NBR       
                      ,TOT38.Z_TRANS_TYPE              
                      ,CASE WHEN TOT38.Z_TRANS_TYPE = 'SF52' THEN TOT38.Z_TRANS_NBR                             
                            WHEN TOT38.Z_TRANS_TYPE = 'NEW' THEN CONCAT(TOT38.Z_TRANS_NBR ,'C')                
                            WHEN TOT38.Z_TRANS_TYPE = 'PUF' THEN CONCAT(TOT38.Z_TRANS_NBR ,'U') ELSE NULL END  
                      ,FRT38.Z_TRANS_NBR       
                      ,FRT38.Z_TRANS_TYPE                                          
                      ,CASE WHEN FRT38.Z_TRANS_TYPE = 'SF52' THEN FRT38.Z_TRANS_NBR                             
                            WHEN FRT38.Z_TRANS_TYPE = 'NEW' THEN CONCAT(FRT38.Z_TRANS_NBR  ,'C')                
                            WHEN FRT38.Z_TRANS_TYPE = 'PUF' THEN CONCAT(FRT38.Z_TRANS_NBR  ,'U') ELSE NULL END   
                      from            NHRDW_SF50_TRANSACTION sf50
                      left outer join NHRDW_SF50_TRANSACTION npaest on SF50.empl_job_status = 'Prior Status' and npaest.emplid   = sf50.emplid and npaest.empl_rcd = sf50.empl_rcd  and npaest.empl_job_status != 'Prior Status'
                                                 AND npaest.EFFDT = 
                                                     (SELECT MAX(A_ED.EFFDT) FROM NHRDW_SF50_TRANSACTION A_ED 
                                                     WHERE   A_ED.EMPLID = sf50.EMPLID 
                                                       AND   A_ED.EMPL_RCD = sf50.EMPL_RCD 
                                                       AND   A_ED.transaction_status = 'COMPLETED'      
                                                       AND   A_ED.empl_job_status != 'Prior Status'
                                                       AND   A_ED.EFFDT <= sf50.EFFDT) 
                                                 AND npaest.EFFSEQ = 
                                                     (SELECT MAX(A_ES.EFFSEQ) FROM NHRDW_SF50_TRANSACTION A_ES 
                                                     WHERE  A_ES.EMPLID = sf50.EMPLID 
                                                       AND  A_ES.EMPL_RCD = sf50.EMPL_RCD 
                                                       AND   A_ES.empl_job_status != 'Prior Status'  
                                                       AND   A_ES.transaction_status = 'COMPLETED'
                                                       AND   A_ES.EFFDT = npaest.EFFDT)   
                      left outer join PS_GVT_JOB          tojob  on tojob.emplid   = sf50.emplid and tojob.empl_rcd = sf50.empl_rcd  and tojob.effdt = sf50.effdt and tojob.effseq = sf50.effseq
                      left outer join nhrdw_sf50_derive_empl_status          agyst  on agyst.emplid   = sf50.emplid and agyst.empl_rcd = sf50.empl_rcd  and agyst.effdt = sf50.effdt and agyst.effseq = sf50.effseq and agyst.type_of_record = 'SUBELEMENT'
                      left outer join nhrdw_sf50_derive_empl_status          orgst  on orgst.emplid   = sf50.emplid and orgst.empl_rcd = sf50.empl_rcd  and orgst.effdt = sf50.effdt and orgst.effseq = sf50.effseq and orgst.type_of_record = 'DEPTID'
                      left outer join nhrdw_sf50_derive_empl_status          supst  on supst.emplid   = sf50.emplid and supst.empl_rcd = sf50.empl_rcd  and supst.effdt = sf50.effdt and supst.effseq = sf50.effseq and supst.type_of_record = 'SUPV_LVL_ID'
                      left outer join PS_GVT_JOB          frjob  on frjob.emplid = sf50.emplid and frjob.empl_rcd = sf50.empl_rcd  and frjob.effdt = sf50.act_pr_effdt and frjob.effseq = sf50.act_pr_effseq 
                      left outer join PS_GVT_NOAC_TBL     gvnoa  on gvnoa.GVT_NOA_CODE   = tojob.GVT_NOA_CODE AND gvnoa.action = tojob.action
                                                                                                                          and gvnoa.EFFDT =  (SELECT MAX(gvnoa_ed.EFFDT) FROM PS_GVT_NOAC_TBL gvnoa_ed
                                                                                                                        WHERE gvnoa_ed.GVT_NOA_CODE  = tojob.GVT_NOA_CODE
                                                                                                                          and gvnoa_ed.action  = tojob.action
                                                                                                                          AND gvnoa_ed.EFFDT <= TOJOB.EFFDT )  
                      LEFT OUTER JOIN  PS_ACTION_TBL TOATB ON  TOATB.ACTION  = TOJOB.ACTION 
                                                                       and TOATB.EFFDT = (SELECT MAX(TOATB_ED.EFFDT) FROM PS_ACTION_TBL TOATB_ED
                                                                                                  WHERE  TOATB_ED.ACTION = TOJOB.ACTION     
                                                                                                  AND    TOATB_ED.EFFDT <= TOJOB.EFFDT ) 
                      LEFT OUTER JOIN  ps_actn_reason_tbl toact_r ON toact_r.ACTION = TOJOB.ACTION
                                                                       AND toact_r.ACTION_REASON = TOJOB.ACTION_REASON
                                                                       AND toact_r.EFFDT = (SELECT MAX(toact_r_ed.EFFDT) FROM ps_actn_reason_tbl toact_r_ed
                                                                       WHERE   toact_r_ed.ACTION = TOJOB.ACTION
                                                                               AND toact_r_ed.ACTION_REASON = TOJOB.ACTION_REASON
                                                                               AND toact_r_ed.EFFDT <= TOJOB.EFFDT)        
                      LEFT OUTER JOIN  ps_gvt_fegli tofeg  ON  tofeg.GVT_FEGLI = TOJOB.GVT_FEGLI     
                                                                       and tofeg.EFFDT = (SELECT MAX(tofeg_ed.EFFDT) FROM ps_gvt_fegli tofeg_ed
                                                                                                  WHERE  tofeg_ed.GVT_FEGLI  = TOJOB.GVT_FEGLI     
                                                                                                  AND    tofeg_ed.EFFDT <= TOJOB.EFFDT ) 
                      LEFT OUTER JOIN  ps_gvt_fegli frfeg  ON  frfeg.GVT_FEGLI = FRJOB.GVT_FEGLI     
                                                                       and frfeg.EFFDT = (SELECT MAX(frfeg_ed.EFFDT) FROM ps_gvt_fegli frfeg_ed
                                                                                                  WHERE  frfeg_ed.GVT_FEGLI  = FRJOB.GVT_FEGLI     
                                                                                                  AND    frfeg_ed.EFFDT <= FRJOB.EFFDT )    
                      LEFT OUTER JOIN PS_HR_BARG_UNIT tobrg ON               tobrg.BARG_UNIT  = tojob.BARG_UNIT 
                                                                                         and tobrg.EFFDT = (SELECT MAX(tobrg_ed.EFFDT) FROM new_hrdw.ps_hr_barg_unit tobrg_ed
                                                                                                             WHERE tobrg_ed.BARG_UNIT = tojob.BARG_UNIT   
                                                                                                               AND tobrg_ed.EFFDT <= tojob.effdt ) 
                      
                      LEFT OUTER JOIN PS_HR_BARG_UNIT frbrg ON               frbrg.BARG_UNIT  = frjob.BARG_UNIT 
                                                                                         and frbrg.EFFDT = (SELECT MAX(frbrg_ed.EFFDT) FROM ps_hr_barg_unit frbrg_ed
                                                                                                             WHERE frbrg_ed.BARG_UNIT = frjob.BARG_UNIT    
                                                                                                               AND frbrg_ed.EFFDT <= frjob.effdt )                                                                                                                                                                              
                      LEFT OUTER JOIN PS_GVT_POI_TBL topoi on topoi.GVT_POI= tojob.GVT_POI                 
                                                          AND topoi.EFFDT=                                 
                                                                (SELECT MAX(topoi_ed.EFFDT)                
                                                                 FROM   PS_GVT_POI_TBL topoi_ed            
                                                                 WHERE  topoi_ed.GVT_POI  =tojob.GVT_POI 
                                                                 AND    topoi_ed.EFFDT <= tojob.EFFDT)     
                      LEFT OUTER JOIN PS_GVT_POI_TBL frpoi on frpoi.GVT_POI= frjob.GVT_POI                 
                                                          AND frpoi.EFFDT=                                 
                                                                (SELECT MAX(frpoi_ed.EFFDT)                
                                                                 FROM   PS_GVT_POI_TBL frpoi_ed            
                                                                 WHERE  frpoi_ed.GVT_POI  =frjob.GVT_POI   
                                                                 AND    frpoi_ed.EFFDT <= frjob.EFFDT)     
                      LEFT OUTER JOIN PS_GVT_POI_SIG_TBL topsg on topsg.GVT_POI= tojob.GVT_POI             
                                                          AND topsg.EFFDT=                                 
                                                                (SELECT MAX(topsg_ed.EFFDT)                
                                                                 FROM   PS_GVT_POI_TBL topsg_ed            
                                                                 WHERE  topsg_ed.GVT_POI  = tojob.GVT_POI 
                                                                 AND    topsg_ed.EFFDT <= tojob.EFFDT)     		
                     LEFT OUTER JOIN  nhrdw_custom_xlatitem toosr on  toosr.FIELDNAME  = 'X_AGENCY_SUBELMENT_CODE'  and toosr.FIELDVALUE = CONCAT(TOJOB.company,TOJOB.GVT_SUB_AGENCY) and  toosr.X_FIELDNAME    = 'X_GSA_SSO'
                                                             AND toosr.EFFDT =(SELECT MAX(toosr_ED.EFFDT) FROM nhrdw_custom_xlatitem toosr_ED
                                                                               WHERE toosr_ED.FIELDVALUE = CONCAT(TOJOB.company,TOJOB.GVT_SUB_AGENCY)
		                                                                         AND toosr_ED.FIELDNAME  = 'X_AGENCY_SUBELMENT_CODE'
		                                                                         and toosr_ED.X_FIELDNAME    = 'X_GSA_SSO'
                                                                                 AND toosr_ED.EFFDT       <= sf50.EFFDT)
                     LEFT OUTER JOIN  nhrdw_custom_xlatitem frosr on  frosr.FIELDNAME  = 'X_AGENCY_SUBELMENT_CODE' and frosr.FIELDVALUE = CONCAT(FRJOB.company,FRJOB.GVT_SUB_AGENCY) and  frosr.X_FIELDNAME    = 'X_GSA_SSO'
                                                             AND frosr.EFFDT =(SELECT MAX(frosr_ED.EFFDT) FROM nhrdw_custom_xlatitem frosr_ED
                                                                               WHERE frosr_ED.FIELDVALUE   = CONCAT(FRJOB.company,FRJOB.GVT_SUB_AGENCY)
		                                                                         AND frosr_ED.FIELDNAME  = 'X_AGENCY_SUBELMENT_CODE' 
		                                                                         and frosr_ED.X_FIELDNAME    = 'X_GSA_SSO'
                                                                                 AND frosr_ED.EFFDT       <= sf50.act_pr_EFFDT)			 	
										LEFT OUTER JOIN  psxlatitem toest on  toest.FIELDNAME  = 'EMPL_STATUS' and toest.FIELDVALUE = tojob.EMPL_STATUS
                                                             AND toest.EFFDT =(SELECT MAX(xlat_ED.EFFDT) FROM psxlatitem xlat_ED
                                                                               WHERE xlat_ED.FIELDVALUE = tojob.EMPL_STATUS
		                                                                         AND xlat_ED.FIELDNAME  = 'EMPL_STATUS' 
                                                                                 AND xlat_ED.EFFDT       <= sf50.EFFDT)		
                     LEFT OUTER JOIN  psxlatitem frest on  frest.FIELDNAME  = 'EMPL_STATUS' and frest.FIELDVALUE = frjob.EMPL_STATUS
                                                             AND frest.EFFDT =(SELECT MAX(xlat_ED.EFFDT) FROM psxlatitem xlat_ED
                                                                               WHERE xlat_ED.FIELDVALUE = frjob.EMPL_STATUS
		                                                                            AND xlat_ED.FIELDNAME  = 'EMPL_STATUS' 
                                                                                 AND xlat_ED.EFFDT       <= sf50.act_pr_EFFDT)		 																			 
                     LEFT OUTER JOIN  psxlatitem tofst on  tofst.FIELDNAME  = 'FLSA_STATUS' and tofst.FIELDVALUE = tojob.FLSA_STATUS
                                                             AND tofst.EFFDT =(SELECT MAX(xlat_ED.EFFDT) FROM psxlatitem xlat_ED
                                                                               WHERE xlat_ED.FIELDVALUE = tojob.FLSA_STATUS
		                                                                         AND xlat_ED.FIELDNAME  = 'FLSA_STATUS' 
                                                                                 AND xlat_ED.EFFDT       <= sf50.EFFDT)			
                     LEFT OUTER JOIN  psxlatitem frfst on  frfst.FIELDNAME  = 'FLSA_STATUS' and frfst.FIELDVALUE = frjob.FLSA_STATUS
                                                             AND frfst.EFFDT =(SELECT MAX(xlat_ED.EFFDT) FROM psxlatitem xlat_ED
                                                                               WHERE xlat_ED.FIELDVALUE = frjob.FLSA_STATUS
		                                                                            AND xlat_ED.FIELDNAME  = 'FLSA_STATUS' 
                                                                                 AND xlat_ED.EFFDT       <= sf50.act_pr_EFFDT)																					 
                     LEFT OUTER JOIN  psxlatitem towsh on  towsh.FIELDNAME  = 'GVT_WORK_SCHED' and towsh.FIELDVALUE = tojob.GVT_WORK_SCHED
                                                             AND towsh.EFFDT =(SELECT MAX(xlat_ED.EFFDT) FROM psxlatitem xlat_ED
                                                                               WHERE xlat_ED.FIELDVALUE = tojob.GVT_WORK_SCHED
		                                                                         AND xlat_ED.FIELDNAME  = 'GVT_WORK_SCHED' 
                                                                                 AND xlat_ED.EFFDT       <= sf50.EFFDT)			
                     LEFT OUTER JOIN  psxlatitem frwsh on  frwsh.FIELDNAME  = 'GVT_WORK_SCHED' and frwsh.FIELDVALUE = frjob.GVT_WORK_SCHED
                                                             AND frwsh.EFFDT =(SELECT MAX(xlat_ED.EFFDT) FROM psxlatitem xlat_ED
                                                                               WHERE xlat_ED.FIELDVALUE = frjob.GVT_WORK_SCHED
		                                                                            AND xlat_ED.FIELDNAME  = 'GVT_WORK_SCHED' 
                                                                                 AND xlat_ED.EFFDT       <= sf50.act_pr_EFFDT)																					 
                     LEFT OUTER JOIN  psxlatitem toprd on  toprd.FIELDNAME  = 'GVT_PAY_RATE_DETER' and toprd.FIELDVALUE = tojob.GVT_PAY_RATE_DETER
                                                             AND toprd.EFFDT =(SELECT MAX(xlat_ED.EFFDT) FROM psxlatitem xlat_ED
                                                                               WHERE xlat_ED.FIELDVALUE = tojob.GVT_PAY_RATE_DETER
		                                                                         AND xlat_ED.FIELDNAME  = 'GVT_PAY_RATE_DETER' 
                                                                                 AND xlat_ED.EFFDT       <= sf50.EFFDT)			
                     LEFT OUTER JOIN  psxlatitem frprd on  frprd.FIELDNAME  = 'GVT_PAY_RATE_DETER' and frprd.FIELDVALUE = frjob.GVT_PAY_RATE_DETER
                                                             AND frprd.EFFDT =(SELECT MAX(xlat_ED.EFFDT) FROM psxlatitem xlat_ED
                                                                               WHERE xlat_ED.FIELDVALUE = frjob.GVT_PAY_RATE_DETER
		                                                                            AND xlat_ED.FIELDNAME  = 'GVT_PAY_RATE_DETER' 
                                                                                 AND xlat_ED.EFFDT       <= sf50.act_pr_EFFDT)																					 
                     LEFT OUTER JOIN  psxlatitem topbs on  topbs.FIELDNAME  = 'GVT_PAY_BASIS' and topbs.FIELDVALUE = tojob.GVT_PAY_BASIS
                                                             AND topbs.EFFDT =(SELECT MAX(xlat_ED.EFFDT) FROM psxlatitem xlat_ED
                                                                               WHERE xlat_ED.FIELDVALUE = tojob.GVT_PAY_BASIS
		                                                                         AND xlat_ED.FIELDNAME  = 'GVT_PAY_BASIS' 
                                                                                 AND xlat_ED.EFFDT       <= sf50.EFFDT)			
                     LEFT OUTER JOIN  psxlatitem frpbs on  frpbs.FIELDNAME  = 'GVT_PAY_BASIS' and frpbs.FIELDVALUE = frjob.GVT_PAY_BASIS
                                                             AND frpbs.EFFDT =(SELECT MAX(xlat_ED.EFFDT) FROM psxlatitem xlat_ED
                                                                               WHERE xlat_ED.FIELDVALUE = frjob.GVT_PAY_BASIS
		                                                                            AND xlat_ED.FIELDNAME  = 'GVT_PAY_BASIS' 
                                                                                 AND xlat_ED.EFFDT       <= sf50.act_pr_EFFDT)																					 
                     LEFT OUTER JOIN  psxlatitem tortp on  tortp.FIELDNAME  = 'GVT_RETIRE_PLAN' and tortp.FIELDVALUE = tojob.GVT_RETIRE_PLAN
                                                             AND tortp.EFFDT =(SELECT MAX(xlat_ED.EFFDT) FROM psxlatitem xlat_ED
                                                                               WHERE xlat_ED.FIELDVALUE = tojob.GVT_RETIRE_PLAN
		                                                                         AND xlat_ED.FIELDNAME  = 'GVT_RETIRE_PLAN' 
                                                                                 AND xlat_ED.EFFDT       <= sf50.EFFDT)			
                     LEFT OUTER JOIN  psxlatitem frrtp on  frrtp.FIELDNAME  = 'GVT_RETIRE_PLAN' and frrtp.FIELDVALUE = frjob.GVT_RETIRE_PLAN
                                                             AND frrtp.EFFDT =(SELECT MAX(xlat_ED.EFFDT) FROM psxlatitem xlat_ED
                                                                               WHERE xlat_ED.FIELDVALUE = frjob.GVT_RETIRE_PLAN
		                                                                            AND xlat_ED.FIELDNAME  = 'GVT_RETIRE_PLAN' 
                                                                                 AND xlat_ED.EFFDT       <= sf50.act_pr_EFFDT)																					 
                     LEFT OUTER JOIN  psxlatitem toann on  toann.FIELDNAME  = 'GVT_ANN_IND' and toann.FIELDVALUE = tojob.GVT_ANN_IND
                                                             AND toann.EFFDT =(SELECT MAX(xlat_ED.EFFDT) FROM psxlatitem xlat_ED
                                                                               WHERE xlat_ED.FIELDVALUE = tojob.GVT_ANN_IND
		                                                                         AND xlat_ED.FIELDNAME  = 'GVT_ANN_IND' 
                                                                                 AND xlat_ED.EFFDT       <= sf50.EFFDT)			
                     LEFT OUTER JOIN  psxlatitem frann on  frann.FIELDNAME  = 'GVT_ANN_IND' and frann.FIELDVALUE = frjob.GVT_ANN_IND
                                                             AND frann.EFFDT =(SELECT MAX(xlat_ED.EFFDT) FROM psxlatitem xlat_ED
                                                                               WHERE xlat_ED.FIELDVALUE = frjob.GVT_ANN_IND
		                                                                            AND xlat_ED.FIELDNAME  = 'GVT_ANN_IND' 
                                                                                 AND xlat_ED.EFFDT       <= sf50.act_pr_EFFDT)																					 
                     LEFT OUTER JOIN  psxlatitem toprc on  toprc.FIELDNAME  = 'GVT_PREV_RET_COVRG' and toprc.FIELDVALUE = tojob.GVT_PREV_RET_COVRG
                                                             AND toprc.EFFDT =(SELECT MAX(xlat_ED.EFFDT) FROM psxlatitem xlat_ED
                                                                               WHERE xlat_ED.FIELDVALUE = tojob.GVT_PREV_RET_COVRG
		                                                                         AND xlat_ED.FIELDNAME  = 'GVT_PREV_RET_COVRG' 
                                                                                 AND xlat_ED.EFFDT       <= sf50.EFFDT)			
                     LEFT OUTER JOIN  psxlatitem frprc on  frprc.FIELDNAME  = 'GVT_PREV_RET_COVRG' and frprc.FIELDVALUE = frjob.GVT_PREV_RET_COVRG
                                                             AND frprc.EFFDT =(SELECT MAX(xlat_ED.EFFDT) FROM psxlatitem xlat_ED
                                                                               WHERE xlat_ED.FIELDVALUE = frjob.GVT_PREV_RET_COVRG
		                                                                            AND xlat_ED.FIELDNAME  = 'GVT_PREV_RET_COVRG' 
                                                                                 AND xlat_ED.EFFDT       <= sf50.act_pr_EFFDT)																					 
                     LEFT OUTER JOIN  psxlatitem tofrs on  tofrs.FIELDNAME  = 'GVT_FERS_COVERAGE' and tofrs.FIELDVALUE = tojob.GVT_FERS_COVERAGE
                                                             AND tofrs.EFFDT =(SELECT MAX(xlat_ED.EFFDT) FROM psxlatitem xlat_ED
                                                                               WHERE xlat_ED.FIELDVALUE = tojob.GVT_FERS_COVERAGE
		                                                                         AND xlat_ED.FIELDNAME  = 'GVT_FERS_COVERAGE' 
                                                                                 AND xlat_ED.EFFDT       <= sf50.EFFDT)			
                     LEFT OUTER JOIN  psxlatitem frfrs on  frfrs.FIELDNAME  = 'GVT_FERS_COVERAGE' and frfrs.FIELDVALUE = frjob.GVT_FERS_COVERAGE
                                                             AND frfrs.EFFDT =(SELECT MAX(xlat_ED.EFFDT) FROM psxlatitem xlat_ED
                                                                               WHERE xlat_ED.FIELDVALUE = frjob.GVT_FERS_COVERAGE
		                                                                            AND xlat_ED.FIELDNAME  = 'GVT_FERS_COVERAGE' 
                                                                                 AND xlat_ED.EFFDT       <= sf50.act_pr_EFFDT)																					 
                     LEFT OUTER JOIN  psxlatitem toapt on  toapt.FIELDNAME  = 'GVT_TYPE_OF_APPT' and toapt.FIELDVALUE = tojob.GVT_TYPE_OF_APPT
                                                             AND toapt.EFFDT =(SELECT MAX(xlat_ED.EFFDT) FROM psxlatitem xlat_ED
                                                                               WHERE xlat_ED.FIELDVALUE = tojob.GVT_TYPE_OF_APPT
		                                                                         AND xlat_ED.FIELDNAME  = 'GVT_TYPE_OF_APPT' 
                                                                                 AND xlat_ED.EFFDT       <= sf50.EFFDT)			
                     LEFT OUTER JOIN  psxlatitem frapt on  frapt.FIELDNAME  = 'GVT_TYPE_OF_APPT' and frapt.FIELDVALUE = frjob.GVT_TYPE_OF_APPT
                                                             AND frapt.EFFDT =(SELECT MAX(xlat_ED.EFFDT) FROM psxlatitem xlat_ED
                                                                               WHERE xlat_ED.FIELDVALUE = frjob.GVT_TYPE_OF_APPT
		                                                                            AND xlat_ED.FIELDNAME  = 'GVT_TYPE_OF_APPT' 
                                                                                 AND xlat_ED.EFFDT       <= sf50.act_pr_EFFDT)																					 
                     LEFT OUTER JOIN  psxlatitem topop on  topop.FIELDNAME  = 'GVT_POSN_OCCUPIED' and topop.FIELDVALUE = tojob.GVT_POSN_OCCUPIED
                                                             AND topop.EFFDT =(SELECT MAX(xlat_ED.EFFDT) FROM psxlatitem xlat_ED
                                                                               WHERE xlat_ED.FIELDVALUE = tojob.GVT_POSN_OCCUPIED
		                                                                         AND xlat_ED.FIELDNAME  = 'GVT_POSN_OCCUPIED' 
                                                                                 AND xlat_ED.EFFDT       <= sf50.EFFDT)			
                     LEFT OUTER JOIN  psxlatitem frpop on  frpop.FIELDNAME  = 'GVT_POSN_OCCUPIED' and frpop.FIELDVALUE = frjob.GVT_POSN_OCCUPIED
                                                             AND frpop.EFFDT =(SELECT MAX(xlat_ED.EFFDT) FROM psxlatitem xlat_ED
                                                                               WHERE xlat_ED.FIELDVALUE = frjob.GVT_POSN_OCCUPIED
		                                                                            AND xlat_ED.FIELDNAME  = 'GVT_POSN_OCCUPIED' 
                                                                                 AND xlat_ED.EFFDT       <= sf50.act_pr_EFFDT)																					 
                     LEFT OUTER JOIN  psxlatitem toleo on  toleo.FIELDNAME  = 'GVT_LEO_POSITION' and toleo.FIELDVALUE = tojob.GVT_LEO_POSITION
                                                             AND toleo.EFFDT =(SELECT MAX(xlat_ED.EFFDT) FROM psxlatitem xlat_ED
                                                                               WHERE xlat_ED.FIELDVALUE = tojob.GVT_LEO_POSITION
		                                                                         AND xlat_ED.FIELDNAME  = 'GVT_LEO_POSITION' 
                                                                                 AND xlat_ED.EFFDT       <= sf50.EFFDT)			
                     LEFT OUTER JOIN  psxlatitem frleo on  frleo.FIELDNAME  = 'GVT_LEO_POSITION' and frleo.FIELDVALUE = frjob.GVT_LEO_POSITION
                                                             AND frleo.EFFDT =(SELECT MAX(xlat_ED.EFFDT) FROM psxlatitem xlat_ED
                                                                               WHERE xlat_ED.FIELDVALUE = frjob.GVT_LEO_POSITION
		                                                                            AND xlat_ED.FIELDNAME  = 'GVT_LEO_POSITION' 
                                                                                 AND xlat_ED.EFFDT       <= sf50.act_pr_EFFDT)
                     LEFT OUTER JOIN  psxlatitem tofcl on  tofcl.FIELDNAME  = 'GVT_FUNC_CLASS' and tofcl.FIELDVALUE = tojob.GVT_FUNC_CLASS
                                                             AND tofcl.EFFDT =(SELECT MAX(xlat_ED.EFFDT) FROM psxlatitem xlat_ED
                                                                               WHERE xlat_ED.FIELDVALUE = tojob.GVT_FUNC_CLASS
		                                                                         AND xlat_ED.FIELDNAME  = 'GVT_FUNC_CLASS' 
                                                                                 AND xlat_ED.EFFDT       <= sf50.EFFDT)			
                     LEFT OUTER JOIN  psxlatitem frfcl on  frfcl.FIELDNAME  = 'GVT_FUNC_CLASS' and frfcl.FIELDVALUE = frjob.GVT_FUNC_CLASS
                                                             AND frfcl.EFFDT =(SELECT MAX(xlat_ED.EFFDT) FROM psxlatitem xlat_ED
                                                                               WHERE xlat_ED.FIELDVALUE = frjob.GVT_FUNC_CLASS
		                                                                            AND xlat_ED.FIELDNAME  = 'GVT_FUNC_CLASS' 
                                                                                 AND xlat_ED.EFFDT       <= sf50.act_pr_EFFDT) 
                     left outer join PS_Z_T38_JOB          TOT38  on TOT38.emplid   = sf50.emplid and TOT38.empl_rcd = sf50.empl_rcd  and TOT38.effdt = sf50.effdt        and TOT38.effseq = sf50.effseq           -- AND TOT38.Z_TRANS_NBR != 0
                     left outer join PS_Z_T38_JOB          FRT38  on FRT38.emplid   = sf50.emplid and FRT38.empl_rcd = sf50.empl_rcd  and FRT38.effdt = sf50.act_pr_effdt and FRT38.effseq = sf50.act_pr_effseq    -- AND FRT38.Z_TRANS_NBR != 0
                     WHERE SF50.TRANSACTION_STATUS = 'COMPLETED';																					 



                                                                                 
                      commit;                     
					  
                      call nhrdw_process_log_trk (-7001, 'I', 'Refresh SF50 Transaction : Insert SF50 Personnel Action Position Info' );
 
                      commit;                     
                      
                      insert into nhrdw_personnel_action_position_info 
                      (
                       SF50_TRANSACTION_CONTROL_ID
                      ,EMPLID
                      ,EMPL_RCD
                      ,EFFDT
                      ,EFFSEQ
                      ,ACT_POS_GVT_PAY_PLAN       
                      ,ACT_POS_GRADE              
                      ,ACT_POS_GVT_TARGET_GRADE   
                      ,FRM_POS_GVT_PAY_PLAN       
                      ,FRM_POS_GRADE              
                      ,FRM_POS_GVT_TARGET_GRADE                         
                      ,ACT_GVT_OCC_SERIES
                      ,ACT_GVT_OCC_SERIES_DESCR40
                      ,ACT_GVT_OCC_SERIES_DESCR70
                      ,ACT_GVT_OCC_SERIES_PATCOB_CD
                      ,ACT_GVT_OCC_SERIES_FUNC_CLASS_REQ
                      ,FRM_GVT_OCC_SERIES
                      ,FRM_GVT_OCC_SERIES_DESCR40
                      ,FRM_GVT_OCC_SERIES_DESCR70
                      ,FRM_GVT_OCC_SERIES_PATCOB_CD
                      ,FRM_GVT_OCC_SERIES_FUNC_CLASS_REQ
                      ,ACT_SUPV_LVL_ID
                      ,ACT_SUPV_LVL_ID_DESCR
                      ,FRM_SUPV_LVL_ID
                      ,FRM_SUPV_LVL_ID_DESCR
                      ,ACT_Z_PD_FUNC
                      ,FRM_Z_PD_FUNC
                      ,ACT_GSA_EXECUTIVE_RESOURCES_FLAG
                      ,FRM_GSA_EXECUTIVE_RESOURCES_FLAG
                      ,ACT_Z_ACCT_CD
                      ,FRM_Z_ACCT_CD
                      ,ACT_POS_DESCRLONG
                      ,FRM_POS_DESCRLONG
                      ,ACT_POS_DESCRSHORT
                      ,FRM_POS_DESCRSHORT
                      ,ACT_POS_DESCR
                      ,FRM_POS_DESCR
                      ,ACT_GVT_POSN_SENS_CD
                      ,FRM_GVT_POSN_SENS_CD
                      ,ACT_MCO_GROUP
                      ,ACT_MCO_ABBREVIATION
                      ,ACT_OCCUPATIONAL_SERIES_GROUP
                      ,ACT_BPR_GROUP
                      ,ACT_MCO_OCO_MSO_TYPE
                      ,ACT_MISSION_FUNCTIONAL_GROUP
                      ,FRM_MCO_GROUP
                      ,FRM_MCO_ABBREVIATION
                      ,FRM_OCCUPATIONAL_SERIES_GROUP
                      ,FRM_BPR_GROUP
                      ,FRM_MCO_OCO_MSO_TYPE
                      ,FRM_MISSION_FUNCTIONAL_GROUP
					            ,ACT_GVT_OCC_SERIES_PATCOB_CD_DESCR
					            ,FRM_GVT_OCC_SERIES_PATCOB_CD_DESCR  					  
                      ,ACT_GVT_POSN_SENS_CD_DESCR
                      ,FRM_GVT_POSN_SENS_CD_DESCR  
                      ,ACT_POS_ACTION                  
                      ,ACT_POS_ACTION_REASON           
                      ,FRM_POS_ACTION                  
                      ,FRM_POS_ACTION_REASON           
                      ,ACT_POS_TRANSACTION_NBR         
                      ,ACT_POS_TRANSACTION_TYPE        
                      ,FRM_POS_TRANSACTION_NBR         
                      ,FRM_POS_TRANSACTION_TYPE        
                      ,ACT_POS_CADW_TRANSACTION_NBR    
                      ,FRM_POS_CADW_TRANSACTION_NBR      
                      ,ACT_POS_GVT_ORG_TTL_DESCR
                      ,FRM_POS_GVT_ORG_TTL_DESCR       
                      ,ACT_POS_INVESTIGATION_TYPE          
                      ,ACT_POS_INVESTIGATION_TYPE_DESCR    
                      ,ACT_POS_STAFFING_INVESTIGATION_TYPE 
                      ,FRM_POS_INVESTIGATION_TYPE          
                      ,FRM_POS_INVESTIGATION_TYPE_DESCR    
                      ,FRM_POS_STAFFING_INVESTIGATION_TYPE                  
                      )
                       select
                       sf50.SF50_TRANSACTION_CONTROL_ID          SF50_TRANSACTION_CONTROL_ID
                      ,sf50.EMPLID                               EMPLID   
                      ,sf50.EMPL_RCD                             EMPL_RCD 
                      ,sf50.EFFDT                                EFFDT    
                      ,sf50.EFFSEQ                               EFFSEQ   
                      ,TOPOS.GVT_PAY_PLAN                        ACT_POS_GVT_PAY_PLAN       
                      ,TOPOS.GRADE                               ACT_POS_GRADE              
                      ,TOPOS.GVT_TARGET_GRADE                    ACT_POS_GVT_TARGET_GRADE   
                      ,FRPOS.GVT_PAY_PLAN                        FRM_POS_GVT_PAY_PLAN       
                      ,FRPOS.GRADE                               FRM_POS_GRADE              
                      ,FRPOS.GVT_TARGET_GRADE                    FRM_POS_GVT_TARGET_GRADE   
                      ,TOPOS.GVT_OCC_SERIES                      ACT_GVT_OCC_SERIES     
                      ,TOOCC.GVT_DESCR40	                       ACT_GVT_OCC_SERIES_DESCR40	        
                      ,TOOCC.GVT_DESCR70	                       ACT_GVT_OCC_SERIES_DESCR70	        
                      ,TOOCC.GVT_PATCOB_CD	                     ACT_GVT_OCC_SERIES_PATCOB_CD	      
                      ,TOOCC.GVT_FUNC_CLASS_REQ                  ACT_GVT_OCC_SERIES_FUNC_CLASS_REQ	
                      ,FRPOS.GVT_OCC_SERIES                      FRM_GVT_OCC_SERIES
                      ,FROCC.GVT_DESCR40	                       FRM_GVT_OCC_SERIES_DESCR40	        
                      ,FROCC.GVT_DESCR70	                       FRM_GVT_OCC_SERIES_DESCR70	        
                      ,FROCC.GVT_PATCOB_CD	                     FRM_GVT_OCC_SERIES_PATCOB_CD	      
                      ,FROCC.GVT_FUNC_CLASS_REQ                  FRM_GVT_OCC_SERIES_FUNC_CLASS_REQ	
                      ,TOPOS.SUPV_LVL_ID                         ACT_SUPV_LVL_ID
                      ,TOSUP.DESCR                               ACT_SUPV_LVL_ID_DESCR
                      ,FRPOS.SUPV_LVL_ID                         FRM_SUPV_LVL_ID
                      ,FRSUP.DESCR                               FRM_SUPV_LVL_ID_DESCR
                      ,TOZPS.Z_PD_FUNC                           ACT_Z_PD_FUNC
                      ,FRZPS.Z_PD_FUNC                           FRM_Z_PD_FUNC
                      ,CASE WHEN TOPOS.BUSINESS_UNIT in ('GSA01','GSA02') and substr(TOZPS.Z_PD_FUNC,1,1) = 'X' THEN 'Y' ELSE 'N' END  ACT_GSA_EXECUTIVE_RESOURCES_FLAG
                      ,CASE WHEN FRPOS.BUSINESS_UNIT in ('GSA01','GSA02') and substr(FRZPS.Z_PD_FUNC,1,1) = 'X' THEN 'Y' ELSE 'N' END  FRM_GSA_EXECUTIVE_RESOURCES_FLAG					  
                      ,TOZPS.Z_ACCT_CD                           ACT_Z_ACCT_CD
                      ,FRZPS.Z_ACCT_CD                           FRM_Z_ACCT_CD
                      ,TOPOS.DESCRLONG                           ACT_POS_DESCRLONG  
                      ,FRPOS.DESCRLONG                           FRM_POS_DESCRLONG
                      ,TOPOS.DESCRSHORT                          ACT_POS_DESCRSHORT     
                      ,FRPOS.DESCRSHORT                          FRM_POS_DESCRSHORT 
                      ,TOPOS.DESCR                               ACT_POS_DESCR  
                      ,FRPOS.DESCR                               FRM_POS_DESCR   
                      ,TOPOS.GVT_POSN_SENS_CD                    ACT_GVT_POSN_SENS_CD    
                      ,FRPOS.GVT_POSN_SENS_CD                    FRM_GVT_POSN_SENS_CD    
                      ,TOOCA.MCO_GROUP                           ACT_MCO_GROUP                  
                      ,TOOCA.MCO_ABBREVIATION                    ACT_MCO_ABBREVIATION           
                      ,TOOCA.OCCUPATIONAL_SERIES_GROUP           ACT_OCCUPATIONAL_SERIES_GROUP  
                      ,TOOCA.BPR_GROUP                           ACT_BPR_GROUP                  
                      ,TOOCA.MCO_OCO_MSO_TYPE                    ACT_MCO_OCO_MSO_TYPE           
                      ,TOOCA.MISSION_FUNCTIONAL_GROUP            ACT_MISSION_FUNCTIONAL_GROUP   
                      ,FROCA.MCO_GROUP                           FRM_MCO_GROUP                                               	              
                      ,FROCA.MCO_ABBREVIATION                    FRM_MCO_ABBREVIATION                                        	              
                      ,FROCA.OCCUPATIONAL_SERIES_GROUP           FRM_OCCUPATIONAL_SERIES_GROUP                               	              
                      ,FROCA.BPR_GROUP                           FRM_BPR_GROUP                                               	              
                      ,FROCA.MCO_OCO_MSO_TYPE                    FRM_MCO_OCO_MSO_TYPE                                        	              
                      ,FROCA.MISSION_FUNCTIONAL_GROUP            FRM_MISSION_FUNCTIONAL_GROUP  
                      ,TOPAT.XLATLONGNAME                        ACT_GVT_OCC_SERIES_PATCOB_CD_DESCR
                      ,FRPAT.XLATLONGNAME                        FRM_GVT_OCC_SERIES_PATCOB_CD_DESCR     																			
                      ,TOSEN.XLATLONGNAME                        ACT_GVT_POSN_SENS_CD_DESCR
                      ,FRSEN.XLATLONGNAME                        FRM_GVT_POSN_SENS_CD_DESCR     																			
                      ,TOPOS.ACTION                  
                      ,TOPOS.ACTION_REASON           
                      ,FRPOS.ACTION                  
                      ,FRPOS.ACTION_REASON           
                      ,TOZPS.Z_TEXT254_3         
                      ,TOZPS.Z_TEXT254_4          
                      ,FRZPS.Z_TEXT254_3          
                      ,FRZPS.Z_TEXT254_4                              
                      ,CASE WHEN TOZPS.Z_TEXT254_4 = 'SF52' THEN TOZPS.Z_TEXT254_3                            
                            WHEN TOZPS.Z_TEXT254_4 = 'NEW' THEN CONCAT(TOZPS.Z_TEXT254_3 ,'C')                
                            WHEN TOZPS.Z_TEXT254_4 = 'PUF' THEN CONCAT(TOZPS.Z_TEXT254_3 ,'U') ELSE NULL END  
                      ,CASE WHEN FRZPS.Z_TEXT254_4 = 'SF52' THEN TOZPS.Z_TEXT254_3                            
                            WHEN FRZPS.Z_TEXT254_4 = 'NEW' THEN CONCAT(FRZPS.Z_TEXT254_3 ,'C')                
                            WHEN FRZPS.Z_TEXT254_4 = 'PUF' THEN CONCAT(FRZPS.Z_TEXT254_3 ,'U') ELSE NULL END  
                      ,TOPOS.GVT_ORG_TTL_DESCR
                      ,FRPOS.GVT_ORG_TTL_DESCR
                      ,tosenscd.X_FIELDVALUE
                      ,toinvest.SHORT_DESC                                                                                            
                      ,case when tosenscd.X_FIELDVALUE = 'T1'  then 'T1-NACI'
                            when tosenscd.X_FIELDVALUE = 'T2S' then 'T2S'
                            when tosenscd.X_FIELDVALUE = 'T3'  then 'T3-ANACI,NACLC Initial'
                            when tosenscd.X_FIELDVALUE = 'T4'  then 'T4-BI'
                            when tosenscd.X_FIELDVALUE = 'T5'  then 'T5-SSBI'
                          else null end  
                      ,frsenscd.X_FIELDVALUE
                      ,frinvest.SHORT_DESC                                                                                            
                      ,case when frsenscd.X_FIELDVALUE = 'T1'  then 'T1-NACI'
                            when frsenscd.X_FIELDVALUE = 'T2S' then 'T2S'
                            when frsenscd.X_FIELDVALUE = 'T3'  then 'T3-ANACI,NACLC Initial'
                            when frsenscd.X_FIELDVALUE = 'T4'  then 'T4-BI'
                            when frsenscd.X_FIELDVALUE = 'T5'  then 'T5-SSBI'
                          else null end  
                      from            nhrdw_personnel_action sf50
                      LEFT OUTER JOIN  PS_POSITION_DATA topos on  topos.position_nbr = sf50.act_position_nbr               
                      		                           AND topos.EFFDT  =                                      
                      		                              (SELECT MAX(topos_ed.EFFDT) FROM PS_POSITION_DATA topos_ed
                      		                               WHERE topos_ed.position_nbr = sf50.act_position_nbr          
                      		                               AND topos_ed.EFFDT <= sf50.effdt ) 		         
                      LEFT OUTER JOIN PS_Z_POSITION_DATA tozps ON tozps.position_nbr = topos.position_nbr  AND tozps.effdt    = topos.effdt	
                      LEFT OUTER JOIN nhrdw_occ_series_addl_info tooca on tooca.GVT_OCC_SERIES=topos.GVT_OCC_SERIES  and tooca.SETID = sf50.act_SETID_DEPT
                                                                         and tooca.EFFDT = (SELECT MAX(tooca_ed.EFFDT)
                                                  FROM  nhrdw_occ_series_addl_info tooca_ed
                                                  WHERE  tooca_ed.SETID          = sf50.act_SETID_DEPT
                                                  AND    tooca_ed.GVT_OCC_SERIES = topos.GVT_OCC_SERIES    
                                                  AND    tooca_ed.EFFDT <= topos.effdt )  
                      LEFT OUTER JOIN  PS_POSITION_DATA frpos on  frpos.position_nbr = sf50.frm_position_nbr               
                      		                           AND frpos.EFFDT  =                                      
                      		                              (SELECT MAX(frpos_ed.EFFDT) FROM PS_POSITION_DATA frpos_ed
                      		                               WHERE frpos_ed.position_nbr = sf50.frm_position_nbr         
                      		                               AND frpos_ed.EFFDT <= sf50.act_pr_effdt )                                		                                                                         
                      LEFT OUTER JOIN PS_Z_POSITION_DATA frzps ON frzps.position_nbr = frpos.position_nbr  AND frzps.effdt    = frpos.effdt	  
                      LEFT OUTER JOIN ps_gvt_occupation  toocc ON toocc.GVT_OCC_SERIES = topos.GVT_OCC_SERIES                                                               
                      	                                          AND  toocc.EFFDT =                                                                        
                                                                               (SELECT MAX(toocc_ed.EFFDT) FROM ps_gvt_occupation toocc_ed            
                                                                               WHERE toocc_ed.GVT_OCC_SERIES = topos.GVT_OCC_SERIES                   
                                                                                 AND toocc_ed.EFFDT     <= topos.effdt )                     
                      LEFT OUTER JOIN ps_gvt_occupation  frocc ON frocc.GVT_OCC_SERIES = frpos.GVT_OCC_SERIES                                                               
                      	                                          AND frocc.EFFDT =                                                                        
                                                                               (SELECT MAX(frocc_ed.EFFDT) FROM ps_gvt_occupation frocc_ed            
                                                                               WHERE frocc_ed.GVT_OCC_SERIES = frpos.GVT_OCC_SERIES                   
                                                                                 AND frocc_ed.EFFDT     <= frpos.effdt )                      
                      LEFT OUTER JOIN nhrdw_occ_series_addl_info froca on frpos.GVT_OCC_SERIES = froca.GVT_OCC_SERIES  and froca.SETID = sf50.frm_SETID_DEPT 
                                                                         and froca.EFFDT = (SELECT MAX(froca_ed.EFFDT)
                                                  FROM  nhrdw_occ_series_addl_info froca_ed
                                                  WHERE  froca_ed.SETID          =  sf50.frm_SETID_DEPT 
                                                  AND    froca_ed.GVT_OCC_SERIES =  frpos.GVT_OCC_SERIES    
                                                  AND    froca_ed.EFFDT <= frpos.effdt )   
                     LEFT OUTER JOIN PS_SET_CNTRL_REC TOSPC ON       TOSPC.SETCNTRLVALUE = topos.BUSINESS_UNIT
                                                    AND TOSPC.RECNAME = 'SUPVSR_LVL_TBL'  
                     LEFT OUTER JOIN PS_SUPVSR_LVL_TBL TOSUP ON              TOSUP.SUPV_LVL_ID = topos.SUPV_LVL_ID  and TOSUP.SETID = TOSPC.setid
                                                                              AND TOSUP.EFFDT =
                                                                                   ( SELECT MAX(TOSUP_ED.EFFDT) FROM PS_SUPVSR_LVL_TBL TOSUP_ED
                                                                                     WHERE TOSUP_ED.SETID = TOSPC.setid
                                                                                       AND TOSUP_ED.SUPV_LVL_ID = topos.SUPV_LVL_ID
                                                                                       AND TOSUP_ED.EFFDT <= sf50.effdt )  
                     LEFT OUTER JOIN PS_SET_CNTRL_REC FRSPC ON       FRSPC.SETCNTRLVALUE = FRpos.BUSINESS_UNIT
                                                    AND FRSPC.RECNAME = 'SUPVSR_LVL_TBL'  
                     LEFT OUTER JOIN PS_SUPVSR_LVL_TBL FRSUP ON              FRSUP.SUPV_LVL_ID = frpos.SUPV_LVL_ID and FRSUP.SETID = frSPC.setid
                                                                              AND FRSUP.EFFDT =
                                                                                   ( SELECT MAX(FRSUP_ED.EFFDT) FROM PS_SUPVSR_LVL_TBL FRSUP_ED
                                                                                     WHERE FRSUP_ED.SETID       = frSPC.setid
                                                                                       AND FRSUP_ED.SUPV_LVL_ID = frpos.SUPV_LVL_ID
                                                                                       AND FRSUP_ED.EFFDT       <= sf50.act_pr_effdt ) 
                     LEFT OUTER JOIN  psxlatitem topat on  topat.FIELDNAME  = 'GVT_PATCOB_CD' and topat.FIELDVALUE = TOOCC.GVT_PATCOB_CD	
                                                             AND topat.EFFDT =(SELECT MAX(xlat_ED.EFFDT) FROM psxlatitem xlat_ED
                                                                               WHERE xlat_ED.FIELDVALUE = TOOCC.GVT_PATCOB_CD	
		                                                                         AND xlat_ED.FIELDNAME  = 'GVT_PATCOB_CD' 
                                                                                 AND xlat_ED.EFFDT       <= sf50.EFFDT)			
                     LEFT OUTER JOIN  psxlatitem frpat on  frpat.FIELDNAME  = 'GVT_PATCOB_CD' and frpat.FIELDVALUE = FROCC.GVT_PATCOB_CD	
                                                             AND frpat.EFFDT =(SELECT MAX(xlat_ED.EFFDT) FROM psxlatitem xlat_ED
                                                                               WHERE xlat_ED.FIELDVALUE = FROCC.GVT_PATCOB_CD
		                                                                         AND xlat_ED.FIELDNAME  = 'GVT_PATCOB_CD' 
                                                                                 AND xlat_ED.EFFDT       <= sf50.act_pr_EFFDT)
                     LEFT OUTER JOIN  psxlatitem tosen on  tosen.FIELDNAME  = 'GVT_POSN_SENS_CD' and tosen.FIELDVALUE = topos.GVT_POSN_SENS_CD
                                                             AND tosen.EFFDT =(SELECT MAX(xlat_ED.EFFDT) FROM psxlatitem xlat_ED
                                                                               WHERE xlat_ED.FIELDVALUE = topos.GVT_POSN_SENS_CD
		                                                                         AND xlat_ED.FIELDNAME  = 'GVT_POSN_SENS_CD' 
                                                                                 AND xlat_ED.EFFDT       <= sf50.EFFDT)			
                     LEFT OUTER JOIN  psxlatitem frsen on  frsen.FIELDNAME  = 'GVT_POSN_SENS_CD' and frsen.FIELDVALUE = frpos.GVT_POSN_SENS_CD
                                                             AND frsen.EFFDT =(SELECT MAX(xlat_ED.EFFDT) FROM psxlatitem xlat_ED
                                                                               WHERE xlat_ED.FIELDVALUE = frpos.GVT_POSN_SENS_CD
		                                                                            AND xlat_ED.FIELDNAME  = 'GVT_POSN_SENS_CD' 
                                                                                 AND xlat_ED.EFFDT       <= sf50.act_pr_EFFDT)																				 
                     left outer join nhrdw_custom_xlatitem tosenscd on tosenscd.FIELDVALUE = TOPOS.gvt_posn_sens_cd and tosenscd.FIELDNAME  = 'GVT_POSN_SENS_CD' 
                                                              AND tosenscd.EFFDT =
                                                                      (SELECT MAX(xlat_ED.EFFDT) FROM nhrdw_custom_xlatitem xlat_ED
                                                                       WHERE xlat_ED.FIELDVALUE = TOPOS.gvt_posn_sens_cd 
                             		                                        AND xlat_ED.FIELDNAME  = 'GVT_POSN_SENS_CD'  
                                                                         AND xlat_ED.EFFDT      <= TOPOS.EFFDT)
                     left outer join nhrdw_custom_xlatitem toinvest on toinvest.FIELDVALUE = tosenscd.X_FIELDVALUE and toinvest.FIELDNAME  = tosenscd.X_FIELDNAME
                                                              AND toinvest.EFFDT =
                                                                      (SELECT MAX(xlat_ED.EFFDT) FROM nhrdw_custom_xlatitem xlat_ED
                                                                       WHERE xlat_ED.FIELDVALUE = tosenscd.X_FIELDVALUE
                             		                                        AND xlat_ED.FIELDNAME  = tosenscd.X_FIELDNAME
                                                                         AND xlat_ED.EFFDT      <= TOPOS.EFFDT)
                     left outer join nhrdw_custom_xlatitem frsenscd on frsenscd.FIELDVALUE = FRPOS.gvt_posn_sens_cd and frsenscd.FIELDNAME  = 'GVT_POSN_SENS_CD' 
                                                              AND frsenscd.EFFDT =
                                                                      (SELECT MAX(xlat_ED.EFFDT) FROM nhrdw_custom_xlatitem xlat_ED
                                                                       WHERE xlat_ED.FIELDVALUE = FRPOS.gvt_posn_sens_cd 
                             		                                        AND xlat_ED.FIELDNAME  = 'GVT_POSN_SENS_CD'  
                                                                         AND xlat_ED.EFFDT      <= FRPOS.EFFDT)
                     left outer join nhrdw_custom_xlatitem frinvest on frinvest.FIELDVALUE = frsenscd.X_FIELDVALUE and frinvest.FIELDNAME  = frsenscd.X_FIELDNAME
                                                              AND frinvest.EFFDT =
                                                                      (SELECT MAX(xlat_ED.EFFDT) FROM nhrdw_custom_xlatitem xlat_ED
                                                                       WHERE xlat_ED.FIELDVALUE = frsenscd.X_FIELDVALUE
                             		                                        AND xlat_ED.FIELDNAME  = frsenscd.X_FIELDNAME
                                                                         AND xlat_ED.EFFDT      <= FRPOS.EFFDT)
                      ;
                      commit;  

                      call nhrdw_process_log_trk (-7001, 'I', 'Refresh SF50 Transaction : Insert SF50 Personnel Action Org Location' );

                      commit;
                      
                      insert into nhrdw_personnel_action_org_and_loc_info 
                      (
                        SF50_TRANSACTION_CONTROL_ID           
                       ,EMPLID                                
                       ,EMPL_RCD                              
                       ,EFFDT                                 
                       ,EFFSEQ                                
                       ,ACT_GVT_PAR_LINE2                     
                       ,ACT_GVT_PAR_LINE3                     
                       ,ACT_GVT_PAR_LINE4                     
                       ,ACT_GVT_PAR_LINE5                     
                       ,ACT_GVT_PAR_DESCR2                    
                       ,ACT_GVT_PAR_DESCR3                    
                       ,ACT_GVT_PAR_DESCR4                    
                       ,ACT_GVT_PAR_DESCR5                    
                       ,FRM_GVT_PAR_LINE2                     
                       ,FRM_GVT_PAR_LINE3                     
                       ,FRM_GVT_PAR_LINE4                     
                       ,FRM_GVT_PAR_LINE5                     
                       ,FRM_GVT_PAR_DESCR2                    
                       ,FRM_GVT_PAR_DESCR3                    
                       ,FRM_GVT_PAR_DESCR4                    
                       ,FRM_GVT_PAR_DESCR5                    
                       ,ACT_GVT_GEOLOC_CD	                   
                       ,ACT_GEOLOC_GVT_ST_CNTRY_DESCR		     
                       ,ACT_GEOLOC_CITY	         		         
                       ,ACT_GEOLOC_STATE	         		         
                       ,ACT_GEOLOC_COUNTY	         		       
                       ,ACT_GEOLOC_COUNTRY                    
                       ,ACT_GEOLOC_GSA_REGION
                       ,ACT_GEOLOC_GSA_REGION_DESCR	  			       
                       ,ACT_GVT_MSA	        	               
                       ,ACT_GVT_CMSA	        	               
                       ,ACT_GVT_LEOPAY_AREA		               
                       ,ACT_GVT_LEOPAY_AREA_EFFDT	           
                       ,ACT_GVT_LEOPAY_AREA_DESCR             
                       ,ACT_GVT_LEO_PCT                       
                       ,ACT_GVT_LOCALITY_AREA		             
                       ,ACT_GVT_LOCALITY_AREA_EFFDT           
                       ,ACT_GVT_LOCALITY_AREA_DESCR           
                       ,ACT_GVT_LOCALITY_PCT                  
                       ,ACT_GVT_IGA_PCT                       
                       ,FRM_GVT_GEOLOC_CD	                   
                       ,FRM_GEOLOC_GVT_ST_CNTRY_DESCR		     
                       ,FRM_GEOLOC_CITY	         		         
                       ,FRM_GEOLOC_STATE	         		         
                       ,FRM_GEOLOC_COUNTY	         		       
                       ,FRM_GEOLOC_COUNTRY                    
                       ,FRM_GEOLOC_GSA_REGION	
                       ,FRM_GEOLOC_GSA_REGION_DESCR					   
                       ,FRM_GVT_MSA	        	               
                       ,FRM_GVT_CMSA	        	               
                       ,FRM_GVT_LEOPAY_AREA		               
                       ,FRM_GVT_LEOPAY_AREA_EFFDT	           
                       ,FRM_GVT_LEOPAY_AREA_DESCR             
                       ,FRM_GVT_LEO_PCT                       
                       ,FRM_GVT_LOCALITY_AREA		             
                       ,FRM_GVT_LOCALITY_AREA_EFFDT           
                       ,FRM_GVT_LOCALITY_AREA_DESCR           
                       ,FRM_GVT_LOCALITY_PCT                  
                       ,FRM_GVT_IGA_PCT                       
                       ,ACT_NFCOLA_PERCENT                    
                       ,FRM_NFCOLA_PERCENT              	     
                       ,ACT_DEPT_BUSINESS_LINE     
                       ,ACT_DEPT_BUSINESS_LINE_DESCR           
                       ,FRM_DEPT_BUSINESS_LINE   
                       ,FRM_DEPT_BUSINESS_LINE_DESCR             
                       ,ACT_DEPT_DESCR                     
                       ,ACT_DEPT_GVT_DESCR40               
	                     ,FRM_DEPT_DESCR                     
                       ,FRM_DEPT_GVT_DESCR40               
                      )
                       select
                       SF50.SF50_TRANSACTION_CONTROL_ID          SF50_TRANSACTION_CONTROL_ID         
                      ,sf50.EMPLID                               EMPLID                              
                      ,sf50.EMPL_RCD                             EMPL_RCD                            
                      ,sf50.EFFDT                                EFFDT                               
                      ,sf50.EFFSEQ                               EFFSEQ                              
                      ,TODEP.GVT_PAR_LINE2                       ACT_GVT_PAR_LINE2
                      ,TODEP.GVT_PAR_LINE3                       ACT_GVT_PAR_LINE3
                      ,TODEP.GVT_PAR_LINE4                       ACT_GVT_PAR_LINE4
                      ,TODEP.GVT_PAR_LINE5                       ACT_GVT_PAR_LINE5
                      ,TODEP.GVT_PAR_DESCR2                      ACT_GVT_PAR_DESCR2
                      ,TODEP.GVT_PAR_DESCR3                      ACT_GVT_PAR_DESCR3
                      ,TODEP.GVT_PAR_DESCR4                      ACT_GVT_PAR_DESCR4
                      ,TODEP.GVT_PAR_DESCR5                      ACT_GVT_PAR_DESCR5
                      ,FRDEP.GVT_PAR_LINE2                       FRM_GVT_PAR_LINE2
                      ,FRDEP.GVT_PAR_LINE3                       FRM_GVT_PAR_LINE3
                      ,FRDEP.GVT_PAR_LINE4                       FRM_GVT_PAR_LINE4
                      ,FRDEP.GVT_PAR_LINE5                       FRM_GVT_PAR_LINE5
                      ,FRDEP.GVT_PAR_DESCR2                      FRM_GVT_PAR_DESCR2
                      ,FRDEP.GVT_PAR_DESCR3                      FRM_GVT_PAR_DESCR3
                      ,FRDEP.GVT_PAR_DESCR4                      FRM_GVT_PAR_DESCR4
                      ,FRDEP.GVT_PAR_DESCR5                      FRM_GVT_PAR_DESCR5
                      ,TOGEO.GVT_GEOLOC_CD	                     ACT_GVT_GEOLOC_CD	                     	                                      
                      ,TOGEO.GVT_ST_CNTRY_DESCR		               ACT_GEOLOC_GVT_ST_CNTRY_DESCR		             
                      ,TOGEO.CITY	         		                   ACT_GEOLOC_CITY	         		                 
                      ,TOGEO.STATE	         		                 ACT_GEOLOC_STATE	         		                 
                      ,TOGEO.COUNTY	         		                 ACT_GEOLOC_COUNTY	         		               
                      ,TOGEO.COUNTRY                             ACT_GEOLOC_COUNTRY                            
                      ,COALESCE(todsrc.X_FIELDVALUE,todsr.X_FIELDVALUE)  	                     ACT_GEOLOC_GSA_REGION	 
                      ,togsr.SHORT_DESC   	                     ACT_GEOLOC_GSA_REGION_DESCR					  
                      ,TOGEO.GVT_MSA	        	                 ACT_GVT_MSA	        	                 
                      ,TOGEO.GVT_CMSA	        	                 ACT_GVT_CMSA	        	               
                      ,TOGEO.GVT_LEOPAY_AREA		                 ACT_GVT_LEOPAY_AREA		                 
                      ,TOLEO.EFFDT	                             ACT_GVT_LEOPAY_AREA_EFFDT	             
                      ,TOLEO.DESCR                               ACT_GVT_LEOPAY_AREA_DESCR              
                      ,TOLEO.GVT_LEO_PCT                         ACT_GVT_LEO_PCT                        
                      ,TOGEO.GVT_LOCALITY_AREA		               ACT_GVT_LOCALITY_AREA		               
                      ,TOLRE.EFFDT                               ACT_GVT_LOCALITY_AREA_EFFDT            
                      ,TOLRE.DESCR                               ACT_GVT_LOCALITY_AREA_DESCR            
                      ,TOLRE.GVT_LOCALITY_PCT                    ACT_GVT_LOCALITY_PCT                   
                      ,TOLRE.GVT_IGA_PCT                	       ACT_GVT_IGA_PCT            
                      ,FRGEO.GVT_GEOLOC_CD	                     FRM_GVT_GEOLOC_CD	                     	       	       
                      ,FRGEO.GVT_ST_CNTRY_DESCR		               FRM_GEOLOC_GVT_ST_CNTRY_DESCR		           
                      ,FRGEO.CITY	         		                   FRM_GEOLOC_CITY	         		               
                      ,FRGEO.STATE	         		                 FRM_GEOLOC_STATE	         		               
                      ,FRGEO.COUNTY	         		                 FRM_GEOLOC_COUNTY	         		             
                      ,FRGEO.COUNTRY                             FRM_GEOLOC_COUNTRY                          
                      ,COALESCE(frdsrc.X_FIELDVALUE,frdsr.X_FIELDVALUE)  	                     FRM_GEOLOC_GSA_REGION	                       
                      ,frgsr.SHORT_DESC   	                     FRM_GEOLOC_GSA_REGION_DESCR					  
                      ,FRGEO.GVT_MSA	        	                 FRM_GVT_MSA	        	                     
                      ,FRGEO.GVT_CMSA	        	                 FRM_GVT_CMSA	        	                     
                      ,FRGEO.GVT_LEOPAY_AREA		                 FRM_GVT_LEOPAY_AREA		                     
                      ,FRLEO.EFFDT	                             FRM_GVT_LEOPAY_AREA_EFFDT	                 
                      ,FRLEO.DESCR                               FRM_GVT_LEOPAY_AREA_DESCR                   
                      ,FRLEO.GVT_LEO_PCT                         FRM_GVT_LEO_PCT                             
                      ,FRGEO.GVT_LOCALITY_AREA		               FRM_GVT_LOCALITY_AREA		                   
                      ,FRLRE.EFFDT                               FRM_GVT_LOCALITY_AREA_EFFDT                 
                      ,FRLRE.DESCR                               FRM_GVT_LOCALITY_AREA_DESCR                 
                      ,FRLRE.GVT_LOCALITY_PCT                    FRM_GVT_LOCALITY_PCT                        
                      ,FRLRE.GVT_IGA_PCT                	       FRM_GVT_IGA_PCT  
                      ,tonfc.Z_FOR_DIFF_PCT                      ACT_NFCOLA_PERCENT
                      ,frnfc.Z_FOR_DIFF_PCT                      FRM_NFCOLA_PERCENT              	           
                      ,tozdep.Z_TEXT30_5                         ACT_DEPT_BUSINESS_LINE
                      ,tozdep.Z_TEXT254_5                        ACT_DEPT_BUSINESS_LINE_DESCR
                      ,frzdep.Z_TEXT30_5                         FRM_DEPT_BUSINESS_LINE   
                      ,frzdep.Z_TEXT254_5                        ACT_DEPT_BUSINESS_LINE_DESCR
                      ,FRDEP.DESCR                                    
                      ,FRDEP.GVT_DESCR40             
	                    ,FRDEP.DESCR                                   
                      ,FRDEP.GVT_DESCR40     
                      from            NHRDW_PERSONNEL_ACTION sf50
                      left outer join PS_DEPT_TBL         todep  on todep.deptid   = sf50.act_deptid and todep.SETID   = sf50.ACT_SETID_DEPT  and TODEP.EFFDT =  (SELECT MAX(DEP_ED.EFFDT) FROM PS_DEPT_TBL DEP_ED
                                                                                                                        WHERE DEP_ED.SETID  = sf50.ACT_SETID_DEPT
                                                                                                                          AND DEP_ED.DEPTID = sf50.ACT_DEPTID
                                                                                                                          AND DEP_ED.EFFDT <= sf50.EFFDT )  
                      left outer join PS_DEPT_TBL         frdep  on frdep.deptid   = sf50.frm_deptid and frdep.SETID   = SF50.FRM_SETID_DEPT and FRDEP.EFFDT =  (SELECT MAX(DEP_ED.EFFDT) FROM PS_DEPT_TBL DEP_ED
                                                                                                                        WHERE DEP_ED.SETID  = sf50.FRM_SETID_DEPT
                                                                                                                          AND DEP_ED.DEPTID = sf50.FRM_DEPTID
                                                                                                                          AND DEP_ED.EFFDT <= sf50.ACT_PR_EFFDT )  
                      LEFT OUTER JOIN PS_Z_DEPT_TBL tozdep ON tozdep.SETID = sf50.ACT_SETID_DEPT AND tozdep.DEPTID = sf50.ACT_DEPTID
                                                              AND   tozdep.EFFDT = 
                                                                            (SELECT MAX(tozdep_ED.EFFDT) FROM ps_dept_tbl tozdep_ED 
                                                                              WHERE tozdep_ED.DEPTID = sf50.ACT_DEPTID
                                                                                AND tozdep_ED.SETID = sf50.ACT_SETID_DEPT                     
                                                                                AND tozdep_ED.EFFDT <= sf50.EFFDT )
                      LEFT OUTER JOIN PS_Z_DEPT_TBL frzdep ON frzdep.SETID = sf50.FRM_SETID_DEPT AND frzdep.DEPTID = sf50.FRM_DEPTID                    
                                                              AND   frzdep.EFFDT = 
                                                                            (SELECT MAX(frzdep_ED.EFFDT) FROM ps_dept_tbl frzdep_ED 
                                                                              WHERE frzdep_ED.DEPTID = SF50.FRM_DEPTID
                                                                                AND frzdep_ED.SETID  = SF50.FRM_SETID_DEPT                     
                                                                                AND frzdep_ED.EFFDT <= SF50.ACT_PR_EFFDT)
                      LEFT OUTER JOIN ps_location_tbl     toloc ON     toloc.LOCATION = SF50.ACT_LOCATION                              
                                                                   AND toloc.SETID    = SF50.ACT_SETID_LOCATION            
                      	                                           AND toloc.EFFDT    = (SELECT MAX(toloc_ed.EFFDT) 
                      	                                                                  FROM ps_location_tbl toloc_ed              
                      		                                                              	WHERE toloc_ed.LOCATION  = SF50.ACT_LOCATION                            
                                                                                            AND toloc_ed.SETID     = SF50.ACT_SETID_LOCATION                                                    
                      		                                                                	AND toloc_ed.EFFDT <= SF50.effdt   ) 
                      LEFT OUTER JOIN  PS_GVT_GEOLOC_TBL togeo on togeo.GVT_GEOLOC_CD = toloc.GVT_GEOLOC_CD
                      	                                      AND togeo.EFFDT = (SELECT MAX(togeo_ed.EFFDT) FROM PS_GVT_GEOLOC_TBL togeo_ed 
                                                                                  WHERE togeo_ed.GVT_GEOLOC_CD = toloc.GVT_GEOLOC_CD
                                                                                    AND togeo_ed.EFFDT     <= SF50.effdt )                            
                      LEFT OUTER JOIN   PS_GVT_LEOAREA_TBL toleo ON toleo.GVT_LEOPAY_AREA = togeo.GVT_LEOPAY_AREA
                                                                AND toleo.EFFDT = (SELECT MAX(toleo_ed.EFFDT) 
                                                                                     FROM   PS_GVT_LEOAREA_TBL toleo_ed 
                                                                                    WHERE   toleo_ed.GVT_LEOPAY_AREA = togeo.GVT_LEOPAY_AREA
                                                                                      AND   toleo_ed.EFFDT <= SF50.effdt )      	         
                      LEFT OUTER JOIN  PS_GVT_LOCAREA_TBL tolre ON  tolre.GVT_LOCALITY_AREA = togeo.GVT_LOCALITY_AREA 
                                                               AND  tolre.EFFDT = (SELECT MAX(tolre_ed.EFFDT) 
                                                                                     FROM   PS_GVT_LOCAREA_TBL tolre_ed 
                                                                                     WHERE  tolre_ed.GVT_LOCALITY_AREA = togeo.GVT_LOCALITY_AREA
                                                                                       AND    tolre_ed.EFFDT <= SF50.EFFDT ) 
                      LEFT OUTER JOIN ps_location_tbl     frloc ON     frloc.LOCATION = SF50.FRM_LOCATION                              
                                                                   AND frloc.SETID    = SF50.FRM_SETID_LOCATION            
                      	                                           AND frloc.EFFDT    = (SELECT MAX(frloc_ed.EFFDT) 
                      	                                                                  FROM ps_location_tbl frloc_ed              
                      		                                                              	WHERE frloc_ed.LOCATION  = SF50.FRM_LOCATION                            
                                                                                            AND frloc_ed.SETID     = SF50.FRM_SETID_LOCATION                                                    
                      		                                                                	AND frloc_ed.EFFDT <= SF50.ACT_PR_effdt   ) 
                      LEFT OUTER JOIN PS_Z_LOC_PYPCT_TBL   tonfc ON    tonfc.LOCATION = toloc.LOCATION                              
                                                                   AND tonfc.SETID    = toloc.SETID  
                                                                   AND tonfc.eff_status = 'A'
                                                                   AND tonfc.ERNCD    = 'COL'         
                      	                                           AND tonfc.EFFDT    = (SELECT MAX(tonfc_ed.EFFDT) 
                      	                                                                  FROM PS_Z_LOC_PYPCT_TBL tonfc_ed              
                      		                                                              	WHERE tonfc_ed.LOCATION  = toloc.LOCATION                             
                                                                                            AND tonfc_ed.SETID     = toloc.SETID        
                                                                                            AND tonfc_ed.eff_status = 'A'
                                                                                            AND tonfc_ed.ERNCD    = 'COL'                                                   
                      		                                                                	AND tonfc_ed.EFFDT <= SF50.effdt   ) 
                      LEFT OUTER JOIN PS_Z_LOC_PYPCT_TBL   frnfc ON    frnfc.LOCATION = frloc.LOCATION                              
                                                                   AND frnfc.SETID    = frloc.SETID  
                                                                   AND frnfc.eff_status = 'A'
                                                                   AND frnfc.ERNCD    = 'COL'         
                      	                                           AND frnfc.EFFDT    = (SELECT MAX(frnfc_ed.EFFDT) 
                      	                                                                  FROM PS_Z_LOC_PYPCT_TBL frnfc_ed              
                      		                                                              	WHERE frnfc_ed.LOCATION  = frloc.LOCATION                            
                                                                                            AND frnfc_ed.SETID     = frloc.SETID      
                                                                                            AND frnfc_ed.eff_status = 'A'
                                                                                            AND frnfc_ed.ERNCD    = 'COL'                                                   
                      		                                                                	AND frnfc_ed.EFFDT <= SF50.ACT_PR_effdt   ) 
                      LEFT OUTER JOIN  PS_GVT_GEOLOC_TBL frgeo on frgeo.GVT_GEOLOC_CD = frloc.GVT_GEOLOC_CD
                      	                                      AND frgeo.EFFDT = (SELECT MAX(frgeo_ed.EFFDT) FROM PS_GVT_GEOLOC_TBL frgeo_ed 
                                                                                  WHERE frgeo_ed.GVT_GEOLOC_CD = frloc.GVT_GEOLOC_CD 
                                                                                    AND frgeo_ed.EFFDT     <= SF50.ACT_PR_effdt )                            
                      LEFT OUTER JOIN   PS_GVT_LEOAREA_TBL frleo ON frleo.GVT_LEOPAY_AREA = frgeo.GVT_LEOPAY_AREA
                                                                AND frleo.EFFDT = (SELECT MAX(frleo_ed.EFFDT) 
                                                                                     FROM   PS_GVT_LEOAREA_TBL frleo_ed 
                                                                                    WHERE   frleo_ed.GVT_LEOPAY_AREA = frgeo.GVT_LEOPAY_AREA
                                                                                      AND   frleo_ed.EFFDT <= SF50.ACT_PR_effdt  )      	         
                      LEFT OUTER JOIN  PS_GVT_LOCAREA_TBL frlre ON  frlre.GVT_LOCALITY_AREA = frgeo.GVT_LOCALITY_AREA 
                                                               AND  frlre.EFFDT = (SELECT MAX(frlre_ed.EFFDT) 
                                                                                     FROM   PS_GVT_LOCAREA_TBL frlre_ed 
                                                                                     WHERE  frlre_ed.GVT_LOCALITY_AREA = frgeo.GVT_LOCALITY_AREA 
                                                                                       AND    frlre_ed.EFFDT <= SF50.ACT_PR_effdt ) 
                     LEFT OUTER JOIN  nhrdw_custom_xlatitem todsr on  todsr.FIELDNAME  = 'GSA_DUTY_STATION_REGION' and todsr.FIELDVALUE = SUBSTR(TOGEO.GVT_GEOLOC_CD,1,2) and  todsr.X_FIELDNAME    = 'GSA_REGION'
                                                             AND todsr.EFFDT =(SELECT MAX(todsr_ED.EFFDT) FROM nhrdw_custom_xlatitem todsr_ED
                                                                               WHERE todsr_ED.FIELDVALUE = SUBSTR(TOGEO.GVT_GEOLOC_CD,1,2)
		                                                                         AND todsr_ED.X_FIELDNAME  = 'GSA_REGION' 
		                                                                         and todsr_ED.FIELDNAME    = 'GSA_DUTY_STATION_REGION'
                                                                                 AND todsr_ED.EFFDT       <= sf50.EFFDT)
                    LEFT OUTER JOIN nhrdw_custom_xlatitem todsrc on todsrc.FIELDNAME      = 'GSA_DUTY_STATION_REGION_BY_CODE' AND todsrc.FIELDVALUE     = TOGEO.GVT_GEOLOC_CD AND todsrc.X_FIELDNAME    = 'GSA_REGION'
                               AND todsrc.EFFDT =
                                                  (SELECT MAX(xlat_ED.EFFDT) FROM nhrdw_custom_xlatitem xlat_ED
                                                   WHERE xlat_ED.FIELDVALUE     = TOGEO.GVT_GEOLOC_CD
	                                    	            AND xlat_ED.FIELDNAME      = 'GSA_DUTY_STATION_REGION_BY_CODE'
	                                                 	and xlat_ED.X_FIELDNAME    = 'GSA_REGION'
                                                    AND xlat_ED.EFFDT       <= sf50.EFFDT)
                     LEFT OUTER JOIN  nhrdw_custom_xlatitem frdsr on  frdsr.FIELDNAME  = 'GSA_DUTY_STATION_REGION' and frdsr.FIELDVALUE = SUBSTR(FRGEO.GVT_GEOLOC_CD,1,2) and  frdsr.X_FIELDNAME    = 'GSA_REGION'
                                                             AND frdsr.EFFDT =(SELECT MAX(frdsr_ED.EFFDT) FROM nhrdw_custom_xlatitem frdsr_ED
                                                                               WHERE frdsr_ED.FIELDVALUE = SUBSTR(FRGEO.GVT_GEOLOC_CD,1,2)
		                                                                         AND frdsr_ED.X_FIELDNAME  = 'GSA_REGION' 
		                                                                         and frdsr_ED.FIELDNAME    = 'GSA_DUTY_STATION_REGION' 
                                                                                 AND frdsr_ED.EFFDT       <= sf50.act_pr_EFFDT)			
                    LEFT OUTER JOIN nhrdw_custom_xlatitem frdsrc on frdsrc.FIELDNAME      = 'GSA_DUTY_STATION_REGION_BY_CODE' AND frdsrc.FIELDVALUE     = FRGEO.GVT_GEOLOC_CD AND frdsrc.X_FIELDNAME    = 'GSA_REGION'
                               AND todsrc.EFFDT =
                                                  (SELECT MAX(xlat_ED.EFFDT) FROM nhrdw_custom_xlatitem xlat_ED
                                                   WHERE xlat_ED.FIELDVALUE     = FRGEO.GVT_GEOLOC_CD
	                                    	            AND xlat_ED.FIELDNAME      = 'GSA_DUTY_STATION_REGION_BY_CODE'
	                                                 	and xlat_ED.X_FIELDNAME    = 'GSA_REGION'
                                                    AND xlat_ED.EFFDT       <= sf50.act_pr_EFFDT)
                     LEFT OUTER JOIN  nhrdw_custom_xlatitem togsr on  togsr.FIELDNAME  = 'GSA_REGION' and togsr.FIELDVALUE = COALESCE(todsrc.X_FIELDVALUE,todsr.X_FIELDVALUE)
                                                             AND togsr.EFFDT =(SELECT MAX(togsr_ED.EFFDT) FROM nhrdw_custom_xlatitem togsr_ED
                                                                               WHERE togsr_ED.FIELDVALUE = COALESCE(todsrc.X_FIELDVALUE,todsr.X_FIELDVALUE)
		                                                                         AND togsr_ED.FIELDNAME  = 'GSA_REGION' 
                                                                                 AND togsr_ED.EFFDT       <= sf50.EFFDT)			
                     LEFT OUTER JOIN  nhrdw_custom_xlatitem frgsr on  frgsr.FIELDNAME  = 'GSA_REGION' and frgsr.FIELDVALUE = COALESCE(frdsrc.X_FIELDVALUE,frdsr.X_FIELDVALUE)  
                                                             AND frdsr.EFFDT =(SELECT MAX(frgsr_ED.EFFDT) FROM nhrdw_custom_xlatitem frgsr_ED
                                                                               WHERE frgsr_ED.FIELDVALUE = COALESCE(frdsrc.X_FIELDVALUE,frdsr.X_FIELDVALUE)  
		                                                                         AND frgsr_ED.FIELDNAME  = 'GSA_REGION' 
                                                                                 AND frgsr_ED.EFFDT       <= sf50.act_pr_EFFDT)		;
                                                                                 
                      commit;                                                          

                      call nhrdw_process_log_trk (-7001, 'I', 'Refresh SF50 Transaction : Insert SF50 Personnel Action Additional Info' );
 
                      commit;  


                       INSERT INTO NHRDW_PERSONNEL_ACTION_ADDITIONAL_INFO 
                       (
                        SF50_TRANSACTION_CONTROL_ID
                       ,EMPLID
                       ,EMPL_RCD
                       ,EFFDT
                       ,EFFSEQ
                       ,PRO_GVT_DATE_WRK
                       ,PRO_OPRID
                       ,PRO_GVT_OPRID_OVERRIDE
                       ,PRO_GVT_TRK_EMPLID
                       ,PRO_GVT_TRK_EMPL_RCD
                       ,PRO_GVT_EE_TRK_DT
                       ,PRO_GVT_NFC_AUTHCTN_DT
                       ,INI_GVT_DATE_WRK
                       ,INI_OPRID
                       ,INI_GVT_OPRID_OVERRIDE
                       ,INI_GVT_TRK_EMPLID
                       ,INI_GVT_TRK_EMPL_RCD
                       ,INI_GVT_EE_TRK_DT
                       ,INI_GVT_NFC_AUTHCTN_DT
                       ,REQ_GVT_DATE_WRK
                       ,REQ_OPRID
                       ,REQ_GVT_OPRID_OVERRIDE
                       ,REQ_GVT_TRK_EMPLID
                       ,REQ_GVT_TRK_EMPL_RCD
                       ,REQ_GVT_EE_TRK_DT
                       ,REQ_GVT_NFC_AUTHCTN_DT
                       ,ACT_CITIZENSHIP_COUNTRY
                       ,ACT_CITIZENSHIP_STATUS
                       ,ACT_CITIZENSHIP_STATUS_DESCR
                       ,FRM_CITIZENSHIP_COUNTRY
                       ,FRM_CITIZENSHIP_STATUS
                       ,FRM_CITIZENSHIP_STATUS_DESCR
                       ,X_HISPANIC
                       ,X_AMERICAN_IND_ALASKA_NAT
                       ,X_ASIAN
                       ,X_BLACK_AFRICAN_AMERICAN
                       ,X_NAT_HAWAIIAN_OTH_PACIFIC
                       ,X_WHITE
                       ,X_RACE_COMBINED_CODE
                       ,X_RACE_COMBINED_DESCR
                       ,ACT_NATIONAL_ID
                       ,FRM_NATIONAL_ID
                       ,HIRE_DT
                       ,REHIRE_DT
                       ,LATEST_APPOINTMENT_DATE
                       ,ACT_NAME
                       ,ACT_NAME_INITIALS
                       ,ACT_NAME_PREFIX
                       ,ACT_NAME_SUFFIX
                       ,ACT_LAST_NAME
                       ,ACT_FIRST_NAME
                       ,ACT_MIDDLE_NAME
                       ,FRM_NAME
                       ,FRM_NAME_INITIALS
                       ,FRM_NAME_PREFIX
                       ,FRM_NAME_SUFFIX
                       ,FRM_LAST_NAME
                       ,FRM_FIRST_NAME
                       ,FRM_MIDDLE_NAME
                       ,ACT_SEX
                       ,ACT_BIRTHDATE
                       ,ACT_HIGHEST_EDUC_LVL
                       ,ACT_X_COMPUTED_OPTIONAL_RETIREMENT_DT_EXCL_FERS_MRA10
                       ,FRM_SEX
                       ,FRM_BIRTHDATE
                       ,ACT_HOME_ADDRESS1
                       ,ACT_HOME_ADDRESS2
                       ,ACT_HOME_ADDRESS3
                       ,ACT_HOME_ADDRESS4
                       ,ACT_HOME_CITY
                       ,ACT_HOME_STATE
                       ,ACT_HOME_POSTAL
                       ,ACT_HOME_COUNTRY
                       ,FRM_HOME_ADDRESS1
                       ,FRM_HOME_ADDRESS2
                       ,FRM_HOME_ADDRESS3
                       ,FRM_HOME_ADDRESS4
                       ,FRM_HOME_CITY
                       ,FRM_HOME_STATE
                       ,FRM_HOME_POSTAL
                       ,FRM_HOME_COUNTRY
                       ,ACT_GVT_DISABILITY_CD
                       ,ACT_GVT_DISABILITY_CD_DESCR
                       ,FRM_GVT_DISABILITY_CD
                       ,FRM_GVT_DISABILITY_CD_DESCR
                       ,ACT_GVT_VET_PREF_APPT
                       ,FRM_GVT_VET_PREF_APPT
                       ,ACT_GVT_VET_PREF_RIF
                       ,FRM_GVT_VET_PREF_RIF
                       ,ACT_MILITARY_STATUS
                       ,FRM_MILITARY_STATUS
                       ,ACT_GVT_DT_LEI
                       ,ACT_GVT_WGI_DUE_DATE
                       ,FRM_GVT_DT_LEI
                       ,FRM_GVT_WGI_DUE_DATE
                       ,ACT_SERVICE_DT
                       ,FRM_SERVICE_DT
                       ,ACT_GVT_NFC_PRBTN_STRT
                       ,ACT_PROBATION_DT
                       ,ACT_GVT_SES_PROB_DT
                       ,FRM_GVT_NFC_PRBTN_STRT
                       ,FRM_PROBATION_DT
                       ,FRM_GVT_SES_PROB_DT
                       ,ACT_GVT_SUPV_PROB_DT
                       ,ACT_GVT_NFC_SPMGREQ_CD
                       ,ACT_GVT_NFC_SUPMGST_DT
                       ,FRM_GVT_SUPV_PROB_DT
                       ,FRM_GVT_NFC_SPMGREQ_CD
                       ,FRM_GVT_NFC_SUPMGST_DT
                       ,ACT_EXPECTED_RETURN_DT
                       ,ACT_FURLOUGH_NTE
                       ,ACT_LWP_NTE
                       ,ACT_LWOP_NTE
                       ,ACT_SUSPENSION_NTE
                       ,ACT_CMPNY_SENIORITY_DT
                       ,ACT_TERMINATION_DT
                       ,ACT_LAST_DATE_WORKED
                       ,ACT_GVT_SCD_RETIRE
                       ,ACT_GVT_SCD_TSP
                       ,ACT_GVT_SCD_LEO
                       ,ACT_GVT_SCD_SEVPAY
                       ,ACT_GVT_NONPAY_HRS_WGI
                       ,ACT_GVT_NONPAY_HRS_SCD
                       ,ACT_GVT_NONPAY_NOA
                       ,ACT_GVT_WGI_STATUS
                       ,ACT_GVT_MAND_RET_DT
                       ,ACT_GVT_TEMP_PRO_EXPIR
                       ,ACT_GVT_TEMP_PSN_EXPIR
                       ,ACT_GVT_DETAIL_EXPIRES
                       ,ACT_GVT_SABBATIC_EXPIR
                       ,ACT_GVT_RTND_GRADE_BEG
                       ,ACT_GVT_RTND_GRADE_EXP
                       ,ACT_GVT_CURR_APT_AUTH1
                       ,ACT_GVT_CURR_APT_AUTH2
                       ,ACT_GVT_APPT_EXPIR_DT
                       ,ACT_GVT_CNV_BEGIN_DATE
                       ,ACT_GVT_CAREER_CNV_DUE
                       ,ACT_GVT_CAREER_COND_DT
                       ,ACT_GVT_APPT_LIMIT_HRS
                       ,ACT_GVT_APPT_LIMIT_DYS
                       ,ACT_GVT_APPT_LIMIT_AMT
                       ,ACT_GVT_COMP_AREA_PERM
                       ,ACT_GVT_COMP_LVL_PERM
                       ,ACT_APPOINT_END_DT
                       ,ACT_GVT_DETL_BARG_UNIT
                       ,ACT_GVT_DETL_UNION_CD
                       ,ACT_GVT_FIN_DISCLOSURE
                       ,ACT_GVT_FIN_DISCL_DATE
                       ,ACT_GVT_TENURE
                       ,FRM_GVT_TENURE
                       ,AWARD_OR_3R_AMOUNT
                       ,AWARD_OR_3R_HOURS
                       ,AWARD_GOAL_AMOUNT
                       ,AWARD_CLASS
                       ,AWARD_GEN_PAYMENT
                       ,AWARD_CHECK_MAIL_IND
                       ,AWARD_ACCT_CD
                       ,AWARD_CODE
                       ,AWARD_3R_PERCENT
                       ,AWARD_3R_EARNINGS_END_DT
                       ,GVT_OBLIG_EXPIR_DT
                       ,GVT_AWARD_GROUP
                       ,AWARD_3R_ERNCD
                       ,GVT_NFC_RELBON_AMT
                       ,GVT_NFC_RECBON_AMT
                       ,AWARD_3R_ERNCD_DESCR
                       ,ACT_OTHER_PAY
                       ,ACT_TOTAL_PAY
                       ,ACT_AUO_AMOUNT
                       ,ACT_AUO_PERCENTAGE
                       ,ACT_AUO_ERN_CD
                       ,ACT_AVAILABILITY_AMOUNT
                       ,ACT_AVAILABILITY_PERCENTAGE
                       ,ACT_AVAILABILITY_ERN_CD
                       ,ACT_SUPERVISORY_DIFF_AMOUNT
                       ,ACT_SUPERVISORY_DIFF_PERCENTAGE
                       ,ACT_SUPERVISORY_DIFF_ERN_CD
                       ,ACT_NFCOLA_AMOUNT
                       ,ACT_NFCOLA_ERN_CD
                       ,FRM_OTHER_PAY
                       ,FRM_TOTAL_PAY
                       ,FRM_AUO_AMOUNT
                       ,FRM_AUO_PERCENTAGE
                       ,FRM_AUO_ERN_CD
                       ,FRM_AVAILABILITY_AMOUNT
                       ,FRM_AVAILABILITY_PERCENTAGE
                       ,FRM_AVAILABILITY_ERN_CD
                       ,FRM_SUPERVISORY_DIFF_AMOUNT
                       ,FRM_SUPERVISORY_DIFF_PERCENTAGE
                       ,FRM_SUPERVISORY_DIFF_ERN_CD
                       ,FRM_NFCOLA_AMOUNT
                       ,FRM_NFCOLA_ERN_CD            
                       ,ACT_HIGHEST_EDUC_LVL_DESCR
                       ,ACT_SEX_DESCR
                       ,FRM_SEX_DESCR
                       ,ACT_MILITARY_STATUS_DESCR
                       ,FRM_MILITARY_STATUS_DESCR
                       ,ACT_GVT_NFC_SPMGREQ_CD_DESCR
                       ,FRM_GVT_NFC_SPMGREQ_CD_DESCR
                       ,ACT_GVT_TENURE_DESCR
                       ,FRM_GVT_TENURE_DESCR
                       ,ACT_GVT_WGI_STATUS_DESCR
                       ,FRM_GVT_WGI_STATUS_DESCR
                       ,ACT_GVT_VET_PREF_APPT_DESCR
                       ,FRM_GVT_VET_PREF_APPT_DESCR
                       ,DT_ISSUED           
                       ,YR_ACQUIRED         
                       ,MAJOR_CODE          
                       ,MAJOR               
                       ,EDUCATION_LVL       
                       ,ACCOMPLISHMENT      
                       ,ACCOMPLISHMENT_DESCR
                       ,GVT_CREDIT_HOURS        
                       ,GVT_CRED_HRS_TYPE       
                       ,GPA                 
                       ,SCHOOL_CODE             
                       ,SCHOOL              
                       ,APS_MINOR_CODE_AUS  
                       ,APS_MINOR_AUS  
                       ,EDUCATION_LVL_DESCR       
		                   ,ACT_GVT_CURR_APT_AUTH1_DESCR
		                   ,ACT_GVT_CURR_APT_AUTH2_DESCR   
                       )
                      select
                       SF50.SF50_TRANSACTION_CONTROL_ID          SF50_TRANSACTION_CONTROL_ID     
                      ,sf50.EMPLID                               EMPLID                          
                      ,sf50.EMPL_RCD                             EMPL_RCD                        
                      ,sf50.EFFDT                                EFFDT                           
                      ,sf50.EFFSEQ                               EFFSEQ                          
                      ,protr.GVT_DATE_WRK                        PRO_GVT_DATE_WRK      
                      ,protr.OPRID                               PRO_OPRID             
                      ,protr.GVT_OPRID_OVERRIDE                  PRO_GVT_OPRID_OVERRIDE
                      ,protr.GVT_TRK_EMPLID                      PRO_GVT_TRK_EMPLID    
                      ,protr.GVT_TRK_EMPL_RCD                    PRO_GVT_TRK_EMPL_RCD  
                      ,protr.GVT_EE_TRK_DT                       PRO_GVT_EE_TRK_DT     
                      ,protr.GVT_NFC_AUTHCTN_DT                  PRO_GVT_NFC_AUTHCTN_DT
                      ,initr.GVT_DATE_WRK                        INI_GVT_DATE_WRK                   
                      ,initr.OPRID                               INI_OPRID                                 
                      ,initr.GVT_OPRID_OVERRIDE                  INI_GVT_OPRID_OVERRIDE                    
                      ,initr.GVT_TRK_EMPLID                      INI_GVT_TRK_EMPLID                        
                      ,initr.GVT_TRK_EMPL_RCD                    INI_GVT_TRK_EMPL_RCD                      
                      ,initr.GVT_EE_TRK_DT                       INI_GVT_EE_TRK_DT                         
                      ,initr.GVT_NFC_AUTHCTN_DT                  INI_GVT_NFC_AUTHCTN_DT                    
                      ,reqtr.GVT_DATE_WRK                        REQ_GVT_DATE_WRK                          
                      ,reqtr.OPRID                               REQ_OPRID                                 
                      ,reqtr.GVT_OPRID_OVERRIDE                  REQ_GVT_OPRID_OVERRIDE                    
                      ,reqtr.GVT_TRK_EMPLID                      REQ_GVT_TRK_EMPLID                        
                      ,reqtr.GVT_TRK_EMPL_RCD                    REQ_GVT_TRK_EMPL_RCD                      
                      ,reqtr.GVT_EE_TRK_DT                       REQ_GVT_EE_TRK_DT                         
                      ,reqtr.GVT_NFC_AUTHCTN_DT                  REQ_GVT_NFC_AUTHCTN_DT          
                      ,tocit.COUNTRY                             ACT_CITIZENSHIP_COUNTRY
                      ,tocit.CITIZENSHIP_STATUS                  ACT_CITIZENSHIP_STATUS
                      ,tocis.DESCR                               ACT_CITIZENSHIP_STATUS_DESCR
                      ,frcit.COUNTRY                             FRM_CITIZENSHIP_COUNTRY
                      ,frcit.CITIZENSHIP_STATUS                  FRM_CITIZENSHIP_STATUS
                      ,frcis.DESCR                               FRM_CITIZENSHIP_STATUS_DESCR
                      ,ethn.X_HISPANIC	         		             X_HISPANIC	         		     
                      ,ethn.X_AMERICAN_IND_ALASKA_NAT	           X_AMERICAN_IND_ALASKA_NAT	  
                      ,ethn.X_ASIAN	         		                 X_ASIAN	         		        
                      ,ethn.X_BLACK_AFRICAN_AMERICAN	           X_BLACK_AFRICAN_AMERICAN	  
                      ,ethn.X_NAT_HAWAIIAN_OTH_PACIFIC	         X_NAT_HAWAIIAN_OTH_PACIFIC	
                      ,ethn.X_WHITE	         		                 X_WHITE	         		        
                      ,ethn.X_RACE_COMBINED_CODE	               X_RACE_COMBINED_CODE	      
                      ,ethn.X_RACE_COMBINED_DESCR      		       X_RACE_COMBINED_DESCR      
                      ,TONID.NATIONAL_ID                        ACT_NATIONAL_ID 
                      ,FRNID.NATIONAL_ID                        FRM_NATIONAL_ID
                      ,TOEMP.HIRE_DT
                      ,TOEMP.REHIRE_DT
                      ,COALESCE(TOEMP.HIRE_DT,TOEMP.REHIRE_DT)  LATEST_APPOINTMENT_DATE 
                      ,TOPER.NAME                               ACT_NAME
                      ,TOPER.NAME_INITIALS                      ACT_NAME_INITIALS
                      ,TOPER.NAME_PREFIX                        ACT_NAME_PREFIX
                      ,TOPER.NAME_SUFFIX                        ACT_NAME_SUFFIX
                      ,TOPER.LAST_NAME                          ACT_LAST_NAME
                      ,TOPER.FIRST_NAME                         ACT_FIRST_NAME
                      ,TOPER.MIDDLE_NAME                        ACT_MIDDLE_NAME
                      ,FRPER.NAME                               FRM_NAME
                      ,FRPER.NAME_INITIALS                      FRM_NAME_INITIALS
                      ,FRPER.NAME_PREFIX                        FRM_NAME_PREFIX
                      ,FRPER.NAME_SUFFIX                        FRM_NAME_SUFFIX
                      ,FRPER.LAST_NAME                          FRM_LAST_NAME
                      ,FRPER.FIRST_NAME                         FRM_FIRST_NAME
                      ,FRPER.MIDDLE_NAME                        FRM_MIDDLE_NAME
                      ,TOPER.SEX                                ACT_SEX
                      ,TOPER.BIRTHDATE                          ACT_BIRTHDATE
                      ,TOPER.HIGHEST_EDUC_LVL                   ACT_HIGHEST_EDUC_LVL
                      ,nhrdw_calc_opt_retr_dt_x_fersmra10(SF50.ACT_GVT_RETIRE_PLAN,TOPER.BIRTHDATE,SF50POS.ACT_GVT_OCC_SERIES,TOEMP.GVT_SCD_RETIRE,null) ACT_X_COMPUTED_OPTIONAL_RETIREMENT_DT_EXCL_FERS_MRA10
                      ,FRPER.SEX                                FRM_SEX
                      ,FRPER.BIRTHDATE                          FRM_BIRTHDATE
                      ,TOPER.ADDRESS1                            ACT_HOME_ADDRESS1
                      ,TOPER.ADDRESS2                            ACT_HOME_ADDRESS2
                      ,TOPER.ADDRESS3                            ACT_HOME_ADDRESS3
                      ,TOPER.ADDRESS4                            ACT_HOME_ADDRESS4
                      ,TOPER.CITY                                ACT_HOME_CITY    
                      ,TOPER.STATE                               ACT_HOME_STATE   
                      ,TOPER.POSTAL                              ACT_HOME_POSTAL  
                      ,TOPER.COUNTRY                             ACT_HOME_COUNTRY 
                      ,FRPER.ADDRESS1                            FRM_HOME_ADDRESS1
                      ,FRPER.ADDRESS2                            FRM_HOME_ADDRESS2
                      ,FRPER.ADDRESS3                            FRM_HOME_ADDRESS3
                      ,FRPER.ADDRESS4                            FRM_HOME_ADDRESS4
                      ,FRPER.CITY                                FRM_HOME_CITY    
                      ,FRPER.STATE                               FRM_HOME_STATE   
                      ,FRPER.POSTAL                              FRM_HOME_POSTAL  
                      ,FRPER.COUNTRY                             FRM_HOME_COUNTRY 
                      ,TOPER.GVT_DISABILITY_CD                   ACT_GVT_DISABILITY_CD
                      ,TOHDC.DESCR                               ACT_GVT_DISABILITY_CD_DESCR
                      ,FRPER.GVT_DISABILITY_CD                   FRM_GVT_DISABILITY_CD
                      ,FRHDC.DESCR                               FRM_GVT_DISABILITY_CD_DESCR
                      ,TOPER.GVT_VET_PREF_APPT                   ACT_GVT_VET_PREF_APPT
                      ,FRPER.GVT_VET_PREF_APPT                   FRM_GVT_VET_PREF_APPT     
                      ,TOPER.GVT_VET_PREF_RIF                    ACT_GVT_VET_PREF_RIF
                      ,FRPER.GVT_VET_PREF_RIF                    FRM_GVT_VET_PREF_RIF                      
                      ,TOPER.MILITARY_STATUS                     ACT_MILITARY_STATUS  
                      ,FRPER.MILITARY_STATUS                     FRM_MILITARY_STATUS  
                      ,TOEMP.GVT_DT_LEI                          ACT_GVT_DT_LEI      
                      ,TOEMP.GVT_WGI_DUE_DATE                    ACT_GVT_WGI_DUE_DATE
                      ,FREMP.GVT_DT_LEI                          FRM_GVT_DT_LEI       
                      ,FREMP.GVT_WGI_DUE_DATE                    FRM_GVT_WGI_DUE_DATE 
                      ,TOEMP.SERVICE_DT                          ACT_SERVICE_DT 
                      ,FREMP.SERVICE_DT                          FRM_SERVICE_DT  
                      ,TOEMP.GVT_NFC_PRBTN_STRT                  ACT_GVT_NFC_PRBTN_STRT 
                      ,TOEMP.PROBATION_DT                        ACT_PROBATION_DT       
                      ,TOEMP.GVT_SES_PROB_DT                     ACT_GVT_SES_PROB_DT    
                      ,FREMP.GVT_NFC_PRBTN_STRT                  FRM_GVT_NFC_PRBTN_STRT 
                      ,FREMP.PROBATION_DT                        FRM_PROBATION_DT       
                      ,FREMP.GVT_SES_PROB_DT                     FRM_GVT_SES_PROB_DT      
                      ,TOEMP.GVT_SUPV_PROB_DT                    ACT_GVT_SUPV_PROB_DT        
                      ,TOEMP.GVT_NFC_SPMGREQ_CD                  ACT_GVT_NFC_SPMGREQ_CD      
                      ,TOEMP.GVT_NFC_SUPMGST_DT                  ACT_GVT_NFC_SUPMGST_DT      
                      ,FREMP.GVT_SUPV_PROB_DT                    FRM_GVT_SUPV_PROB_DT        
                      ,FREMP.GVT_NFC_SPMGREQ_CD                  FRM_GVT_NFC_SPMGREQ_CD      
                      ,FREMP.GVT_NFC_SUPMGST_DT                  FRM_GVT_NFC_SUPMGST_DT    
                      ,TOEMP.EXPECTED_RETURN_DT                  ACT_EXPECTED_RETURN_DT   
                      ,CASE WHEN TOEMP.GVT_NONPAY_NOA IN ('472','772') THEN  TOEMP.EXPECTED_RETURN_DT  ELSE NULL END    ACT_FURLOUGH_NTE             
                      ,CASE WHEN TOEMP.GVT_NONPAY_NOA IN ('462')       THEN  TOEMP.EXPECTED_RETURN_DT  ELSE NULL END    ACT_LWP_NTE                  
                      ,CASE WHEN TOEMP.GVT_NONPAY_NOA IN ('460','773') THEN  TOEMP.EXPECTED_RETURN_DT  ELSE NULL END    ACT_LWOP_NTE                 
                      ,CASE WHEN TOEMP.GVT_NONPAY_NOA IN ('450')       THEN  TOEMP.EXPECTED_RETURN_DT  ELSE NULL END    ACT_SUSPENSION_NTE           
                      ,TOEMP.CMPNY_SENIORITY_DT                  ACT_CMPNY_SENIORITY_DT     
                      ,TOEMP.TERMINATION_DT                      ACT_TERMINATION_DT         
                      ,TOEMP.LAST_DATE_WORKED                    ACT_LAST_DATE_WORKED       
                      ,TOEMP.GVT_SCD_RETIRE                      ACT_GVT_SCD_RETIRE         
                      ,TOEMP.GVT_SCD_TSP                         ACT_GVT_SCD_TSP            
                      ,TOEMP.GVT_SCD_LEO                         ACT_GVT_SCD_LEO            
                      ,TOEMP.GVT_SCD_SEVPAY                      ACT_GVT_SCD_SEVPAY         
                      ,TOEMP.GVT_NONPAY_HRS_WGI                  ACT_GVT_NONPAY_HRS_WGI     
                      ,TOEMP.GVT_NONPAY_HRS_SCD                  ACT_GVT_NONPAY_HRS_SCD     
                      ,TOEMP.GVT_NONPAY_NOA                      ACT_GVT_NONPAY_NOA         
                      ,TOEMP.GVT_WGI_STATUS                      ACT_GVT_WGI_STATUS         
                      ,TOEMP.GVT_MAND_RET_DT                     ACT_GVT_MAND_RET_DT        
                      ,TOEMP.GVT_TEMP_PRO_EXPIR                  ACT_GVT_TEMP_PRO_EXPIR     
                      ,TOEMP.GVT_TEMP_PSN_EXPIR                  ACT_GVT_TEMP_PSN_EXPIR     
                      ,TOEMP.GVT_DETAIL_EXPIRES                  ACT_GVT_DETAIL_EXPIRES     
                      ,TOEMP.GVT_SABBATIC_EXPIR                  ACT_GVT_SABBATIC_EXPIR     
                      ,TOEMP.GVT_RTND_GRADE_BEG                  ACT_GVT_RTND_GRADE_BEG     
                      ,TOEMP.GVT_RTND_GRADE_EXP                  ACT_GVT_RTND_GRADE_EXP     
                      ,TOEMP.GVT_CURR_APT_AUTH1                  ACT_GVT_CURR_APT_AUTH1     
                      ,TOEMP.GVT_CURR_APT_AUTH2                  ACT_GVT_CURR_APT_AUTH2     
                      ,TOEMP.GVT_APPT_EXPIR_DT                   ACT_GVT_APPT_EXPIR_DT      
                      ,TOEMP.GVT_CNV_BEGIN_DATE                  ACT_GVT_CNV_BEGIN_DATE     
                      ,TOEMP.GVT_CAREER_CNV_DUE                  ACT_GVT_CAREER_CNV_DUE     
                      ,TOEMP.GVT_CAREER_COND_DT                  ACT_GVT_CAREER_COND_DT     
                      ,TOEMP.GVT_APPT_LIMIT_HRS                  ACT_GVT_APPT_LIMIT_HRS     
                      ,TOEMP.GVT_APPT_LIMIT_DYS                  ACT_GVT_APPT_LIMIT_DYS     
                      ,TOEMP.GVT_APPT_LIMIT_AMT                  ACT_GVT_APPT_LIMIT_AMT     
                      ,TOEMP.GVT_COMP_AREA_PERM                  ACT_GVT_COMP_AREA_PERM     
                      ,TOEMP.GVT_COMP_LVL_PERM                   ACT_GVT_COMP_LVL_PERM      
                      ,TOEMP.APPOINT_END_DT                      ACT_APPOINT_END_DT         
                      ,TOEMP.GVT_DETL_BARG_UNIT                  ACT_GVT_DETL_BARG_UNIT     
                      ,TOEMP.GVT_DETL_UNION_CD                   ACT_GVT_DETL_UNION_CD      
                      ,TOEMP.GVT_FIN_DISCLOSURE                  ACT_GVT_FIN_DISCLOSURE     
                      ,TOEMP.GVT_FIN_DISCL_DATE                  ACT_GVT_FIN_DISCL_DATE                                                  	
                      ,TOEMP.GVT_TENURE                          ACT_GVT_TENURE
                      ,FREMP.GVT_TENURE                          FRM_GVT_TENURE  
                      ,TOAWD.OTH_PAY                             AWARD_OR_3R_AMOUNT
                      ,TOAWD.OTH_HRS                             AWARD_OR_3R_HOURS
                      ,TOAWD.GOAL_AMT                            AWARD_GOAL_AMOUNT
                      ,TOAWD.GVT_AWD_CLASS                       AWARD_CLASS
                      ,TOAWD.GVT_GENERT_PAYMENT                  AWARD_GEN_PAYMENT
                      ,TOAWD.GVT_CHK_MAILAD_IND                  AWARD_CHECK_MAIL_IND
                      ,TOAWD.Z_ACCT_CD                           AWARD_ACCT_CD
                      ,TOAWD.GVT_AWD_CODE                        AWARD_CODE
                      ,TOAWD.PERCENT_OF_AWARD                    AWARD_3R_PERCENT
                      ,TOAWD.EARNINGS_END_DT                     AWARD_3R_EARNINGS_END_DT 
                      ,TOAWD.GVT_OBLIG_EXPIR_DT                  GVT_OBLIG_EXPIR_DT
                      ,TOAWD.GVT_AWARD_GROUP                     GVT_AWARD_GROUP
                      ,TOAWD.ERNCD                               AWARD_3R_ERNCD 
                      ,TOAWD.GVT_NFC_RELBON_AMT                  GVT_NFC_RELBON_AMT
                      ,TOAWD.GVT_NFC_RECBON_AMT                  GVT_NFC_RECBON_AMT
                      ,ERNTB.DESCR                               AWARD_3R_ERNCD_DESCR
                      , CASE WHEN substr( TOAUO.ERNCD,1,1) = 'A' OR TOAVL.ERNCD = 'AVL' OR TOSD.ERNCD = 'SD' THEN ((SF50.ACT_GVT_COMPRATE + SF50.ACT_GVT_LOCALITY_ADJ) * IFNULL(substr( TOAUO.ERNCD,2,2),0)/100) + round(((SF50.ACT_GVT_COMPRATE + SF50.ACT_GVT_LOCALITY_ADJ) * CASE WHEN TOAVL.ERNCD = 'AVL' THEN 0.25 ELSE 0 END)) + round((round(IFNULL(TOSD.AMOUNT,0), 2) *  CASE WHEN TOSD.ERNCD = 'SD' THEN 26 ELSE 0 END)) 
                      	   ELSE 0 END ACT_OTHER_PAY
                      , round(SF50.ACT_GVT_COMPRATE + SF50.ACT_GVT_LOCALITY_ADJ, 2) + CASE WHEN substr( TOAUO.ERNCD,1,1) = 'A' OR TOAVL.ERNCD = 'AVL' OR TOSD.ERNCD = 'SD' THEN ((SF50.ACT_GVT_COMPRATE + SF50.ACT_GVT_LOCALITY_ADJ) * IFNULL(substr( TOAUO.ERNCD,2,2),0)/100) + round(((SF50.ACT_GVT_COMPRATE + SF50.ACT_GVT_LOCALITY_ADJ) * CASE WHEN TOAVL.ERNCD = 'AVL' THEN 0.25 ELSE 0 END)) + round((round(IFNULL(TOSD.AMOUNT,0), 2) *  CASE WHEN TOSD.ERNCD = 'SD' THEN 26 ELSE 0 END)) 
                      	   ELSE 0 END ACT_TOTAL_PAY
                      , CASE WHEN substr( TOAUO.ERNCD,1,1) = 'A' THEN (SF50.ACT_GVT_COMPRATE + SF50.ACT_GVT_LOCALITY_ADJ) * substr( TOAUO.ERNCD,2,2)/100  ELSE TOAUO.ERNCD END ACT_AUO_AMOUNT
                      , CASE WHEN substr( TOAUO.ERNCD,1,1) = 'A' THEN substr( TOAUO.ERNCD,2,2)|| '%' ELSE TOAUO.ERNCD END ACT_AUO_PERCENTAGE    
                      , TOAUO.ERNCD ACT_AUO_ERN_CD
                      , round(TOAVL.GVT_QUOTE_AMT, 2) ACT_AVAILABILITY_AMOUNT
                      , CASE WHEN TOAVL.ERNCD = 'AVL' THEN '25%' ELSE TOAVL.ERNCD END ACT_AVAILABILITY_PERCENTAGE
                      , TOAVL.ERNCD ACT_AVAILABILITY_ERN_CD
                      , round(TOSD.GVT_QUOTE_AMT, 2) ACT_SUPERVISORY_DIFF_AMOUNT
                      , CASE WHEN TOSD.ERNCD = 'SD' THEN '100%' ELSE TOSD.ERNCD END ACT_SUPERVISORY_DIFF_PERCENTAGE
                      , TOSD.ERNCD ACT_SUPERVISORY_DIFF_ERN_CD
                      , round(TOCOL.GVT_QUOTE_AMT, 2) ACT_NFCOLA_AMOUNT
                      , TOCOL.ERNCD ACT_NFCOLA_ERN_CD
                      , CASE WHEN substr( FRAUO.ERNCD,1,1) = 'A' OR FRAVL.ERNCD = 'AVL' OR FRSD.ERNCD = 'SD' THEN ((SF50.FRM_GVT_COMPRATE + SF50.FRM_GVT_LOCALITY_ADJ) * IFNULL(substr( FRAUO.ERNCD,2,2),0)/100) + round(((SF50.FRM_GVT_COMPRATE + SF50.FRM_GVT_LOCALITY_ADJ) * CASE WHEN FRAVL.ERNCD = 'AVL' THEN 0.25 ELSE 0 END)) + round((round(IFNULL(FRSD.AMOUNT,0), 2) *  CASE WHEN FRSD.ERNCD = 'SD' THEN 26 ELSE 0 END)) 
                      	   ELSE 0 END FRM_OTHER_PAY
                      , round(SF50.FRM_GVT_COMPRATE + SF50.FRM_GVT_LOCALITY_ADJ, 2) + CASE WHEN substr( FRAUO.ERNCD,1,1) = 'A' OR FRAVL.ERNCD = 'AVL' OR FRSD.ERNCD = 'SD' THEN ((SF50.FRM_GVT_COMPRATE + SF50.FRM_GVT_LOCALITY_ADJ) * IFNULL(substr( FRAUO.ERNCD,2,2),0)/100) + round(((SF50.FRM_GVT_COMPRATE + SF50.FRM_GVT_LOCALITY_ADJ) * CASE WHEN FRAVL.ERNCD = 'AVL' THEN 0.25 ELSE 0 END)) + round((round(IFNULL(FRSD.AMOUNT,0), 2) *  CASE WHEN FRSD.ERNCD = 'SD' THEN 26 ELSE 0 END)) 
                      	   ELSE 0 END FRM_TOTAL_PAY
                      , CASE WHEN substr( FRAUO.ERNCD,1,1) = 'A' THEN (SF50.FRM_GVT_COMPRATE + SF50.FRM_GVT_LOCALITY_ADJ) * substr( FRAUO.ERNCD,2,2)/100  ELSE FRAUO.ERNCD END FRM_AUO_AMOUNT
                      , CASE WHEN substr( FRAUO.ERNCD,1,1) = 'A' THEN substr( FRAUO.ERNCD,2,2)|| '%' ELSE FRAUO.ERNCD END FRM_AUO_PERCENTAGE    
                      , FRAUO.ERNCD FRM_AUO_ERN_CD
                      , round(FRAVL.GVT_QUOTE_AMT, 2) FRM_AVAILABILITY_AMOUNT
                      , CASE WHEN FRAVL.ERNCD = 'AVL' THEN '25%' ELSE FRAVL.ERNCD END FRM_AVAILABILITY_PERCENTAGE
                      , FRAVL.ERNCD FRM_AVAILABILITY_ERN_CD
                      , round(FRSD.GVT_QUOTE_AMT, 2) FRM_SUPERVISORY_DIFF_AMOUNT
                      , CASE WHEN FRSD.ERNCD = 'SD' THEN '100%' ELSE FRSD.ERNCD END FRM_SUPERVISORY_DIFF_PERCENTAGE
                      , FRSD.ERNCD FRM_SUPERVISORY_DIFF_ERN_CD
                      , round(FRCOL.GVT_QUOTE_AMT, 2) FRM_NFCOLA_AMOUNT
                      , FRCOL.ERNCD FRM_NFCOLA_ERN_CD
                      ,toedu.XLATLONGNAME                        ACT_HIGHEST_EDUC_LVL_DESCR                                 
                      ,tosex.XLATLONGNAME                        ACT_SEX_DESCR                      
                      ,frsex.XLATLONGNAME                        FRM_SEX_DESCR                                              
                      ,tomil.XLATLONGNAME                        ACT_MILITARY_STATUS_DESCR          
                      ,frmil.XLATLONGNAME                        FRM_MILITARY_STATUS_DESCR                                  
                      ,tospm.XLATLONGNAME                        ACT_GVT_NFC_SPMGREQ_CD_DESCR       
                      ,frspm.XLATLONGNAME                        FRM_GVT_NFC_SPMGREQ_CD_DESCR                               
                      ,toten.XLATLONGNAME                        ACT_GVT_TENURE_DESCR               
                      ,frten.XLATLONGNAME                        FRM_GVT_TENURE_DESCR                                       
                      ,towgi.XLATLONGNAME                        ACT_GVT_WGI_STATUS_DESCR           
                      ,frwgi.XLATLONGNAME                        FRM_GVT_WGI_STATUS_DESCR                                                                     
                      ,tovpr.SHORT_DESC                          ACT_GVT_VET_PREF_APPT_DESCR        
                      ,frvpr.SHORT_DESC                          FRM_GVT_VET_PREF_APPT_DESCR                                  
                      ,educ.DT_ISSUED                            DT_ISSUED              
                      ,educ.YR_ACQUIRED                          YR_ACQUIRED            
                      ,educ.MAJOR_CODE                           MAJOR_CODE             
                      ,educ.MAJOR                                MAJOR                  
                      ,educ.EDUCATION_LVL                        EDUCATION_LVL          
                      ,educ.ACCOMPLISHMENT                       ACCOMPLISHMENT         
                      ,educ.ACCOMPLISHMENT_DESCR                 ACCOMPLISHMENT_DESCR   
                      ,educ.GVT_CREDIT_HOURS                     GVT_CREDIT_HOURS       
                      ,educ.GVT_CRED_HRS_TYPE                    GVT_CRED_HRS_TYPE      
                      ,educ.GPA                                  GPA                    
                      ,educ.SCHOOL_CODE                          SCHOOL_CODE            
                      ,educ.SCHOOL                               SCHOOL                 
                      ,educ.APS_MINOR_CODE_AUS                   APS_MINOR_CODE_AUS     
                      ,educ.APS_MINOR_AUS                        APS_MINOR_AUS 
                      ,pseduc.XLATLONGNAME 	                     EDUCATION_LVL_DESCR                     
	                    ,CONCAT(LAC1.DESCR25, LAC1.DESCR25_2)  
	                    ,CONCAT(LAC2.DESCR25, LAC2.DESCR25_2)  
                      from            NHRDW_PERSONNEL_ACTION sf50
                      join            NHRDW_PERSONNEL_ACTION_POSITION_INFO sf50pos on sf50pos.SF50_TRANSACTION_CONTROL_ID = sf50.SF50_TRANSACTION_CONTROL_ID
                      join            PS_GVT_PERS_NID     tonid  on tonid.emplid   = sf50.emplid and tonid.empl_rcd = sf50.empl_rcd  and tonid.effdt = sf50.effdt and tonid.effseq = sf50.effseq
                      left outer join PS_GVT_PERS_NID     frnid  on frnid.emplid = sf50.emplid and frnid.empl_rcd = sf50.empl_rcd  and frnid.effdt = sf50.act_pr_effdt and frnid.effseq = sf50.act_pr_effseq   
                      join            PS_GVT_PERS_DATA    toper  on toper.emplid   = sf50.emplid and toper.empl_rcd = sf50.empl_rcd  and toper.effdt = sf50.effdt and toper.effseq = sf50.effseq
                      left outer join PS_GVT_PERS_DATA    frper  on frper.emplid = sf50.emplid and frper.empl_rcd = sf50.empl_rcd  and frper.effdt = sf50.act_pr_effdt and frper.effseq = sf50.act_pr_effseq   
                      join            PS_GVT_EMPLOYMENT   toemp  on toemp.emplid   = sf50.emplid and toemp.empl_rcd = sf50.empl_rcd  and toemp.effdt = sf50.effdt and toemp.effseq = sf50.effseq
                      left outer join PS_GVT_EMPLOYMENT   fremp  on fremp.emplid = sf50.emplid and fremp.empl_rcd = sf50.empl_rcd  and fremp.effdt = sf50.act_pr_effdt and fremp.effseq = sf50.act_pr_effseq   
                      left outer join PS_GVT_CITIZENSHIP  tocit  on tocit.emplid = sf50.emplid and tocit.empl_rcd = sf50.empl_rcd  and tocit.effdt = sf50.effdt and tocit.effseq = sf50.effseq
                      left outer join PS_GVT_CITIZENSHIP  frcit  on frcit.emplid = sf50.emplid and frcit.empl_rcd = sf50.empl_rcd  and frcit.effdt = sf50.act_pr_effdt and frcit.effseq = sf50.act_pr_effseq   
                      left outer join PS_CITIZEN_STS_TBL  tocis  on tocis.COUNTRY = tocit.COUNTRY and tocis.CITIZENSHIP_STATUS = tocit.CITIZENSHIP_STATUS   
                      left outer join PS_CITIZEN_STS_TBL  frcis  on frcis.COUNTRY = frcit.COUNTRY and frcis.CITIZENSHIP_STATUS = frcit.CITIZENSHIP_STATUS   
                      left outer join NHRDW_DIVERS_ETHNIC ethn   on ethn.emplid = sf50.emplid 
                      LEFT OUTER JOIN  ps_gvt_handicp_tbl tohdc  ON  tohdc.GVT_DISABILITY_CD = TOPER.GVT_DISABILITY_CD
                                                                    AND tohdc.EFFDT =
                                                                       (SELECT MAX(tohdc_ED.EFFDT) FROM ps_gvt_handicp_tbl tohdc_ED
                                                                        WHERE tohdc_ED.GVT_DISABILITY_CD = TOPER.GVT_DISABILITY_CD
                                                                          AND tohdc_ED.EFFDT <= TOPER.effdt)
                      LEFT OUTER JOIN  ps_gvt_handicp_tbl frhdc  ON  frhdc.GVT_DISABILITY_CD = FRPER.GVT_DISABILITY_CD
                                                                    AND frhdc.EFFDT =
                                                                       (SELECT MAX(frhdc_ED.EFFDT) FROM ps_gvt_handicp_tbl frhdc_ED
                                                                        WHERE frhdc_ED.GVT_DISABILITY_CD = FRPER.GVT_DISABILITY_CD
                                                                          AND frhdc_ED.EFFDT <= FRPER.effdt)
                      left outer join PS_GVT_AWD_DATA     toawd  on toawd.emplid   = sf50.emplid and toawd.empl_rcd = sf50.empl_rcd  and toawd.effdt = sf50.effdt and toawd.effseq = sf50.effseq  -- and toawd.erncd ='AWD'
                      left outer join PS_EARNINGS_TBL     erntb  on erntb.ERNCD    = TOAWD.ERNCD AND erntb.EFFDT =  (SELECT MAX(erntb_ed.EFFDT) FROM PS_EARNINGS_TBL erntb_ed
                                                                                                                        WHERE erntb_ed.ERNCD  = TOAWD.ERNCD
                                                                                                                         AND erntb_ed.EFFDT <= SF50.EFFDT )  
                      LEFT OUTER JOIN  PS_GVT_JOBERNS TOAVL ON  sf50.EMPLID = TOAVL.EMPLID AND sf50.EMPL_RCD = TOAVL.EMPL_RCD AND sf50.EFFDT = TOAVL.EFFDT AND sf50.EFFSEQ = TOAVL.EFFSEQ AND TOAVL.ERNCD = 'AVL'
                      LEFT OUTER JOIN  PS_GVT_JOBERNS TOCOL ON  sf50.EMPLID = TOCOL.EMPLID AND sf50.EMPL_RCD = TOCOL.EMPL_RCD AND sf50.EFFDT = TOCOL.EFFDT AND sf50.EFFSEQ = TOCOL.EFFSEQ AND TOCOL.ERNCD = 'COL'
                      LEFT OUTER JOIN  PS_GVT_JOBERNS TOAUO ON  sf50.EMPLID = TOAUO.EMPLID AND sf50.EMPL_RCD = TOAUO.EMPL_RCD AND sf50.EFFDT = TOAUO.EFFDT AND sf50.EFFSEQ = TOAUO.EFFSEQ AND TOAUO.ERNCD in ('A10', 'A15', 'A20', 'A25')      
                      LEFT OUTER JOIN  PS_GVT_JOBERNS TOSD  ON  sf50.EMPLID = TOSD.EMPLID  AND sf50.EMPL_RCD = TOSD.EMPL_RCD  AND sf50.EFFDT = TOSD.EFFDT  AND sf50.EFFSEQ = TOSD.EFFSEQ  AND TOSD.ERNCD = 'SD' 
                      LEFT OUTER JOIN  PS_GVT_JOBERNS FRAVL ON  sf50.EMPLID = FRAVL.EMPLID AND sf50.EMPL_RCD = FRAVL.EMPL_RCD AND sf50.ACT_PR_EFFDT = FRAVL.EFFDT AND sf50.ACT_PR_EFFSEQ = FRAVL.EFFSEQ AND FRAVL.ERNCD = 'AVL'
                      LEFT OUTER JOIN  PS_GVT_JOBERNS FRCOL ON  sf50.EMPLID = FRCOL.EMPLID AND sf50.EMPL_RCD = FRCOL.EMPL_RCD AND sf50.ACT_PR_EFFDT = FRCOL.EFFDT AND sf50.ACT_PR_EFFSEQ = FRCOL.EFFSEQ AND FRCOL.ERNCD = 'COL'
                      LEFT OUTER JOIN  PS_GVT_JOBERNS FRAUO ON  sf50.EMPLID = FRAUO.EMPLID AND sf50.EMPL_RCD = FRAUO.EMPL_RCD AND sf50.ACT_PR_EFFDT = FRAUO.EFFDT AND sf50.ACT_PR_EFFSEQ = FRAUO.EFFSEQ AND FRAUO.ERNCD in ('A10', 'A15', 'A20', 'A25')      
                      LEFT OUTER JOIN  PS_GVT_JOBERNS FRSD  ON  sf50.EMPLID = FRSD.EMPLID  AND sf50.EMPL_RCD = FRSD.EMPL_RCD  AND sf50.ACT_PR_EFFDT = FRSD.EFFDT  AND sf50.ACT_PR_EFFSEQ = FRSD.EFFSEQ  AND FRSD.ERNCD = 'SD'                                                                                                                                                                 
                      left outer join PS_GVT_EE_DATA_TRK protr ON  protr.emplid   = sf50.emplid and protr.empl_rcd = sf50.empl_rcd  and protr.effdt = sf50.effdt and protr.effseq = sf50.effseq and protr.GVT_WIP_STATUS in ('PRO','COR')
                                                               and protr.gvt_trk_sequence = (select max(protr_es.gvt_trk_sequence) from PS_GVT_EE_DATA_TRK protr_es 
                                                                                             where protr_es.emplid = sf50.emplid 
                                                                                               and protr_es.empl_rcd = sf50.empl_rcd 
                                                                                               and protr_es.effdt = sf50.effdt 
                                                                                               and protr_es.effseq = sf50.effseq 
                                                                                               and protr_es.GVT_WIP_STATUS in ('PRO','COR')
                                                                                              ) 
                      left outer join PS_GVT_EE_DATA_TRK initr ON  initr.emplid   = sf50.emplid and initr.empl_rcd = sf50.empl_rcd  and initr.effdt = sf50.effdt and initr.effseq = sf50.effseq and initr.GVT_WIP_STATUS in ('INI')
                                                               and initr.gvt_trk_sequence = (select max(initr_es.gvt_trk_sequence) from PS_GVT_EE_DATA_TRK initr_es 
                                                                                             where initr_es.emplid = sf50.emplid 
                                                                                               and initr_es.empl_rcd = sf50.empl_rcd 
                                                                                               and initr_es.effdt = sf50.effdt 
                                                                                               and initr_es.effseq = sf50.effseq 
                                                                                               and initr_es.GVT_WIP_STATUS in ('INI')
                                                                                              ) 
                      left outer join PS_GVT_EE_DATA_TRK reqtr ON  reqtr.emplid   = sf50.emplid and reqtr.empl_rcd = sf50.empl_rcd  and reqtr.effdt = sf50.effdt and reqtr.effseq = sf50.effseq and reqtr.GVT_WIP_STATUS in ('REQ')
                                                               and reqtr.gvt_trk_sequence = (select max(reqtr_es.gvt_trk_sequence) from PS_GVT_EE_DATA_TRK reqtr_es 
                                                                                             where reqtr_es.emplid = sf50.emplid 
                                                                                               and reqtr_es.empl_rcd = sf50.empl_rcd 
                                                                                               and reqtr_es.effdt = sf50.effdt 
                                                                                               and reqtr_es.effseq = sf50.effseq 
                                                                                               and reqtr_es.GVT_WIP_STATUS in ('REQ')
                                                                                             )  
                     LEFT OUTER JOIN  psxlatitem toedu on  toedu.FIELDNAME  = 'HIGHEST_EDUC_LVL' and toedu.FIELDVALUE = toper.HIGHEST_EDUC_LVL
                                                             AND toedu.EFFDT =(SELECT MAX(xlat_ED.EFFDT) FROM psxlatitem xlat_ED
                                                                               WHERE xlat_ED.FIELDVALUE = toper.HIGHEST_EDUC_LVL
		                                                                         AND xlat_ED.FIELDNAME  = 'HIGHEST_EDUC_LVL' 
                                                                                 AND xlat_ED.EFFDT       <= sf50.EFFDT)			
                     LEFT OUTER JOIN  psxlatitem tosex on  tosex.FIELDNAME  = 'SEX' and tosex.FIELDVALUE = toper.SEX
                                                             AND tosex.EFFDT =(SELECT MAX(xlat_ED.EFFDT) FROM psxlatitem xlat_ED
                                                                               WHERE xlat_ED.FIELDVALUE = toper.SEX
		                                                                         AND xlat_ED.FIELDNAME  = 'SEX' 
                                                                                 AND xlat_ED.EFFDT       <= sf50.EFFDT)			
                     LEFT OUTER JOIN  psxlatitem frsex on  frsex.FIELDNAME  = 'SEX' and frsex.FIELDVALUE = frper.SEX
                                                             AND frsex.EFFDT =(SELECT MAX(xlat_ED.EFFDT) FROM psxlatitem xlat_ED
                                                                               WHERE xlat_ED.FIELDVALUE = frper.SEX
		                                                                            AND xlat_ED.FIELDNAME  = 'SEX' 
                                                                                 AND xlat_ED.EFFDT       <= sf50.act_pr_EFFDT) 
                     LEFT OUTER JOIN  psxlatitem tomil on  tomil.FIELDNAME  = 'MILITARY_STATUS' and tomil.FIELDVALUE = toper.MILITARY_STATUS
                                                             AND tomil.EFFDT =(SELECT MAX(xlat_ED.EFFDT) FROM psxlatitem xlat_ED
                                                                               WHERE xlat_ED.FIELDVALUE = toper.MILITARY_STATUS
		                                                                         AND xlat_ED.FIELDNAME  = 'MILITARY_STATUS' 
                                                                                 AND xlat_ED.EFFDT       <= sf50.EFFDT)			
                     LEFT OUTER JOIN  psxlatitem frmil on  frmil.FIELDNAME  = 'MILITARY_STATUS' and frmil.FIELDVALUE = frper.MILITARY_STATUS
                                                             AND frmil.EFFDT =(SELECT MAX(xlat_ED.EFFDT) FROM psxlatitem xlat_ED
                                                                               WHERE xlat_ED.FIELDVALUE = frper.MILITARY_STATUS
		                                                                            AND xlat_ED.FIELDNAME  = 'MILITARY_STATUS' 
                                                                                 AND xlat_ED.EFFDT       <= sf50.act_pr_EFFDT) 
                     LEFT OUTER JOIN  psxlatitem tospm on  tospm.FIELDNAME  = 'GVT_NFC_SPMGREQ_CD' and tospm.FIELDVALUE = toemp.GVT_NFC_SPMGREQ_CD
                                                             AND tospm.EFFDT =(SELECT MAX(xlat_ED.EFFDT) FROM psxlatitem xlat_ED
                                                                               WHERE xlat_ED.FIELDVALUE = toemp.GVT_NFC_SPMGREQ_CD
		                                                                         AND xlat_ED.FIELDNAME  = 'GVT_NFC_SPMGREQ_CD' 
                                                                                 AND xlat_ED.EFFDT       <= sf50.EFFDT)			
                     LEFT OUTER JOIN  psxlatitem frspm on  frspm.FIELDNAME  = 'GVT_NFC_SPMGREQ_CD' and frspm.FIELDVALUE = fremp.GVT_NFC_SPMGREQ_CD
                                                             AND frspm.EFFDT =(SELECT MAX(xlat_ED.EFFDT) FROM psxlatitem xlat_ED
                                                                               WHERE xlat_ED.FIELDVALUE = fremp.GVT_NFC_SPMGREQ_CD
		                                                                            AND xlat_ED.FIELDNAME  = 'GVT_NFC_SPMGREQ_CD' 
                                                                                 AND xlat_ED.EFFDT       <= sf50.act_pr_EFFDT) 
                     LEFT OUTER JOIN  psxlatitem toten on  toten.FIELDNAME  = 'GVT_TENURE' and toten.FIELDVALUE = toemp.GVT_TENURE
                                                             AND toten.EFFDT =(SELECT MAX(xlat_ED.EFFDT) FROM psxlatitem xlat_ED
                                                                               WHERE xlat_ED.FIELDVALUE = toemp.GVT_TENURE
		                                                                         AND xlat_ED.FIELDNAME  = 'GVT_TENURE' 
                                                                                 AND xlat_ED.EFFDT       <= sf50.EFFDT)			
                     LEFT OUTER JOIN  psxlatitem frten on  frten.FIELDNAME  = 'GVT_TENURE' and frten.FIELDVALUE = fremp.GVT_TENURE
                                                             AND frten.EFFDT =(SELECT MAX(xlat_ED.EFFDT) FROM psxlatitem xlat_ED
                                                                               WHERE xlat_ED.FIELDVALUE = fremp.GVT_TENURE
		                                                                            AND xlat_ED.FIELDNAME  = 'GVT_TENURE' 
                                                                                 AND xlat_ED.EFFDT       <= sf50.act_pr_EFFDT) 
                     LEFT OUTER JOIN  psxlatitem towgi on  towgi.FIELDNAME  = 'GVT_WGI_STATUS' and towgi.FIELDVALUE = toemp.GVT_WGI_STATUS
                                                             AND towgi.EFFDT =(SELECT MAX(xlat_ED.EFFDT) FROM psxlatitem xlat_ED
                                                                               WHERE xlat_ED.FIELDVALUE = toemp.GVT_WGI_STATUS
		                                                                         AND xlat_ED.FIELDNAME  = 'GVT_WGI_STATUS' 
                                                                                 AND xlat_ED.EFFDT       <= sf50.EFFDT)			
                     LEFT OUTER JOIN  psxlatitem frwgi on  frwgi.FIELDNAME  = 'GVT_WGI_STATUS' and frwgi.FIELDVALUE = fremp.GVT_WGI_STATUS
                                                             AND frwgi.EFFDT =(SELECT MAX(xlat_ED.EFFDT) FROM psxlatitem xlat_ED
                                                                               WHERE xlat_ED.FIELDVALUE = fremp.GVT_WGI_STATUS
		                                                                            AND xlat_ED.FIELDNAME  = 'GVT_WGI_STATUS' 
                                                                                 AND xlat_ED.EFFDT       <= sf50.act_pr_EFFDT) 
                     LEFT OUTER JOIN  nhrdw_custom_xlatitem tovpr on  tovpr.FIELDNAME  = 'VETERANS_PREFERENCE' and tovpr.FIELDVALUE = toper.GVT_VET_PREF_APPT
                                                             AND tovpr.EFFDT =(SELECT MAX(xlat_ED.EFFDT) FROM nhrdw_custom_xlatitem xlat_ED
                                                                               WHERE xlat_ED.FIELDVALUE = toper.GVT_VET_PREF_APPT
		                                                                         AND xlat_ED.FIELDNAME  = 'VETERANS_PREFERENCE' 
                                                                                 AND xlat_ED.EFFDT       <= sf50.EFFDT)			
                     LEFT OUTER JOIN  nhrdw_custom_xlatitem frvpr on  frvpr.FIELDNAME  = 'VETERANS_PREFERENCE' and frvpr.FIELDVALUE = frper.GVT_VET_PREF_APPT
                                                             AND frvpr.EFFDT =(SELECT MAX(xlat_ED.EFFDT) FROM nhrdw_custom_xlatitem xlat_ED
                                                                               WHERE xlat_ED.FIELDVALUE = frper.GVT_VET_PREF_APPT
		                                                                            AND xlat_ED.FIELDNAME  = 'VETERANS_PREFERENCE' 
                                                                                 AND xlat_ED.EFFDT       <= sf50.act_pr_EFFDT) 
                     left outer join NHRDW_EMPLOYEE_ACCOMPLISHMENT educ on educ.emplid = sf50.emplid and educ.ACCOMPLISHMENT_TYPE = 'DEG' AND educ.YR_ACQUIRED <= YEAR(sf50.effdt) AND educ.GRADUATE_INDICATOR = 'Y'
                     AND  educ.EDUCATION_LVL = (SELECT MAX(educ_1.EDUCATION_LVL) 
                                               FROM    NHRDW_EMPLOYEE_ACCOMPLISHMENT educ_1
                                               WHERE   educ_1.EMPLID = sf50.EMPLID
                                               AND     educ_1.ACCOMPLISHMENT_TYPE = 'DEG'
                                               AND     educ_1.GRADUATE_INDICATOR = 'Y'
                                               AND     educ_1.YR_ACQUIRED <= YEAR(sf50.effdt) 
                                                 )                    
                     AND   educ.YR_ACQUIRED     = (SELECT MAX(educ_2.YR_ACQUIRED) 
                                               FROM    NHRDW_EMPLOYEE_ACCOMPLISHMENT educ_2
                                               WHERE educ_2.EMPLID = sf50.EMPLID
                                               AND   educ_2.ACCOMPLISHMENT_TYPE = 'DEG'
                                               AND   educ_2.GRADUATE_INDICATOR = 'Y'
                                               AND   educ_2.EDUCATION_LVL = educ.EDUCATION_LVL 
                                               AND   educ_2.YR_ACQUIRED <= YEAR(sf50.effdt) )                        
                     AND   educ.DT_ISSUED     = (SELECT MAX(educ_3.DT_ISSUED) 
                                               FROM    NHRDW_EMPLOYEE_ACCOMPLISHMENT educ_3
                                               WHERE educ_3.EMPLID         = sf50.EMPLID
                                               AND   educ_3.ACCOMPLISHMENT_TYPE = 'DEG'                         
                                               AND   educ_3.GRADUATE_INDICATOR = 'Y'
                                               AND   educ_3.EDUCATION_LVL  = educ.EDUCATION_LVL 
                                               AND   educ_3.YR_ACQUIRED    =  educ.YR_ACQUIRED )      
                     AND   educ.MAJOR_CODE    = (SELECT MAX(educ_4.MAJOR_CODE) 
                                               FROM    NHRDW_EMPLOYEE_ACCOMPLISHMENT educ_4
                                               WHERE educ_4.EMPLID         = sf50.EMPLID
                                               AND   educ_4.ACCOMPLISHMENT_TYPE = 'DEG'                         
                                               AND   educ_4.EDUCATION_LVL  = educ.EDUCATION_LVL 
                                               AND   educ_4.GRADUATE_INDICATOR = 'Y'
                                               AND   educ_4.YR_ACQUIRED    =  educ.YR_ACQUIRED 
                                               AND   educ_4.DT_ISSUED      =  educ.DT_ISSUED)   
                      LEFT OUTER JOIN  psxlatitem pseduc on  pseduc.FIELDNAME  = 'HIGHEST_EDUC_LVL' and pseduc.FIELDVALUE = educ.EDUCATION_LVL	
                                                             AND pseduc.EFFDT =(SELECT MAX(xlat_ED.EFFDT) FROM psxlatitem xlat_ED
                                                                               WHERE xlat_ED.FIELDVALUE = educ.EDUCATION_LVL	
		                                                                             AND xlat_ED.FIELDNAME  = 'HIGHEST_EDUC_LVL' 
                                                                                 AND xlat_ED.EFFDT       <= sf50.effdt )	
	                     LEFT OUTER JOIN new_hrdw.PS_GVT_LEGAL_AUTH  LAC1 ON            LAC1.GVT_LEGAL_AUTH  = toemp.GVT_CURR_APT_AUTH1 
	                                                                                and LAC1.EFFDT = (SELECT MAX(LAC1_ED.EFFDT) FROM new_hrdw.PS_GVT_LEGAL_AUTH LAC1_ED
	                                                                                                    WHERE LAC1_ED.GVT_LEGAL_AUTH = toemp.GVT_CURR_APT_AUTH1   
	                                                                                                      AND LAC1_ED.EFFDT <= sf50.effdt ) 
	                     LEFT OUTER JOIN new_hrdw.PS_GVT_LEGAL_AUTH  LAC2 ON            LAC2.GVT_LEGAL_AUTH  = toemp.GVT_CURR_APT_AUTH2 
	                                                                                    and LAC2.EFFDT = (SELECT MAX(LAC2_ED.EFFDT) FROM new_hrdw.PS_GVT_LEGAL_AUTH LAC2_ED
	                                                                                                    WHERE LAC2_ED.GVT_LEGAL_AUTH = toemp.GVT_CURR_APT_AUTH2     
	                                                                                                      AND LAC2_ED.EFFDT <= sf50.effdt ) 
	             
	                    ;

 

                      call nhrdw_ohrmbi_bpr_transaction_refresh();


                      truncate table nhrdw_sf52_requests;

	                      -- Populate Create Position Requests 

	                       call nhrdw_process_log_trk (-7001, 'I', 'Refresh SF52 Requests :  Create Position ' );
	                                             
	                       INSERT INTO NEW_HRDW.NHRDW_SF52_REQUESTS
	                           (  
	                                    CADW_TRANSACTION_NBR                
	                                   ,TRANSACTION_TYPE         
	                                   ,TRANSACTION_NBR          
	                                   ,TRANSACTION_STATUS_CODE
	                                   ,TRANSACTION_STATUS_DESCR
	                                   ,REQ_POSITION_NBR             
	                                   ,REQUEST_DT  
	                                   ,REQ_FOURDIGIT_FISCAL_YEAR_OF_REQUEST_DT
	                                   ,REQ_FISCAL_YEAR_ACTION_REQUEST_DT             
	                                   ,REQ_ACTION                   
	                                   ,REQ_ACTION_REASON            
	                                   ,REQ_DEPTID                   
	                                   ,REQ_LOCATION                 
	                                   ,REQ_REPORTS_TO               
	                                   ,REQ_GVT_WORK_SCHED           
	                                   ,REQ_STD_HOURS                
	                                   ,REQ_Z_PD_FUNC                
	                                   ,REQ_GVT_POI  
	                                   ,REQ_GVT_POI_DESCR                
	                                   ,REQ_Z_ACCT_CD                
	                                   ,REQ_Z_PD_CSBASEID            
	                                   ,REQ_BARG_UNIT                
	                                   ,REQ_REG_TEMP                 
	                                   ,REQ_Z_NOTIFY_ROLE            
	                                   ,REQ_Z_PD_FUNC2               
	                                   ,REQ_POSN_DESCR               
	                                   ,REQ_DATE1                    
	                                   ,REQ_DATE2                    
	                                   ,REQ_DATE3                    
	                                   ,REQ_DATE4                    
	                                   ,REQ_TRANSACTION_NAME         
	                                   ,REQ_WF_STATUS                
	                                   ,REQ_UPD_BY_USERID            
	                                   ,REQ_UPD_DTTM                 
	                                   ,REQ_ORIGINATOR_ID            
	                                   ,REQ_CREATED_DTTM             
	                                   ,REQ_COMMENTS                 
	                                   ,REQ_FULL_PART_TIME     
	                                   ,REQ_Z_MSS_GRADE     
	                                   ,REQ_MSS_REC_Z_RECRUIT_IND     
	                                   ,REQ_MSS_REC_Z_RECRUIT_INIT    
	                                   ,REQ_MSS_REC_Z_RECRUIT_CANCEL  
	                                   ,REQ_MSS_REC_CREATEDTTM        
	                                   ,REQ_MSS_REC_CREATEOPRID       
	                                   ,REQ_MSS_REC_LASTUPDDTTM       
	                                   ,REQ_MSS_REC_LASTUPDOPRID      
	                                   ,REQ_XREF_EOAWTHREAD_ID        
	                                   ,REQ_XREF_EOAWPRCS_ID          
	                                   ,REQ_XREF_EOAWDEFN_ID            
	                                   ,REQ_XREF_ORIGINATORID           
	                                   ,REQ_XREF_EOAWREQUESTOR_ID      
	                                   ,REQ_XREF_RECNAME              
	                                   ,REQ_XREF_EOAWTHREAD_STATUS    
	                                   ,REQ_XREF_EOAWPARENT_THREAD    
	                                   ,REQ_XREF_EOAWDTTM_MODIFIED    
	                                   ,REQ_XREF_COMMENTS             
	                                   ,REQ_APPR_AUDIT_OPRID          
	                                   ,REQ_APPR_AUDIT_STAMP          
	                                   ,REQ_APPR_AUDIT_ACTN                  
	                                   ,REQ_LATEST_AUDIT_OPRID        
	                                   ,REQ_LATEST_AUDIT_STAMP        
	                                   ,REQ_LATEST_AUDIT_ACTN 
	                                   ,REQ_REC_APPR_AUDIT_OPRID          
	                                   ,REQ_REC_APPR_AUDIT_STAMP          
	                                   ,REQ_REC_APPR_AUDIT_ACTN           
	                                   ,REQ_REC_CANCEL_AUDIT_OPRID        
	                                   ,REQ_REC_CANCEL_AUDIT_STAMP        
	                                   ,REQ_REC_CANCEL_AUDIT_ACTN         
	                                   ,REQ_REC_LATEST_AUDIT_OPRID        
	                                   ,REQ_REC_LATEST_AUDIT_STAMP        
	                                   ,REQ_REC_LATEST_AUDIT_ACTN 
	                                   ,REQ_REC_LATEST_APPR_AUDIT_STAMP
	                                   ,REQ_DEPT_BUSINESS_LINE
	                                   ,REQ_GSA_DEPT_REGION                                    
	                                   ,REQ_DEPT_DESCR      
	                                   ,REQ_DEPT_GVT_DESCR40
	                                   ,REQ_GVT_PAR_LINE2      
	                                   ,REQ_GVT_PAR_LINE3      
	                                   ,REQ_GVT_PAR_LINE4      
	                                   ,REQ_GVT_PAR_LINE5      
	                                   ,REQ_GVT_PAR_DESCR2     
	                                   ,REQ_GVT_PAR_DESCR3     
	                                   ,REQ_GVT_PAR_DESCR4     
	                                   ,REQ_GVT_PAR_DESCR5                                           
	                                   ,REQ_Z_POSITION_EFFDT
	                                   ,REQ_Z_POSITION_TRANS_TYPE       
	                                   ,REQ_Z_POSITION_TRANSACTION_NBR  
	                                   ,REQ_Z_POSITION_CADW_TRANSACTION_NBR                                  
	                                   ,REQ_Z_POSITION_Z_PD_FUNC                       
	                                   ,REQ_Z_POSITION_Z_ACCT_CD   
	                                   ,REQ_POS_ACTION        
	                                   ,REQ_POS_ACTION_REASON 
	                                   ,REQ_POS_EFFDT                    
	                                   ,REQ_POS_GVT_PAY_PLAN                           
	                                   ,REQ_POS_GRADE                                  
	                                   ,REQ_POS_GVT_TARGET_GRADE                       
	                                   ,REQ_POS_SUPV_LVL_ID                            
	                                   ,REQ_POS_SUPV_LVL_ID_DESCR                      
	                                   ,REQ_POS_DESCRLONG                              
	                                   ,REQ_POS_DESCRSHORT                             
	                                   ,REQ_POS_DESCR                                  
	                                   ,REQ_POS_GVT_POSN_SENS_CD                       
	                                   ,REQ_POS_GVT_POSN_SENS_CD_DESCR                 
	                                   ,REQ_POS_GVT_OCC_SERIES                         
	                                   ,REQ_POS_GVT_OCC_SERIES_DESCR40                 
	                                   ,REQ_POS_GVT_OCC_SERIES_DESCR70                 
	                                   ,REQ_POS_GVT_OCC_SERIES_PATCOB_CD               
	                                   ,REQ_POS_GVT_OCC_SERIES_PATCOB_CD_DESCR         
	                                   ,REQ_POS_GVT_OCC_SERIES_FUNC_CLASS_REQ          
	                                   ,REQ_POS_MCO_GROUP                              
	                                   ,REQ_POS_MCO_ABBREVIATION                       
	                                   ,REQ_POS_OCCUPATIONAL_SERIES_GROUP              
	                                   ,REQ_POS_BPR_GROUP                              
	                                   ,REQ_POS_MCO_OCO_MSO_TYPE                       
	                                   ,REQ_POS_MISSION_FUNCTIONAL_GROUP               
	                                   ,REQ_POS_GVT_ORG_TTL_DESCR                      
	                                   ,REQ_POS_GVT_ORG_TTL_CD                         
	                                   ,REQ_POS_GSA_EXECUTIVE_RESOURCES_FLAG	
	                                   ,REQ_POS_INVESTIGATION_TYPE        
	                                   ,REQ_POS_INVESTIGATION_TYPE_DESCR                  
	                                   ,REQ_POS_STAFFING_INVESTIGATION_TYPE                         
	                                   ,REQ_GVT_GEOLOC_CD                               
	                                   ,REQ_GEOLOC_GVT_ST_CNTRY_DESCR                   
	                                   ,REQ_GEOLOC_CITY                                 
	                                   ,REQ_GEOLOC_STATE                                
	                                   ,REQ_GEOLOC_COUNTY                               
	                                   ,REQ_GEOLOC_COUNTRY                              
	                                   ,REQ_GEOLOC_GSA_REGION                           
	                                   ,REQ_GEOLOC_GSA_REGION_DESCR                     
	                                   ,REQ_GVT_MSA                                     
	                                   ,REQ_GVT_CMSA                                    
	                                   ,REQ_GVT_LEOPAY_AREA                             
	                                   ,REQ_GVT_LEOPAY_AREA_EFFDT                       
	                                   ,REQ_GVT_LEOPAY_AREA_DESCR                       
	                                   ,REQ_GVT_LEO_PCT                                 
	                                   ,REQ_GVT_LOCALITY_AREA                           
	                                   ,REQ_GVT_LOCALITY_AREA_EFFDT                     
	                                   ,REQ_GVT_LOCALITY_AREA_DESCR                     
	                                   ,REQ_GVT_LOCALITY_PCT                            
	                                   ,REQ_GVT_IGA_PCT                                 
	                                   ,REQ_NFCOLA_PERCENT                                          
	                                   ,REQ_REPORTS_TO_EMPLID           
	                                   ,REQ_REPORTS_TO_EMPL_RCD         
	                                   ,REQ_REPORTS_TO_EMPL_NAME        
	                                   ,REQ_REPORTS_TO_EMAIL_ADDR       
	                                   ,REQ_REPORTS_TO_GVT_WIP_STATUS                     
	                                   ,REQ_REPORTS_TO_GVT_WIP_STATUS_DESCR               
	                                   ,REQ_REPORTS_TO_GVT_STATUS_TYPE                    
	                                   ,REQ_REPORTS_TO_GVT_STATUS_TYPE_DESCR              
	                                   ,REQ_REPORTS_TO_GVT_NOA_CODE                                                    
	                                   ,REQ_REPORTS_TO_EFFDT                              
	                                   ,REQ_REPORTS_TO_EFFSEQ                             
	                                   ,ACTION_EMPLID           
	                                   ,ACTION_EMPL_RCD          
	                                   ,ACTION_GVT_WIP_STATUS                     
	                                   ,ACTION_GVT_WIP_STATUS_DESCR               
	                                   ,ACTION_GVT_STATUS_TYPE                    
	                                   ,ACTION_GVT_STATUS_TYPE_DESCR              
	                                   ,ACTION_GVT_NOA_CODE                                                    
	                                   ,ACTION_EFFDT                              
	                                   ,ACTION_EFFSEQ    
	                                   ,SF50_TRANSACTION_CONTROL_ID  
	                                   ,CADW_SF50_TRANSACTION_STATUS
	                                   ,REQ_Z_ADMIN_POC_OPRID                                                        
	                                   ,REQ_Z_ADMIN_POC_EMPL_NAME                                                  
	                                   ,REQ_Z_ADMIN_POC_EMPLID                                                    
	                                   ,REQ_Z_ADMIN_POC_EMAILID                                                   
	                                   ,REQ_Z_ALT_HIRE_MGR_OPRID                                                  
	                                   ,REQ_Z_ALT_HIRE_MGR_EMPL_NAME                                               
	                                   ,REQ_Z_ALT_HIRE_MGR_EMPLID                                   
	                                   ,REQ_Z_ALT_HIRE_MGR_EMAILID                                                
	                                   ,REQ_Z_HR_SPECIALIST_OPRID                                                 
	                                   ,REQ_Z_HR_SPECIALIST_EMPL_NAME                                              
	                                   ,REQ_Z_HR_SPECIALIST_EMPLID                                                
	                                   ,REQ_Z_HR_SPECIALIST_EMAILID                                               
	                                   ,REQ_Z_NRC_SPECIALIST_OPRID                                                
	                                   ,REQ_Z_NRC_SPECIALIST_EMPL_NAME                                             
	                                   ,REQ_Z_NRC_SPECIALIST_EMPLID                                               
	                                   ,REQ_Z_NRC_SPECIALIST_EMAILID 
	                            )
	                         SELECT 
	                                    CONCAT(PS_Z_MSS_CRPOS_DAT.TRANSACTION_NBR,'C')   
	                                   ,'NEW'         
	                                   ,PS_Z_MSS_CRPOS_DAT.TRANSACTION_NBR       
	                                   ,CASE WHEN PS_Z_MSS_RECRUIT.Z_RECRUIT_CANCEL = 'Y' THEN 'CAN'
	                                         WHEN FUTJOB.GVT_WIP_STATUS IN ('PRO','COR')  THEN 'PRO'
	                                         WHEN FUTJOB.GVT_WIP_STATUS IN ('WIP','INI')  THEN 'WIP'
	                                         WHEN FUTJOB.GVT_WIP_STATUS IS NULL           THEN 'APP' ELSE 'APP' END      
	                                   ,CASE WHEN PS_Z_MSS_RECRUIT.Z_RECRUIT_CANCEL = 'Y' THEN 'Cancelled'
	                                         WHEN FUTJOB.GVT_WIP_STATUS IN ('PRO','COR')  THEN 'Completed'
	                                         WHEN FUTJOB.GVT_WIP_STATUS IN ('WIP','INI')  THEN 'Pending EOD'
	                                         WHEN FUTJOB.GVT_WIP_STATUS IS NULL           THEN 'Approved' ELSE 'Approved' END   
	                                   ,PS_Z_MSS_CRPOS_DAT.POSITION_NBR 
	                                   ,PS_Z_MSS_CRPOS_DAT.REQUEST_DT            
	                                   ,YEAR(DATE_FORMAT(DATE_ADD( PS_Z_MSS_CRPOS_DAT.REQUEST_DT ,INTERVAL 3 MONTH) ,'%Y-09-30')) FOURDIGIT_FISCAL_YEAR_OF_EFFDT
	                                   ,CONCAT('FY',SUBSTR(YEAR(DATE_FORMAT(DATE_ADD( PS_Z_MSS_CRPOS_DAT.REQUEST_DT ,INTERVAL 3 MONTH) ,'%Y-09-30')),3,2)) FISCAL_YEAR_ACTION_EFFDT
	                                   ,PS_Z_MSS_CRPOS_DAT.ACTION                
	                                   ,PS_Z_MSS_CRPOS_DAT.ACTION_REASON         
	                                   ,PS_Z_MSS_CRPOS_DAT.DEPTID                
	                                   ,PS_Z_MSS_CRPOS_DAT.LOCATION              
	                                   ,PS_Z_MSS_CRPOS_DAT.REPORTS_TO            
	                                   ,PS_Z_MSS_CRPOS_DAT.GVT_WORK_SCHED        
	                                   ,PS_Z_MSS_CRPOS_DAT.STD_HOURS             
	                                   ,PS_Z_MSS_CRPOS_DAT.Z_PD_FUNC             
	                                   ,PS_Z_MSS_CRPOS_DAT.GVT_POI     
	                                   ,POI.DESCR          
	                                   ,PS_Z_MSS_CRPOS_DAT.Z_ACCT_CD             
	                                   ,PS_Z_MSS_CRPOS_DAT.Z_PD_CSBASEID         
	                                   ,PS_Z_MSS_CRPOS_DAT.BARG_UNIT             
	                                   ,PS_Z_MSS_CRPOS_DAT.REG_TEMP              
	                                   ,PS_Z_MSS_CRPOS_DAT.Z_NOTIFY_ROLE         
	                                   ,PS_Z_MSS_CRPOS_DAT.Z_PD_FUNC2            
	                                   ,PS_Z_MSS_CRPOS_DAT.POSN_DESCR            
	                                   ,PS_Z_MSS_CRPOS_DAT.DATE1                 
	                                   ,PS_Z_MSS_CRPOS_DAT.DATE2                 
	                                   ,PS_Z_MSS_CRPOS_DAT.DATE3                 
	                                   ,PS_Z_MSS_CRPOS_DAT.DATE4                 
	                                   ,PS_Z_MSS_CRPOS_DAT.TRANSACTION_NAME      
	                                   ,PS_Z_MSS_CRPOS_DAT.WF_STATUS             
	                                   ,PS_Z_MSS_CRPOS_DAT.UPD_BY_USERID         
	                                   ,PS_Z_MSS_CRPOS_DAT.UPD_DTTM              
	                                   ,PS_Z_MSS_CRPOS_DAT.ORIGINATOR_ID         
	                                   ,PS_Z_MSS_CRPOS_DAT.CREATED_DTTM          
	                                   ,PS_Z_MSS_CRPOS_DAT.COMMENTS              
	                                   ,PS_Z_MSS_CRPOS_DAT.FULL_PART_TIME  
	                                   ,PS_Z_MSS_CRPOS_DAT.Z_MSS_GRADE     
	                                   ,PS_Z_MSS_RECRUIT.Z_RECRUIT_IND                             
	                                   ,PS_Z_MSS_RECRUIT.Z_RECRUIT_INIT                                   
	                                   ,PS_Z_MSS_RECRUIT.Z_RECRUIT_CANCEL                               
	                                   ,PS_Z_MSS_RECRUIT.CREATEDTTM                                          
	                                   ,PS_Z_MSS_RECRUIT.CREATEOPRID                               
	                                   ,PS_Z_MSS_RECRUIT.LASTUPDDTTM                               
	                                   ,PS_Z_MSS_RECRUIT.LASTUPDOPRID                              
	                                   ,PS_Z_MSSCRPOS_XREF.EOAWTHREAD_ID                                
	                                   ,PS_Z_MSSCRPOS_XREF.EOAWPRCS_ID                                  
	                                   ,PS_Z_MSSCRPOS_XREF.EOAWDEFN_ID                                  
	                                   ,PS_Z_MSSCRPOS_XREF.ORIGINATORID                                 
	                                   ,PS_Z_MSSCRPOS_XREF.EOAWREQUESTOR_ID                             
	                                   ,PS_Z_MSSCRPOS_XREF.RECNAME                                      
	                                   ,PS_Z_MSSCRPOS_XREF.EOAWTHREAD_STATUS                            
	                                   ,PS_Z_MSSCRPOS_XREF.EOAWPARENT_THREAD                            
	                                   ,PS_Z_MSSCRPOS_XREF.EOAWDTTM_MODIFIED                            
	                                   ,PS_Z_MSSCRPOS_XREF.COMMENTS                                     
	                                   ,PS_AUDIT_Z_CRPOS_D_APPR.AUDIT_OPRID                                  
	                                   ,PS_AUDIT_Z_CRPOS_D_APPR.AUDIT_STAMP                                  
	                                   ,PS_AUDIT_Z_CRPOS_D_APPR.AUDIT_ACTN                                                                 
	                                   ,PS_AUDIT_Z_CRPOS_D_LAT.AUDIT_OPRID                                
	                                   ,PS_AUDIT_Z_CRPOS_D_LAT.AUDIT_STAMP                                
	                                   ,PS_AUDIT_Z_CRPOS_D_LAT.AUDIT_ACTN 
	                                   ,PS_AUDIT_Z_MSS_REC_APPR.AUDIT_OPRID                                  
	                                   ,PS_AUDIT_Z_MSS_REC_APPR.AUDIT_STAMP                                  
	                                   ,PS_AUDIT_Z_MSS_REC_APPR.AUDIT_ACTN                                   
	                                   ,CASE WHEN PS_Z_MSS_RECRUIT.Z_RECRUIT_CANCEL = 'Y' THEN PS_AUDIT_Z_MSS_REC_CANCEL.AUDIT_OPRID  ELSE NULL END                          
	                                   ,CASE WHEN PS_Z_MSS_RECRUIT.Z_RECRUIT_CANCEL = 'Y' THEN PS_AUDIT_Z_MSS_REC_CANCEL.AUDIT_STAMP  ELSE NULL END                            
	                                   ,CASE WHEN PS_Z_MSS_RECRUIT.Z_RECRUIT_CANCEL = 'Y' THEN PS_AUDIT_Z_MSS_REC_CANCEL.AUDIT_ACTN   ELSE NULL END                              
	                                   ,PS_AUDIT_Z_MSS_REC_LAT.AUDIT_OPRID                                
	                                   ,PS_AUDIT_Z_MSS_REC_LAT.AUDIT_STAMP                                
	                                   ,PS_AUDIT_Z_MSS_REC_LAT.AUDIT_ACTN 
	                                   ,PS_AUDIT_Z_MSS_REC_LAT_APPR.AUDIT_STAMP     
	                                   ,ZDEPT.Z_TEXT30_5 
	                                   ,nhrdw_get_gsa_region('GSASH',PS_Z_MSS_CRPOS_DAT.DEPTID )                                   
	                                   ,DEPT.DESCR      
	                                   ,DEPT.GVT_DESCR40
	                                   ,DEPT.GVT_PAR_LINE2         
	                                   ,DEPT.GVT_PAR_LINE3         
	                                   ,DEPT.GVT_PAR_LINE4         
	                                   ,DEPT.GVT_PAR_LINE5         
	                                   ,DEPT.GVT_PAR_DESCR2        
	                                   ,DEPT.GVT_PAR_DESCR3        
	                                   ,DEPT.GVT_PAR_DESCR4        
	                                   ,DEPT.GVT_PAR_DESCR5       
	                                   ,ZPOS.EFFDT      
	                                   ,ZPOS.Z_TEXT254_4 
	                                   ,ZPOS.Z_TEXT254_3  
	                                   ,CASE WHEN ZPOS.Z_TEXT254_4 = 'SF52' THEN ZPOS.Z_TEXT254_3  
	                                         WHEN ZPOS.Z_TEXT254_4 = 'NEW' THEN CONCAT(ZPOS.Z_TEXT254_3 ,'C')  
	                                         WHEN ZPOS.Z_TEXT254_4 = 'PUF' THEN CONCAT(ZPOS.Z_TEXT254_3 ,'U') ELSE NULL END         
	                                   ,ZPOS.Z_PD_FUNC                           
	                                   ,ZPOS.Z_ACCT_CD   
	                                   ,TOPOS.ACTION        
	                                   ,TOPOS.ACTION_REASON 
	                                   ,TOPOS.EFFDT                         
	                                   ,TOPOS.GVT_PAY_PLAN                                                 
	                                   ,TOPOS.GRADE                                                        
	                                   ,TOPOS.GVT_TARGET_GRADE                                             
	                                   ,TOPOS.SUPV_LVL_ID                                                                           
	                                   ,TOSUP.DESCR                                                                                 
	                                   ,TOPOS.DESCRLONG                                                                             
	                                   ,TOPOS.DESCRSHORT                                                                            
	                                   ,TOPOS.DESCR                                                                                 
	                                   ,TOPOS.GVT_POSN_SENS_CD                                                                      
	                                   ,TOSEN.XLATLONGNAME                                                                          
	                                   ,TOPOS.GVT_OCC_SERIES                                                                        
	                                   ,TOOCC.GVT_DESCR40	                                                                         
	                                   ,TOOCC.GVT_DESCR70	                                                                         
	                                   ,TOOCC.GVT_PATCOB_CD	                                                                       
	                                   ,TOPAT.XLATLONGNAME                                                                          
	                                   ,TOOCC.GVT_FUNC_CLASS_REQ  
	                                   ,TOOCA.MCO_GROUP                                                                             
	                                   ,TOOCA.MCO_ABBREVIATION                                                                      
	                                   ,TOOCA.OCCUPATIONAL_SERIES_GROUP                                                             
	                                   ,TOOCA.BPR_GROUP                                                                             
	                                   ,TOOCA.MCO_OCO_MSO_TYPE                                                                      
	                                   ,TOOCA.MISSION_FUNCTIONAL_GROUP                                                              
	                                   ,TOPOS.GVT_ORG_TTL_DESCR                                              
	                                   ,TOPOS.GVT_ORG_TTL_CD     
	                                   ,CASE WHEN TOPOS.BUSINESS_UNIT in ('GSA01','GSA02') and substr(ZPOS.Z_PD_FUNC,1,1) = 'X' THEN 'Y' ELSE 'N' END   
	                                   ,senscd.X_FIELDVALUE
	                                   ,invest.SHORT_DESC                                                                                            
	                                   ,case when senscd.X_FIELDVALUE = 'T1'  then 'T1-NACI'
	                                         when senscd.X_FIELDVALUE = 'T2S' then 'T2S'
	                                         when senscd.X_FIELDVALUE = 'T3'  then 'T3-ANACI,NACLC Initial'
	                                         when senscd.X_FIELDVALUE = 'T4'  then 'T4-BI'
	                                         when senscd.X_FIELDVALUE = 'T5'  then 'T5-SSBI'
	                                       else null end  
	                                   ,LOC.GVT_GEOLOC_CD	                        	                                               
	                                   ,GEOTAB.GVT_ST_CNTRY_DESCR		                                                               
	                                   ,GEOTAB.CITY	         		                      		                                         
	                                   ,GEOTAB.STATE	         		                   		                                             
	                                   ,GEOTAB.COUNTY	         		                                                                 
	                                   ,GEOTAB.COUNTRY                                                                              
	                                   ,COALESCE(todsrc.X_FIELDVALUE,todsr.X_FIELDVALUE)  	                                         
	                                   ,togsr.SHORT_DESC   	                                                                       
	                                   ,GEOTAB.GVT_MSA	        	                    	                                             
	                                   ,GEOTAB.GVT_CMSA	        	                  	                                             
	                                   ,GEOTAB.GVT_LEOPAY_AREA		                                                                   
	                                   ,LEOAREA.EFFDT	                              	                                             
	                                   ,LEOAREA.DESCR                                                                               
	                                   ,LEOAREA.GVT_LEO_PCT                                                                         
	                                   ,GEOTAB.GVT_LOCALITY_AREA		                	                                               
	                                   ,LOCAREA.EFFDT                                                                               
	                                   ,LOCAREA.DESCR                                                                               
	                                   ,LOCAREA.GVT_LOCALITY_PCT                                                                    
	                                   ,LOCAREA.GVT_IGA_PCT                	                                                       
	                                   ,PYPCT.Z_FOR_DIFF_PCT                                                                                                                                                                       
	                                   ,JOB.EMPLID           
	                                   ,JOB.EMPL_RCD         
	                                   ,JOB.NAME        
	                                   ,JOB.EMAIL_ADDR       
	                                   ,JOB.GVT_WIP_STATUS                         
	                                   ,NULL                 
	                                   ,JOB.GVT_STATUS_TYPE                        
	                                   ,NULL                  
	                                   ,JOB.GVT_NOA_CODE                                                        
	                                   ,JOB.EFFDT                                  
	                                   ,JOB.EFFSEQ     
	                                   ,FUTJOB.EMPLID           
	                                   ,FUTJOB.EMPL_RCD            
	                                   ,FUTJOB.GVT_WIP_STATUS                         
	                                   ,NULL                 
	                                   ,FUTJOB.GVT_STATUS_TYPE                        
	                                   ,NULL                  
	                                   ,FUTJOB.GVT_NOA_CODE                                                        
	                                   ,FUTJOB.EFFDT                                  
	                                   ,FUTJOB.EFFSEQ  
	                                   ,COALESCE(SF50COR.SF50_TRANSACTION_CONTROL_ID,SF50.SF50_TRANSACTION_CONTROL_ID)
	                                   ,sf50.TRANSACTION_STATUS
	                                   ,PS_Z_MSS_CRPOS_DAT.Z_ADMIN_POC  
	                                   ,oprzadm.OPRDEFNDESC
	                                   ,oprzadm.EMPLID
	                                   ,oprzadm.EMAILID   
	                                   ,PS_Z_MSS_CRPOS_DAT.Z_ALT_HIRE_MGR    
	                                   ,oprzalt.OPRDEFNDESC
	                                   ,oprzalt.EMPLID
	                                   ,oprzalt.EMAILID      
	                                   ,PS_Z_MSS_CRPOS_DAT.Z_HR_SPECIALIST 
	                                   ,case when PS_AUDIT_Z_MSS_REC_APPR.AUDIT_STAMP IS NULL OR PS_AUDIT_Z_MSS_REC_APPR.AUDIT_STAMP < '2022-08-01' then star.HR_CONSULTANT  else oprzhrs.OPRDEFNDESC end                            
	                                   ,oprzhrs.EMPLID
	                                   ,oprzhrs.EMAILID        
	                                   ,PS_Z_MSS_CRPOS_DAT.Z_NRC_SPECIALIST   
	                                   ,case when PS_AUDIT_Z_MSS_REC_APPR.AUDIT_STAMP IS NULL OR PS_AUDIT_Z_MSS_REC_APPR.AUDIT_STAMP < '2022-08-01' then star.NRC_CONSULTANT  else oprznrc.OPRDEFNDESC end                             
	                                   ,oprznrc.EMPLID
	                                   ,oprznrc.EMAILID
	                       FROM        PS_Z_MSS_CRPOS_DAT
	                                   INNER JOIN PS_Z_MSSCRPOS_XREF   ON     PS_Z_MSSCRPOS_XREF.TRANSACTION_NBR     = PS_Z_MSS_CRPOS_DAT.TRANSACTION_NBR   AND PS_Z_MSSCRPOS_XREF.EOAWPRCS_ID LIKE '%MSSNewPosition'  
	                                   INNER JOIN PS_Z_MSS_RECRUIT     ON     PS_Z_MSS_RECRUIT.TRANSACTION_NBR       = PS_Z_MSS_CRPOS_DAT.TRANSACTION_NBR   AND PS_Z_MSS_RECRUIT.Z_TRANS_TYPE =  'NEW'
	                                   LEFT  JOIN PS_AUDIT_Z_CRPOS_D    PS_AUDIT_Z_CRPOS_D_LAT        ON     PS_AUDIT_Z_CRPOS_D_LAT.TRANSACTION_NBR      = PS_Z_MSS_CRPOS_DAT.TRANSACTION_NBR    
	                                                                                                  AND    PS_AUDIT_Z_CRPOS_D_LAT.AUDIT_STAMP   = ( SELECT MAX(PS_AUDIT_Z_CRPOS_D_LAT_ED.AUDIT_STAMP) FROM PS_AUDIT_Z_CRPOS_D PS_AUDIT_Z_CRPOS_D_LAT_ED
	                                                                                                                                                         WHERE    PS_Z_MSS_CRPOS_DAT.TRANSACTION_NBR      = PS_AUDIT_Z_CRPOS_D_LAT_ED.TRANSACTION_NBR )
	                                   LEFT  JOIN PS_AUDIT_Z_CRPOS_D    PS_AUDIT_Z_CRPOS_D_APPR       ON     PS_AUDIT_Z_CRPOS_D_APPR.TRANSACTION_NBR     = PS_Z_MSS_CRPOS_DAT.TRANSACTION_NBR    AND PS_AUDIT_Z_CRPOS_D_APPR.AUDIT_ACTN    = 'A'     
	                                                                                                  AND    PS_AUDIT_Z_CRPOS_D_APPR.AUDIT_STAMP   = ( SELECT MAX(PS_AUDIT_Z_CRPOS_D_APPR_ED.AUDIT_STAMP) FROM PS_AUDIT_Z_CRPOS_D PS_AUDIT_Z_CRPOS_D_APPR_ED
	                                                                                                                                                         WHERE       PS_AUDIT_Z_CRPOS_D_APPR_ED.AUDIT_ACTN    = 'A'
	                                                                                                                                                                AND  PS_Z_MSS_CRPOS_DAT.TRANSACTION_NBR      = PS_AUDIT_Z_CRPOS_D_APPR_ED.TRANSACTION_NBR )
	                                   LEFT  JOIN PS_AUDIT_Z_MSS_REC    PS_AUDIT_Z_MSS_REC_LAT        ON     PS_AUDIT_Z_MSS_REC_LAT.TRANSACTION_NBR      = PS_Z_MSS_CRPOS_DAT.TRANSACTION_NBR   AND PS_AUDIT_Z_MSS_REC_LAT.Z_TRANS_TYPE = 'NEW' 
	                                                                                                  AND    PS_AUDIT_Z_MSS_REC_LAT.AUDIT_STAMP   = ( SELECT MAX(PS_AUDIT_Z_MSS_REC_LAT_ED.AUDIT_STAMP) FROM PS_AUDIT_Z_MSS_REC PS_AUDIT_Z_MSS_REC_LAT_ED
	                                                                                                                                                         WHERE    PS_Z_MSS_CRPOS_DAT.TRANSACTION_NBR      = PS_AUDIT_Z_MSS_REC_LAT_ED.TRANSACTION_NBR 
	                                                                                                                                                         AND      PS_AUDIT_Z_MSS_REC_LAT_ED.Z_TRANS_TYPE = 'NEW'   )
	                                   LEFT  JOIN PS_AUDIT_Z_MSS_REC    PS_AUDIT_Z_MSS_REC_CANCEL     ON     PS_AUDIT_Z_MSS_REC_CANCEL.TRANSACTION_NBR   = PS_Z_MSS_CRPOS_DAT.TRANSACTION_NBR AND PS_AUDIT_Z_MSS_REC_CANCEL.AUDIT_ACTN = 'C' AND PS_AUDIT_Z_MSS_REC_CANCEL.Z_TRANS_TYPE = 'NEW' AND  PS_AUDIT_Z_MSS_REC_CANCEL.Z_RECRUIT_CANCEL   = 'Y'            
	                                                                                                  AND    PS_AUDIT_Z_MSS_REC_CANCEL.AUDIT_STAMP   = ( SELECT MIN(PS_AUDIT_Z_MSS_REC_CANCEL_ED.AUDIT_STAMP) FROM PS_AUDIT_Z_MSS_REC PS_AUDIT_Z_MSS_REC_CANCEL_ED
	                                                                                                                                                         WHERE       PS_AUDIT_Z_MSS_REC_CANCEL_ED.AUDIT_ACTN    = 'C'
	                                                                                                                                                                AND  PS_AUDIT_Z_MSS_REC_CANCEL_ED.Z_RECRUIT_CANCEL   = 'Y'            
	                                                                                                                                                                AND  PS_AUDIT_Z_MSS_REC_CANCEL_ED.Z_TRANS_TYPE = 'NEW'   
	                                                                                                                                                                AND  PS_AUDIT_Z_MSS_REC_CANCEL_ED.TRANSACTION_NBR      = PS_Z_MSS_CRPOS_DAT.TRANSACTION_NBR 
	                                                                                                                                                                AND  NOT EXISTS ( SELECT 'X' FROM PS_AUDIT_Z_MSS_REC PS_AUDIT_Z_MSS_REC_CANCEL_EX
	                                                                                                                                                                                   WHERE       PS_AUDIT_Z_MSS_REC_CANCEL_EX.AUDIT_ACTN    = 'C'                                      
	                                                                                                                                                                                          AND  PS_AUDIT_Z_MSS_REC_CANCEL_EX.Z_RECRUIT_CANCEL     = 'N'                                 
	                                                                                                                                                                                          AND  PS_AUDIT_Z_MSS_REC_CANCEL_EX.Z_TRANS_TYPE     = 'NEW'                                 
	                                                                                                                                                                                          AND  PS_AUDIT_Z_MSS_REC_CANCEL_EX.TRANSACTION_NBR      = PS_Z_MSS_CRPOS_DAT.TRANSACTION_NBR
	                                                                                                                                                                                          AND  PS_AUDIT_Z_MSS_REC_CANCEL_ED.AUDIT_STAMP > PS_AUDIT_Z_MSS_REC_CANCEL.AUDIT_STAMP  )   
	                                                                                                                                                                                )
	                                   LEFT  JOIN PS_AUDIT_Z_MSS_REC    PS_AUDIT_Z_MSS_REC_APPR       ON     PS_AUDIT_Z_MSS_REC_APPR.TRANSACTION_NBR     = PS_Z_MSS_CRPOS_DAT.TRANSACTION_NBR    AND PS_AUDIT_Z_MSS_REC_APPR.AUDIT_ACTN    = 'A'   AND PS_AUDIT_Z_MSS_REC_APPR.Z_TRANS_TYPE = 'NEW'    
	                                                                                                  AND    PS_AUDIT_Z_MSS_REC_APPR.AUDIT_STAMP   = ( SELECT MAX(PS_AUDIT_Z_MSS_REC_APPR_ED.AUDIT_STAMP) FROM PS_AUDIT_Z_MSS_REC PS_AUDIT_Z_MSS_REC_APPR_ED
	                                                                                                                                                         WHERE       PS_AUDIT_Z_MSS_REC_APPR_ED.AUDIT_ACTN    = 'A'
	                                                                                                                                                                AND  PS_AUDIT_Z_MSS_REC_APPR_ED.Z_TRANS_TYPE = 'NEW'    
	                                                                                                                                                                AND  PS_Z_MSS_CRPOS_DAT.TRANSACTION_NBR     = PS_AUDIT_Z_MSS_REC_APPR_ED.TRANSACTION_NBR )
	                                   LEFT  JOIN PS_AUDIT_Z_MSS_REC    PS_AUDIT_Z_MSS_REC_LAT_APPR   ON     PS_AUDIT_Z_MSS_REC_LAT_APPR.TRANSACTION_NBR   = PS_Z_MSS_CRPOS_DAT.TRANSACTION_NBR  AND PS_AUDIT_Z_MSS_REC_LAT_APPR.Z_TRANS_TYPE = 'NEW' 
	                                                                                                          AND PS_AUDIT_Z_MSS_REC_LAT_APPR.AUDIT_ACTN    = 'C' AND PS_AUDIT_Z_MSS_REC_LAT_APPR.Z_RECRUIT_CANCEL   = 'N'     
	                                                                                                  AND    PS_AUDIT_Z_MSS_REC_LAT_APPR.AUDIT_STAMP       = ( SELECT    MIN(PS_AUDIT_Z_MSS_REC_CANCEL_ED.AUDIT_STAMP) FROM PS_AUDIT_Z_MSS_REC PS_AUDIT_Z_MSS_REC_CANCEL_ED
	                                                                                                                                                             WHERE   PS_AUDIT_Z_MSS_REC_CANCEL_ED.AUDIT_ACTN    = 'C'
	                                                                                                                                                                AND  PS_AUDIT_Z_MSS_REC_CANCEL_ED.Z_RECRUIT_CANCEL   = 'N'            
	                                                                                                                                                                AND  PS_AUDIT_Z_MSS_REC_CANCEL_ED.Z_TRANS_TYPE = 'NEW'   
	                                                                                                                                                                AND  PS_Z_MSS_CRPOS_DAT.TRANSACTION_NBR      = PS_AUDIT_Z_MSS_REC_CANCEL_ED.TRANSACTION_NBR
	                                                                                                                                                                AND  PS_AUDIT_Z_MSS_REC_CANCEL_ED.AUDIT_STAMP >= PS_AUDIT_Z_MSS_REC_CANCEL.AUDIT_STAMP  )
	                                   LEFT   JOIN PS_DEPT_TBL          DEPT  on DEPT.deptid   = PS_Z_MSS_CRPOS_DAT.deptid and DEPT.SETID   = 'GSASH' and DEPT.EFFDT =  (SELECT MAX(DEP_ED.EFFDT) FROM PS_DEPT_TBL DEP_ED
	                                                                                                                                               WHERE DEP_ED.SETID  = 'GSASH'
	                                                                                                                                                 AND DEP_ED.DEPTID = PS_Z_MSS_CRPOS_DAT.deptid
	                                                                                                                                                 AND DEP_ED.EFFDT <=  COALESCE(PS_AUDIT_Z_MSS_REC_APPR.AUDIT_STAMP,PS_Z_MSS_CRPOS_DAT.REQUEST_DT ))  
	                                   LEFT OUTER JOIN PS_Z_DEPT_TBL ZDEPT ON ZDEPT.SETID = 'GSASH' AND ZDEPT.DEPTID = PS_Z_MSS_CRPOS_DAT.DEPTID                    
	                                                                          AND   ZDEPT.EFFDT = 
	                                                                                        (SELECT MAX(ZDEPT_ED.EFFDT) FROM ps_dept_tbl ZDEPT_ED 
	                                                                                          WHERE ZDEPT_ED.DEPTID = PS_Z_MSS_CRPOS_DAT.DEPTID
	                                                                                            AND ZDEPT_ED.SETID  = 'GSASH'                     
	                                                                                            AND ZDEPT_ED.EFFDT <= COALESCE(PS_AUDIT_Z_MSS_REC_APPR.AUDIT_STAMP,PS_Z_MSS_CRPOS_DAT.REQUEST_DT ))
	                                  LEFT OUTER JOIN ps_location_tbl     LOC     ON  LOC.LOCATION = PS_Z_MSS_CRPOS_DAT.LOCATION                              
	                                                                               AND LOC.SETID    = 'GSASH'       
	                                  	                                           AND LOC.EFFDT    = (SELECT MAX(LOC_ED.EFFDT) 
	                                  	                                                                  FROM ps_location_tbl LOC_ED              
	                                  		                                                              	WHERE LOC_ED.LOCATION  = PS_Z_MSS_CRPOS_DAT.LOCATION                
	                                                                                                        AND LOC_ED.SETID     = 'GSASH'                                                  
	                                  		                                                                	AND LOC_ED.EFFDT <=COALESCE(PS_AUDIT_Z_MSS_REC_APPR.AUDIT_STAMP,PS_Z_MSS_CRPOS_DAT.REQUEST_DT )  ) 
	                                  LEFT OUTER JOIN  PS_GVT_GEOLOC_TBL GEOTAB on GEOTAB.GVT_GEOLOC_CD = LOC.GVT_GEOLOC_CD
	                                  	                                      AND GEOTAB.EFFDT = (SELECT MAX(GEOTAB_ED.EFFDT) FROM PS_GVT_GEOLOC_TBL GEOTAB_ED
	                                                                                                WHERE GEOTAB_ED.GVT_GEOLOC_CD = LOC.GVT_GEOLOC_CD
	                                                                                                AND   GEOTAB_ED.EFFDT     <= COALESCE(PS_AUDIT_Z_MSS_REC_APPR.AUDIT_STAMP,PS_Z_MSS_CRPOS_DAT.REQUEST_DT ) )                            
	                                 LEFT OUTER JOIN  nhrdw_custom_xlatitem todsr on  todsr.FIELDNAME  = 'GSA_DUTY_STATION_REGION' and todsr.FIELDVALUE = SUBSTR(LOC.GVT_GEOLOC_CD,1,2) and  todsr.X_FIELDNAME    = 'GSA_REGION'
	                                                                         AND todsr.EFFDT =(SELECT MAX(todsr_ED.EFFDT) FROM nhrdw_custom_xlatitem todsr_ED
	                                                                                           WHERE todsr_ED.FIELDVALUE = SUBSTR(LOC.GVT_GEOLOC_CD,1,2)
			                                                                                     AND todsr_ED.X_FIELDNAME  = 'GSA_REGION' 
			                                                                                     and todsr_ED.FIELDNAME    = 'GSA_DUTY_STATION_REGION'
	                                                                                             AND todsr_ED.EFFDT       <= COALESCE(PS_AUDIT_Z_MSS_REC_APPR.AUDIT_STAMP,PS_Z_MSS_CRPOS_DAT.REQUEST_DT ))
	                                 LEFT OUTER JOIN nhrdw_custom_xlatitem todsrc on todsrc.FIELDNAME      = 'GSA_DUTY_STATION_REGION_BY_CODE' AND todsrc.FIELDVALUE     = LOC.GVT_GEOLOC_CD AND todsrc.X_FIELDNAME    = 'GSA_REGION'
	                                           AND todsrc.EFFDT =
	                                                              (SELECT MAX(xlat_ED.EFFDT) FROM nhrdw_custom_xlatitem xlat_ED
	                                                               WHERE xlat_ED.FIELDVALUE     = LOC.GVT_GEOLOC_CD
		                                                	            AND xlat_ED.FIELDNAME      = 'GSA_DUTY_STATION_REGION_BY_CODE'
		                                                             	and xlat_ED.X_FIELDNAME    = 'GSA_REGION'
	                                                                AND xlat_ED.EFFDT       <= COALESCE(PS_AUDIT_Z_MSS_REC_APPR.AUDIT_STAMP,PS_Z_MSS_CRPOS_DAT.REQUEST_DT ))    
	                                  LEFT OUTER JOIN  nhrdw_custom_xlatitem togsr on  togsr.FIELDNAME  = 'GSA_REGION' and togsr.FIELDVALUE = COALESCE(todsrc.X_FIELDVALUE,todsr.X_FIELDVALUE)
	                                                             AND togsr.EFFDT =(SELECT MAX(togsr_ED.EFFDT) FROM nhrdw_custom_xlatitem togsr_ED
	                                                                               WHERE togsr_ED.FIELDVALUE = COALESCE(todsrc.X_FIELDVALUE,todsr.X_FIELDVALUE)
			                                                                         AND togsr_ED.FIELDNAME  = 'GSA_REGION' 
	                                                                                 AND togsr_ED.EFFDT       <= COALESCE(PS_AUDIT_Z_MSS_REC_APPR.AUDIT_STAMP,PS_Z_MSS_CRPOS_DAT.REQUEST_DT ))	
	                                  LEFT OUTER JOIN   PS_GVT_LEOAREA_TBL LEOAREA ON LEOAREA.GVT_LEOPAY_AREA = GEOTAB.GVT_LEOPAY_AREA
	                                                                            AND LEOAREA.EFFDT = (SELECT MAX(LEOAREA_ED.EFFDT) 
	                                                                                                 FROM   PS_GVT_LEOAREA_TBL LEOAREA_ED
	                                                                                                WHERE   LEOAREA_ED.GVT_LEOPAY_AREA = GEOTAB.GVT_LEOPAY_AREA
	                                                                                                  AND   LEOAREA_ED.EFFDT <= COALESCE(PS_AUDIT_Z_MSS_REC_APPR.AUDIT_STAMP,PS_Z_MSS_CRPOS_DAT.REQUEST_DT ) )      	         
	                                  LEFT OUTER JOIN  PS_GVT_LOCAREA_TBL LOCAREA ON  LOCAREA.GVT_LOCALITY_AREA = GEOTAB.GVT_LOCALITY_AREA 
	                                                                           AND  LOCAREA.EFFDT = (SELECT MAX(LOCAREA_ED.EFFDT) 
	                                                                                                 FROM   PS_GVT_LOCAREA_TBL LOCAREA_ED 
	                                                                                                 WHERE  LOCAREA_ED.GVT_LOCALITY_AREA = GEOTAB.GVT_LOCALITY_AREA
	                                                                                                   AND    LOCAREA_ED.EFFDT <= COALESCE(PS_AUDIT_Z_MSS_REC_APPR.AUDIT_STAMP,PS_Z_MSS_CRPOS_DAT.REQUEST_DT ) ) 
	                                  LEFT OUTER JOIN PS_Z_LOC_PYPCT_TBL   PYPCT ON    PYPCT.LOCATION = PS_Z_MSS_CRPOS_DAT.LOCATION                              
	                                                                               AND PYPCT.SETID    = 'GSASH' 
	                                                                               AND PYPCT.eff_status = 'A'
	                                                                               AND PYPCT.ERNCD    = 'COL'         
	                                  	                                           AND PYPCT.EFFDT    = (SELECT MAX(PYPCT_ED.EFFDT) 
	                                  	                                                                  FROM PS_Z_LOC_PYPCT_TBL PYPCT_ED             
	                                  		                                                              	WHERE PYPCT_ED.LOCATION  = PS_Z_MSS_CRPOS_DAT.LOCATION                          
	                                                                                                        AND PYPCT_ED.SETID     = 'GSASH'    
	                                                                                                        AND PYPCT_ED.eff_status = 'A'
	                                                                                                        AND PYPCT_ED.ERNCD    = 'COL'                                                   
	                                  		                                                                	AND PYPCT_ED.EFFDT <= COALESCE(PS_AUDIT_Z_MSS_REC_APPR.AUDIT_STAMP,PS_Z_MSS_CRPOS_DAT.REQUEST_DT ) ) 
	                                   LEFT OUTER JOIN  PS_Z_POSITION_DATA ZPOS on  ZPOS.position_nbr = PS_Z_MSS_CRPOS_DAT.position_nbr   and ZPOS.Z_TEXT254_3 = PS_Z_MSS_CRPOS_DAT.TRANSACTION_NBR AND ZPOS.Z_TEXT254_4 = 'NEW'           
	                      		                           AND ZPOS.EFFDT  =                                      
	                      		                              (SELECT MIN(ZPOS_ED.EFFDT) FROM PS_Z_POSITION_DATA ZPOS_ED
	                      		                               WHERE ZPOS_ED.position_nbr = PS_Z_MSS_CRPOS_DAT.position_nbr     
	                      		                               AND  ZPOS_ED.Z_TEXT254_3 = PS_Z_MSS_CRPOS_DAT.TRANSACTION_NBR 
	                      		                               AND ZPOS_ED.Z_TEXT254_4 = 'NEW'  )               
	--                      		                               AND ZPOS_ED.EFFDT >= COALESCE( DATE_FORMAT(PS_AUDIT_Z_MSS_REC_APPR.AUDIT_STAMP,'%Y-%m-%d'),PS_Z_MSS_CRPOS_DAT.REQUEST_DT ) ) 	
	                                   LEFT OUTER JOIN  PS_POSITION_DATA TOPOS on  TOPOS.position_nbr = PS_Z_MSS_CRPOS_DAT.position_nbr               
	                      		                           AND TOPOS.EFFDT  =                                      
	                      		                              (SELECT MAX(POS_ED.EFFDT) FROM PS_POSITION_DATA POS_ED
	                      		                               WHERE POS_ED.position_nbr = PS_Z_MSS_CRPOS_DAT.position_nbr          
	                      		                               AND POS_ED.EFFDT <= ZPOS.EFFDT ) 	                                  		                                                                	
	                                  left outer join nhrdw_custom_xlatitem senscd on senscd.FIELDVALUE = TOPOS.gvt_posn_sens_cd and senscd.FIELDNAME  = 'GVT_POSN_SENS_CD' 
	                                                              AND senscd.EFFDT =
	                                                                      (SELECT MAX(xlat_ED.EFFDT) FROM nhrdw_custom_xlatitem xlat_ED
	                                                                       WHERE xlat_ED.FIELDVALUE = TOPOS.gvt_posn_sens_cd 
	                             		                                        AND xlat_ED.FIELDNAME  = 'GVT_POSN_SENS_CD'  
	                                                                         AND xlat_ED.EFFDT      <= TOPOS.EFFDT)
	                                  left outer join nhrdw_custom_xlatitem invest on invest.FIELDVALUE = senscd.X_FIELDVALUE and invest.FIELDNAME  = senscd.X_FIELDNAME
	                                                              AND invest.EFFDT =
	                                                                      (SELECT MAX(xlat_ED.EFFDT) FROM nhrdw_custom_xlatitem xlat_ED
	                                                                       WHERE xlat_ED.FIELDVALUE = senscd.X_FIELDVALUE
	                             		                                        AND xlat_ED.FIELDNAME  = senscd.X_FIELDNAME
	                                                                         AND xlat_ED.EFFDT      <= TOPOS.EFFDT)
	                                  LEFT OUTER JOIN nhrdw_occ_series_addl_info tooca on tooca.GVT_OCC_SERIES=topos.GVT_OCC_SERIES  and tooca.SETID = dept.SETID
	                                                                         and tooca.EFFDT = (SELECT MAX(tooca_ed.EFFDT)
	                                                  FROM  nhrdw_occ_series_addl_info tooca_ed
	                                                  WHERE  tooca_ed.SETID          = dept.SETID
	                                                  AND    tooca_ed.GVT_OCC_SERIES = topos.GVT_OCC_SERIES    
	                                                  AND    tooca_ed.EFFDT <= topos.effdt )  
	                                   LEFT OUTER JOIN ps_gvt_occupation  toocc ON toocc.GVT_OCC_SERIES = topos.GVT_OCC_SERIES                                                               
	                                    	                                          AND  toocc.EFFDT =                                                                        
	                                                                                             (SELECT MAX(toocc_ed.EFFDT) FROM ps_gvt_occupation toocc_ed            
	                                                                                             WHERE toocc_ed.GVT_OCC_SERIES = topos.GVT_OCC_SERIES                   
	                                                                                               AND toocc_ed.EFFDT     <=topos.effdt)                                      
	                                   LEFT OUTER JOIN PS_SET_CNTRL_REC TOSPC ON       TOSPC.SETCNTRLVALUE = topos.BUSINESS_UNIT
	                                                                  AND TOSPC.RECNAME = 'SUPVSR_LVL_TBL'  
	                                   LEFT OUTER JOIN PS_SUPVSR_LVL_TBL TOSUP ON              TOSUP.SUPV_LVL_ID = topos.SUPV_LVL_ID  and TOSUP.SETID = TOSPC.setid
	                                                                                            AND TOSUP.EFFDT =
	                                                                                                 ( SELECT MAX(TOSUP_ED.EFFDT) FROM PS_SUPVSR_LVL_TBL TOSUP_ED
	                                                                                                   WHERE TOSUP_ED.SETID = TOSPC.setid
	                                                                                                     AND TOSUP_ED.SUPV_LVL_ID = topos.SUPV_LVL_ID
	                                                                                                     AND TOSUP_ED.EFFDT <= topos.effdt )  
	                                   LEFT OUTER JOIN  psxlatitem topat on  topat.FIELDNAME  = 'GVT_PATCOB_CD' and topat.FIELDVALUE = TOOCC.GVT_PATCOB_CD	
	                                                                           AND topat.EFFDT =(SELECT MAX(xlat_ED.EFFDT) FROM psxlatitem xlat_ED
	                                                                                             WHERE xlat_ED.FIELDVALUE = TOOCC.GVT_PATCOB_CD	
			                                                                                       AND xlat_ED.FIELDNAME  = 'GVT_PATCOB_CD' 
	                                                                                               AND xlat_ED.EFFDT       <= topos.effdt)			
	                                   LEFT OUTER JOIN  psxlatitem tosen on  tosen.FIELDNAME  = 'GVT_POSN_SENS_CD' and tosen.FIELDVALUE = topos.GVT_POSN_SENS_CD
	                                                                           AND tosen.EFFDT =(SELECT MAX(xlat_ED.EFFDT) FROM psxlatitem xlat_ED
	                                                                                             WHERE xlat_ED.FIELDVALUE = topos.GVT_POSN_SENS_CD
			                                                                                       AND xlat_ED.FIELDNAME  = 'GVT_POSN_SENS_CD' 
	                                                                                               AND xlat_ED.EFFDT       <= topos.effdt)	
	                                   LEFT OUTER JOIN PS_GVT_POI_TBL POI on POI.GVT_POI= PS_Z_MSS_CRPOS_DAT.GVT_POI                 
	                                                          AND POI.EFFDT=                                 
	                                                                (SELECT MAX(topoi_ed.EFFDT)                
	                                                                 FROM   PS_GVT_POI_TBL topoi_ed            
	                                                                 WHERE  topoi_ed.GVT_POI  =PS_Z_MSS_CRPOS_DAT.GVT_POI 
	                                                                 AND    topoi_ed.EFFDT <= COALESCE(PS_AUDIT_Z_MSS_REC_APPR.AUDIT_STAMP,PS_Z_MSS_CRPOS_DAT.REQUEST_DT ) )
	                                 LEFT OUTER JOIN nhrdw_hrlinks_employee_completed_history job on job.POSITION_NBR = PS_Z_MSS_CRPOS_DAT.REPORTS_TO
	                            	                	AND job.LATEST_HIRE_DATE = (SELECT MAX(J_ET.LATEST_HIRE_DATE) FROM nhrdw_hrlinks_employee_completed_history J_ET                                                                                                           
	                            	                                 		WHERE J_ET.POSITION_NBR = PS_Z_MSS_CRPOS_DAT.REPORTS_TO                                                                                                                                                                                                                                                       
	                                                                    AND J_ET.SETID_DEPT = job.SETID_DEPT 
	                                                                  ) 
	                            		                 AND job.EFFDT =                                                                                                                                                      
	                                                          			(SELECT MAX(J_ED.EFFDT) FROM nhrdw_hrlinks_employee_completed_history J_ED                                                                                                            
	                                                             			WHERE J_ED.POSITION_NBR   = PS_Z_MSS_CRPOS_DAT.REPORTS_TO    
	                                                             --			  AND J_ED.EMPLID         = job.EMPLID                                                                                                              
	                            	                               --   		AND J_ED.EMPL_RCD       = job.EMPL_RCD   
	                            	                                  		AND J_ED.LATEST_HIRE_DATE = job.LATEST_HIRE_DATE
	                            			                                  AND J_ED.GVT_WIP_STATUS in ('PRO','COR')  
	                                                                    AND J_ED.SETID_DEPT = job.SETID_DEPT                                                                                                                       			                                                                                                                                    
	                            			                                  AND J_ED.EFFDT <= COALESCE(PS_AUDIT_Z_MSS_REC_APPR.AUDIT_STAMP,PS_Z_MSS_CRPOS_DAT.REQUEST_DT ))                                                                                                                             
	                            	                	AND job.EFFSEQ = (SELECT MAX(J_ES.EFFSEQ) FROM nhrdw_hrlinks_employee_completed_history J_ES                                                                                                           
	                            	                                 		WHERE J_ES.EMPLID       = job.EMPLID    
	                            	                                 		  AND J_ES.POSITION_NBR = PS_Z_MSS_CRPOS_DAT.REPORTS_TO                                                                                                                             
	                                                                		AND J_ES.EMPL_RCD     = job.EMPL_RCD                                                                                                                             
	                                                                    AND J_ES.SETID_DEPT   = job.SETID_DEPT 
	                                                                    AND J_ES.EFFDT        = JOB.EFFDT
	                                                                    AND J_ES.LATEST_HIRE_DATE = job.LATEST_HIRE_DATE 
	                                                                  )                                                                     
	/*
	                                 LEFT OUTER JOIN nhrdw_hrlinks_employee_all_history futjob on futjob.GVT_SF52_NBR = CONCAT(PS_Z_MSS_CRPOS_DAT.TRANSACTION_NBR,'C') 
	                            		                 AND futjob.EFFDT =                                                                                                                                                      
	                                                          			(SELECT MIN(J_ED.EFFDT) FROM nhrdw_hrlinks_employee_all_history J_ED                                                                                                            
	                                                             			WHERE J_ED.GVT_SF52_NBR = CONCAT(PS_Z_MSS_CRPOS_DAT.TRANSACTION_NBR,'C')  
	                                                             --			  AND J_ED.EMPLID         = job.EMPLID                                                                                                              
	                            	                               --   		AND J_ED.EMPL_RCD       = job.EMPL_RCD                                                                                                                      			                                                                                                                                    
	                            			                                  AND J_ED.EFFDT <= COALESCE(PS_AUDIT_Z_MSS_REC_APPR.AUDIT_STAMP,PS_Z_MSS_CRPOS_DAT.REQUEST_DT )) 
	                            	                	AND futjob.EFFSEQ = (SELECT MAX(J_ES.EFFSEQ) FROM nhrdw_hrlinks_employee_all_history J_ES                                                                                                           
	                            	                                 		WHERE J_ES.EMPLID       = futjob.EMPLID    
	                            	                                 		  AND J_ES.GVT_SF52_NBR = CONCAT(PS_Z_MSS_CRPOS_DAT.TRANSACTION_NBR,'C')                                                                                                                        
	                                                                		AND J_ES.EMPL_RCD     = futjob.EMPL_RCD                                                                                                                             
	                                                                    AND J_ES.SETID_DEPT   = futjob.SETID_DEPT 
	                                                                    AND J_ES.EFFDT        = futjob.EFFDT
	                                                                  )   
	*/
	/*
	                                 LEFT OUTER JOIN nhrdw_hrlinks_employee_all_history futjob on futjob.POSITION_NBR = PS_Z_MSS_CRPOS_DAT.POSITION_NBR
	                            		                 AND futjob.EFFDT =                                                                                                                                                      
	                                                          			(SELECT MIN(J_ED.EFFDT) FROM nhrdw_hrlinks_employee_all_history J_ED                                                                                                            
	                                                             			WHERE J_ED.POSITION_NBR = PS_Z_MSS_CRPOS_DAT.POSITION_NBR
	                                                             --			  AND J_ED.EMPLID         = job.EMPLID                                                                                                              
	                            	                               --   		AND J_ED.EMPL_RCD       = job.EMPL_RCD                                                                                                                      			                                                                                                                                    
	                            			                                  AND J_ED.EFFDT >= COALESCE(PS_AUDIT_Z_MSS_REC_APPR.AUDIT_STAMP,PS_Z_MSS_CRPOS_DAT.REQUEST_DT )) 
	                            		                 AND futjob.EMPLID =                                                                                                                                                      
	                                                          			(SELECT MAX(J_ED.EMPLID) FROM nhrdw_hrlinks_employee_all_history J_ED                                                                                                            
	                                                             			WHERE J_ED.POSITION_NBR = PS_Z_MSS_CRPOS_DAT.POSITION_NBR
	                                                             --			  AND J_ED.EMPLID         = job.EMPLID                                                                                                              
	                            	                               --   		AND J_ED.EMPL_RCD       = job.EMPL_RCD                                                                                                                      			                                                                                                                                    
	                            			                                  AND J_ED.EFFDT = futjob.EFFDT ) 
	                            	                	AND futjob.EFFSEQ = (SELECT MAX(J_ES.EFFSEQ) FROM nhrdw_hrlinks_employee_all_history J_ES                                                                                                           
	                            	                                 		WHERE J_ES.EMPLID       = futjob.EMPLID    
	                            	                                 		  AND J_ES.POSITION_NBR = PS_Z_MSS_CRPOS_DAT.POSITION_NBR                                                                                                                  
	                                                                		AND J_ES.EMPL_RCD     = futjob.EMPL_RCD                                                                                                                             
	                                                                    AND J_ES.SETID_DEPT   = futjob.SETID_DEPT 
	                                                                    AND J_ES.EFFDT        = futjob.EFFDT
	                                                                  ) 
	*/                                                                  
	                                  LEFT OUTER JOIN  PS_Z_T38_JOB ON PS_Z_T38_JOB.Z_TRANS_TYPE = 'NEW' and PS_Z_T38_JOB.Z_TRANS_NBR  = PS_Z_MSS_CRPOS_DAT.TRANSACTION_NBR
	                                                 AND EXISTS ( SELECT 'X' FROM PS_GVT_JOB GJ
	                            	                                 		WHERE GJ.EMPLID       = PS_Z_T38_JOB.EMPLID    
	                                                                		AND GJ.EMPL_RCD     = PS_Z_T38_JOB.EMPL_RCD                                                                                                                             
	                            	                                  		AND GJ.EFFSEQ       = PS_Z_T38_JOB.EFFSEQ          
	                            	                                  		AND GJ.POSITION_NBR = PS_Z_MSS_CRPOS_DAT.POSITION_NBR
	                                                                    AND GJ.EFFDT        = PS_Z_T38_JOB.EFFDT
	                                                                    AND GJ.GVT_WIP_STATUS IN ('PRO','COR','WIP','INI')
	                                                             )        
	                            		                 AND PS_Z_T38_JOB.EFFDT =                                                                                                                                                      
	                                                          			(SELECT MIN(J_ED.EFFDT) FROM PS_Z_T38_JOB J_ED                                                                                                            
	                                                             			WHERE J_ED.Z_TRANS_TYPE = 'NEW'
	                            	                                  		AND J_ED.Z_TRANS_NBR  = PS_Z_MSS_CRPOS_DAT.TRANSACTION_NBR
	                            	                                  		AND J_ED.EFFDT          >= COALESCE(PS_AUDIT_Z_MSS_REC_APPR.AUDIT_STAMP,PS_Z_MSS_CRPOS_DAT.REQUEST_DT ) 
	                            	                                  ) 
	/*
	                            		                 AND PS_Z_T38_JOB.EFFDT =                                                                                                                                                      
	                                                          			(SELECT MAX(J_ED.EFFDT) FROM PS_Z_T38_JOB J_ED                                                                                                            
	                                                             			WHERE J_ED.EMPLID         = PS_Z_T38_JOB.EMPLID                                                                                                           
	                            	                                  		AND J_ED.EMPL_RCD       = PS_Z_T38_JOB.EMPL_RCD   
	                            	                                  		AND J_ED.Z_TRANS_TYPE = 'NEW'
	                            	                                  		AND J_ED.Z_TRANS_NBR  = PS_Z_MSS_CRPOS_DAT.TRANSACTION_NBR
	                            	                                  		AND J_ED.EFFDT          >= COALESCE(PS_AUDIT_Z_MSS_REC_APPR.AUDIT_STAMP,PS_Z_MSS_CRPOS_DAT.REQUEST_DT )  
	                            	                                  )  		                                                                                                            			                                                                                                                                    
	*/
	                            	                	AND PS_Z_T38_JOB.EFFSEQ = (SELECT MAX(J_ES.EFFSEQ) FROM PS_Z_T38_JOB J_ES                                                                                                           
	                            	                                 		WHERE J_ES.EMPLID       = PS_Z_T38_JOB.EMPLID    
	                                                                		AND J_ES.EMPL_RCD     = PS_Z_T38_JOB.EMPL_RCD                                                                                                                             
	                            	                                  		AND J_ES.Z_TRANS_TYPE = 'NEW'
	                            	                                  		AND J_ES.Z_TRANS_NBR  = PS_Z_MSS_CRPOS_DAT.TRANSACTION_NBR
	                                                                    AND J_ES.EFFDT        = PS_Z_T38_JOB.EFFDT
	                                                                  ) 
	                                  LEFT OUTER JOIN  nhrdw_hrlinks_employee_all_history futjob on futjob.EMPLID = PS_Z_T38_JOB.EMPLID AND futjob.EMPL_RCD       = PS_Z_T38_JOB.EMPL_RCD  AND  futjob.EFFDT = PS_Z_T38_JOB.EFFDT AND futjob.EFFSEQ = PS_Z_T38_JOB.EFFSEQ

	/*
	                            		                 AND futjob.EFFDT =                                                                                                                                                      
	                                                          			(SELECT MIN(J_ED.EFFDT) FROM nhrdw_hrlinks_employee_all_history J_ED                                                                                                            
	                                                             			WHERE J_ED.EMPLID         = PS_Z_T38_JOB.EMPLID                                                                                                           
	                            	                                  		AND J_ED.EMPL_RCD       = PS_Z_T38_JOB.EMPL_RCD      
	                            	                                  		AND J_ED.EFFDT          >= COALESCE(PS_AUDIT_Z_MSS_REC_APPR.AUDIT_STAMP,PS_Z_MSS_CRPOS_DAT.REQUEST_DT )  
	                            	                                  )  		                                                                                                            			                                                                                                                                    
	                            	                	AND futjob.EFFSEQ = (SELECT MAX(J_ES.EFFSEQ) FROM nhrdw_hrlinks_employee_all_history J_ES                                                                                                           
	                            	                                 		WHERE J_ES.EMPLID       = PS_Z_T38_JOB.EMPLID    
	                                                                		AND J_ES.EMPL_RCD     = PS_Z_T38_JOB.EMPL_RCD                                                                                                                             
	                                                                    AND J_ES.SETID_DEPT   = futjob.SETID_DEPT 
	                                                                    AND J_ES.EFFDT        = futjob.EFFDT
	                                                                  ) 
	*/
	                                 LEFT OUTER JOIN  NHRDW_SF50_TRANSACTION sf50     on  sf50.EMPLID = PS_Z_T38_JOB.EMPLID AND sf50.EMPL_RCD       = PS_Z_T38_JOB.EMPL_RCD  AND  sf50.EFFDT = PS_Z_T38_JOB.EFFDT AND sf50.EFFSEQ = PS_Z_T38_JOB.EFFSEQ
	                                 LEFT OUTER JOIN  NHRDW_SF50_TRANSACTION sf50cor  on sf50cor.EMPLID = PS_Z_T38_JOB.EMPLID AND sf50cor.EMPL_RCD       = PS_Z_T38_JOB.EMPL_RCD  AND  sf50cor.EFFDT = sf50.CORRECTED_ACTION_EFFDT AND sf50cor.EFFSEQ = sf50.CORRECTED_ACTION_EFFSEQ
	                                 LEFT OUTER JOIN  NHRDW_STAR_RECRUIT_ACTION star  on star.RPA_NUMBER  = concat(PS_Z_MSS_CRPOS_DAT.TRANSACTION_NBR,'C')
	                            	                	AND star.LASTUPDATETIMESTAMP = (SELECT MAX(J_STAR.LASTUPDATETIMESTAMP) FROM NHRDW_STAR_RECRUIT_ACTION J_STAR                                                                                                         
	                            	                                 	                	WHERE J_STAR.RPA_NUMBER       = star.RPA_NUMBER   
	                                                                               )                                                      
	                                 LEFT OUTER JOIN psoprdefn oprzadm on oprzadm.OPRID = PS_Z_MSS_CRPOS_DAT.Z_ADMIN_POC
	                                 LEFT OUTER JOIN psoprdefn oprzalt on oprzalt.OPRID = PS_Z_MSS_CRPOS_DAT.Z_ALT_HIRE_MGR
	                                 LEFT OUTER JOIN psoprdefn oprzhrs on oprzhrs.OPRID = PS_Z_MSS_CRPOS_DAT.Z_HR_SPECIALIST
	                                 LEFT OUTER JOIN psoprdefn oprznrc on oprznrc.OPRID = PS_Z_MSS_CRPOS_DAT.Z_NRC_SPECIALIST
	                       ;

	                      -- Populate Update Position Requests 

	                       call nhrdw_process_log_trk (-7001, 'I', 'Refresh SF52 MSS Requests :  Update Position ' );
	                                            
	                       INSERT INTO NEW_HRDW.NHRDW_SF52_REQUESTS
	                           (  
	                                    CADW_TRANSACTION_NBR                
	                                   ,TRANSACTION_TYPE         
	                                   ,TRANSACTION_NBR          
	                                   ,TRANSACTION_STATUS_CODE
	                                   ,TRANSACTION_STATUS_DESCR
	                                   ,REQ_POSITION_NBR             
	                                   ,REQUEST_DT               
	                                   ,REQ_FOURDIGIT_FISCAL_YEAR_OF_REQUEST_DT
	                                   ,REQ_FISCAL_YEAR_ACTION_REQUEST_DT            
	                                   ,REQ_ACTION                   
	                                   ,REQ_ACTION_REASON            
	                                   ,REQ_DEPTID                   
	                                   ,REQ_LOCATION                 
	                                   ,REQ_REPORTS_TO               
	                                   ,REQ_GVT_WORK_SCHED           
	                                   ,REQ_STD_HOURS                
	                                   ,REQ_Z_PD_FUNC                
	                                   ,REQ_GVT_POI  
	                                   ,REQ_GVT_POI_DESCR                
	                                   ,REQ_Z_ACCT_CD                
	                                   ,REQ_Z_PD_CSBASEID            
	                                   ,REQ_BARG_UNIT                
	                                   ,REQ_REG_TEMP                 
	                                   ,REQ_Z_NOTIFY_ROLE            
	                                   ,REQ_Z_PD_FUNC2               
	                                   ,REQ_POSN_DESCR               
	                                   ,REQ_DATE1                    
	                                   ,REQ_DATE2                    
	                                   ,REQ_DATE3                    
	                                   ,REQ_DATE4                    
	                                   ,REQ_TRANSACTION_NAME         
	                                   ,REQ_WF_STATUS                
	                                   ,REQ_UPD_BY_USERID            
	                                   ,REQ_UPD_DTTM                 
	                                   ,REQ_ORIGINATOR_ID            
	                                   ,REQ_CREATED_DTTM             
	                                   ,REQ_COMMENTS                 
	                                   ,REQ_FTE                   
	                                   ,REQ_BUDGETED_POSN         
	                                   ,REQ_POSN_STATUS           
	                                   ,REQ_GVT_ORG_TTL_DESCR     
	                                   ,REQ_EMPLID                
	                                   ,REQ_EMPL_RCD              
	                                   ,REQ_EFFSEQ                
	                                   ,REQ_NEW_EFFDT             
	                                   ,REQ_EFF_STATUS            
	                                   ,REQ_BUSINESS_UNIT         
	                                   ,REQ_JOBCODE               
	                                   ,REQ_SUPV_LVL_ID           
	                                   ,REQ_GVT_PAY_PLAN          
	                                   ,REQ_SAL_ADMIN_PLAN            
	                                   ,REQ_GVT_OCC_SERIES        
	                                   ,REQ_GVT_ORG_TTL_CD        
	                                   ,REQ_GVT_POSN_OCCUPIED     
	                                   ,REQ_GVT_COMP_LEVEL        
	                                   ,REQ_GVT_TARGET_GRADE      
	                                   ,REQ_GRADE                 
	                                   ,REQ_MSS_REC_Z_RECRUIT_IND     
	                                   ,REQ_MSS_REC_Z_RECRUIT_INIT    
	                                   ,REQ_MSS_REC_Z_RECRUIT_CANCEL  
	                                   ,REQ_MSS_REC_CREATEDTTM        
	                                   ,REQ_MSS_REC_CREATEOPRID       
	                                   ,REQ_MSS_REC_LASTUPDDTTM       
	                                   ,REQ_MSS_REC_LASTUPDOPRID      
	                                   ,REQ_XREF_EOAWTHREAD_ID        
	                                   ,REQ_XREF_EOAWPRCS_ID          
	                                   ,REQ_XREF_EOAWDEFN_ID            
	                                   ,REQ_XREF_ORIGINATORID           
	                                   ,REQ_XREF_EOAWREQUESTOR_ID      
	                                   ,REQ_XREF_RECNAME              
	                                   ,REQ_XREF_EOAWTHREAD_STATUS    
	                                   ,REQ_XREF_EOAWPARENT_THREAD    
	                                   ,REQ_XREF_EOAWDTTM_MODIFIED    
	                                   ,REQ_XREF_COMMENTS             
	                                   ,REQ_APPR_AUDIT_OPRID          
	                                   ,REQ_APPR_AUDIT_STAMP          
	                                   ,REQ_APPR_AUDIT_ACTN               
	                                   ,REQ_LATEST_AUDIT_OPRID        
	                                   ,REQ_LATEST_AUDIT_STAMP        
	                                   ,REQ_LATEST_AUDIT_ACTN   
	                                   ,REQ_REC_APPR_AUDIT_OPRID          
	                                   ,REQ_REC_APPR_AUDIT_STAMP          
	                                   ,REQ_REC_APPR_AUDIT_ACTN           
	                                   ,REQ_REC_CANCEL_AUDIT_OPRID        
	                                   ,REQ_REC_CANCEL_AUDIT_STAMP        
	                                   ,REQ_REC_CANCEL_AUDIT_ACTN         
	                                   ,REQ_REC_LATEST_AUDIT_OPRID        
	                                   ,REQ_REC_LATEST_AUDIT_STAMP        
	                                   ,REQ_REC_LATEST_AUDIT_ACTN 
	                                   ,REQ_REC_LATEST_APPR_AUDIT_STAMP 
	                                   ,REQ_DEPT_BUSINESS_LINE
	                                   ,REQ_GSA_DEPT_REGION 
	                                   ,REQ_DEPT_DESCR      
	                                   ,REQ_DEPT_GVT_DESCR40
	                                   ,REQ_GVT_PAR_LINE2      
	                                   ,REQ_GVT_PAR_LINE3      
	                                   ,REQ_GVT_PAR_LINE4      
	                                   ,REQ_GVT_PAR_LINE5      
	                                   ,REQ_GVT_PAR_DESCR2     
	                                   ,REQ_GVT_PAR_DESCR3     
	                                   ,REQ_GVT_PAR_DESCR4     
	                                   ,REQ_GVT_PAR_DESCR5 
	                                   ,REQ_Z_POSITION_EFFDT   
	                                   ,REQ_Z_POSITION_TRANS_TYPE       
	                                   ,REQ_Z_POSITION_TRANSACTION_NBR  
	                                   ,REQ_Z_POSITION_CADW_TRANSACTION_NBR 
	                                   ,REQ_Z_POSITION_Z_PD_FUNC                       
	                                   ,REQ_Z_POSITION_Z_ACCT_CD 
	                                   ,REQ_POS_ACTION        
	                                   ,REQ_POS_ACTION_REASON 
	                                   ,REQ_POS_EFFDT                      
	                                   ,REQ_POS_GVT_PAY_PLAN                           
	                                   ,REQ_POS_GRADE                                  
	                                   ,REQ_POS_GVT_TARGET_GRADE                       
	                                   ,REQ_POS_SUPV_LVL_ID                            
	                                   ,REQ_POS_SUPV_LVL_ID_DESCR                      
	                                   ,REQ_POS_DESCRLONG                              
	                                   ,REQ_POS_DESCRSHORT                             
	                                   ,REQ_POS_DESCR                                  
	                                   ,REQ_POS_GVT_POSN_SENS_CD                       
	                                   ,REQ_POS_GVT_POSN_SENS_CD_DESCR                 
	                                   ,REQ_POS_GVT_OCC_SERIES                         
	                                   ,REQ_POS_GVT_OCC_SERIES_DESCR40                 
	                                   ,REQ_POS_GVT_OCC_SERIES_DESCR70                 
	                                   ,REQ_POS_GVT_OCC_SERIES_PATCOB_CD               
	                                   ,REQ_POS_GVT_OCC_SERIES_PATCOB_CD_DESCR         
	                                   ,REQ_POS_GVT_OCC_SERIES_FUNC_CLASS_REQ          
	                                   ,REQ_POS_MCO_GROUP                              
	                                   ,REQ_POS_MCO_ABBREVIATION                       
	                                   ,REQ_POS_OCCUPATIONAL_SERIES_GROUP              
	                                   ,REQ_POS_BPR_GROUP                              
	                                   ,REQ_POS_MCO_OCO_MSO_TYPE                       
	                                   ,REQ_POS_MISSION_FUNCTIONAL_GROUP               
	                                   ,REQ_POS_GVT_ORG_TTL_DESCR                      
	                                   ,REQ_POS_GVT_ORG_TTL_CD                         
	                                   ,REQ_POS_GSA_EXECUTIVE_RESOURCES_FLAG	 
	                                   ,REQ_POS_INVESTIGATION_TYPE             
	                                   ,REQ_POS_INVESTIGATION_TYPE_DESCR             
	                                   ,REQ_POS_STAFFING_INVESTIGATION_TYPE          
	                                   ,REQ_GVT_GEOLOC_CD                               
	                                   ,REQ_GEOLOC_GVT_ST_CNTRY_DESCR                   
	                                   ,REQ_GEOLOC_CITY                                 
	                                   ,REQ_GEOLOC_STATE                                
	                                   ,REQ_GEOLOC_COUNTY                               
	                                   ,REQ_GEOLOC_COUNTRY                              
	                                   ,REQ_GEOLOC_GSA_REGION                           
	                                   ,REQ_GEOLOC_GSA_REGION_DESCR                     
	                                   ,REQ_GVT_MSA                                     
	                                   ,REQ_GVT_CMSA                                    
	                                   ,REQ_GVT_LEOPAY_AREA                             
	                                   ,REQ_GVT_LEOPAY_AREA_EFFDT                       
	                                   ,REQ_GVT_LEOPAY_AREA_DESCR                       
	                                   ,REQ_GVT_LEO_PCT                                 
	                                   ,REQ_GVT_LOCALITY_AREA                           
	                                   ,REQ_GVT_LOCALITY_AREA_EFFDT                     
	                                   ,REQ_GVT_LOCALITY_AREA_DESCR                     
	                                   ,REQ_GVT_LOCALITY_PCT                            
	                                   ,REQ_GVT_IGA_PCT                                 
	                                   ,REQ_NFCOLA_PERCENT   
	                                   ,REQ_REPORTS_TO_EMPLID           
	                                   ,REQ_REPORTS_TO_EMPL_RCD         
	                                   ,REQ_REPORTS_TO_EMPL_NAME        
	                                   ,REQ_REPORTS_TO_EMAIL_ADDR       
	                                   ,REQ_REPORTS_TO_GVT_WIP_STATUS                           
	                                   ,REQ_REPORTS_TO_GVT_WIP_STATUS_DESCR                     
	                                   ,REQ_REPORTS_TO_GVT_STATUS_TYPE                          
	                                   ,REQ_REPORTS_TO_GVT_STATUS_TYPE_DESCR                    
	                                   ,REQ_REPORTS_TO_GVT_NOA_CODE                                                          
	                                   ,REQ_REPORTS_TO_EFFDT                                    
	                                   ,REQ_REPORTS_TO_EFFSEQ                         
	                                   ,ACTION_EMPLID           
	                                   ,ACTION_EMPL_RCD          
	                                   ,ACTION_GVT_WIP_STATUS                     
	                                   ,ACTION_GVT_WIP_STATUS_DESCR               
	                                   ,ACTION_GVT_STATUS_TYPE                    
	                                   ,ACTION_GVT_STATUS_TYPE_DESCR              
	                                   ,ACTION_GVT_NOA_CODE                                                    
	                                   ,ACTION_EFFDT                              
	                                   ,ACTION_EFFSEQ   
	                                   ,SF50_TRANSACTION_CONTROL_ID
	                                   ,CADW_SF50_TRANSACTION_STATUS
	                                   ,REQ_Z_ADMIN_POC_OPRID                                                     
	                                   ,REQ_Z_ADMIN_POC_EMPL_NAME                                                  
	                                   ,REQ_Z_ADMIN_POC_EMPLID                                                    
	                                   ,REQ_Z_ADMIN_POC_EMAILID                                                   
	                                   ,REQ_Z_ALT_HIRE_MGR_OPRID                                                  
	                                   ,REQ_Z_ALT_HIRE_MGR_EMPL_NAME                                               
	                                   ,REQ_Z_ALT_HIRE_MGR_EMPLID                                   
	                                   ,REQ_Z_ALT_HIRE_MGR_EMAILID                                                
	                                   ,REQ_Z_HR_SPECIALIST_OPRID                                                 
	                                   ,REQ_Z_HR_SPECIALIST_EMPL_NAME                                              
	                                   ,REQ_Z_HR_SPECIALIST_EMPLID                                                
	                                   ,REQ_Z_HR_SPECIALIST_EMAILID                                               
	                                   ,REQ_Z_NRC_SPECIALIST_OPRID                                                
	                                   ,REQ_Z_NRC_SPECIALIST_EMPL_NAME                                             
	                                   ,REQ_Z_NRC_SPECIALIST_EMPLID                                               
	                                   ,REQ_Z_NRC_SPECIALIST_EMAILID 
	                            )
	                         SELECT 
	                                    CONCAT(PS_Z_PUF_DAT.TRANSACTION_NBR,'U')   
	                                   ,'PUF'         
	                                   ,PS_Z_PUF_DAT.TRANSACTION_NBR       
	                                   ,CASE WHEN PS_Z_MSS_RECRUIT.Z_RECRUIT_CANCEL = 'Y' THEN 'CAN'
	                                         WHEN FUTJOB.GVT_WIP_STATUS IN ('PRO','COR')  THEN 'PRO'
	                                         WHEN FUTJOB.GVT_WIP_STATUS IN ('WIP','INI')  THEN 'WIP'
	                                         WHEN FUTJOB.GVT_WIP_STATUS IS NULL           THEN 'APP'   ELSE 'APP' END    
	                                   ,CASE WHEN PS_Z_MSS_RECRUIT.Z_RECRUIT_CANCEL = 'Y' THEN 'Cancelled'
	                                         WHEN FUTJOB.GVT_WIP_STATUS IN ('PRO','COR')  THEN 'Completed'
	                                         WHEN FUTJOB.GVT_WIP_STATUS IN ('WIP','INI')  THEN 'Pending EOD'
	                                         WHEN FUTJOB.GVT_WIP_STATUS IS NULL           THEN 'Approved' ELSE 'Approved' END   
	                                   ,PS_Z_PUF_DAT.POSITION_NBR          
	                                   ,PS_Z_PUF_DAT.REQUEST_DT            
	                                   ,YEAR(DATE_FORMAT(DATE_ADD( COALESCE(PS_AUDIT_Z_MSS_REC_APPR.AUDIT_STAMP,PS_Z_PUF_DAT.REQUEST_DT ) ,INTERVAL 3 MONTH) ,'%Y-09-30')) FOURDIGIT_FISCAL_YEAR_OF_EFFDT
	                                   ,CONCAT('FY',SUBSTR(YEAR(DATE_FORMAT(DATE_ADD( COALESCE(PS_AUDIT_Z_MSS_REC_APPR.AUDIT_STAMP,PS_Z_PUF_DAT.REQUEST_DT ) ,INTERVAL 3 MONTH) ,'%Y-09-30')),3,2)) FISCAL_YEAR_ACTION_EFFDT
	                                   ,PS_Z_PUF_DAT.ACTION                
	                                   ,PS_Z_PUF_DAT.ACTION_REASON         
	                                   ,PS_Z_PUF_DAT.DEPTID                
	                                   ,PS_Z_PUF_DAT.LOCATION              
	                                   ,PS_Z_PUF_DAT.REPORTS_TO            
	                                   ,PS_Z_PUF_DAT.GVT_WORK_SCHED        
	                                   ,PS_Z_PUF_DAT.STD_HOURS             
	                                   ,PS_Z_PUF_DAT.Z_PD_FUNC             
	                                   ,PS_Z_PUF_DAT.GVT_POI   
	                                   ,POI.DESCR             
	                                   ,PS_Z_PUF_DAT.Z_ACCT_CD             
	                                   ,PS_Z_PUF_DAT.Z_PD_CSBASEID         
	                                   ,PS_Z_PUF_DAT.BARG_UNIT             
	                                   ,PS_Z_PUF_DAT.REG_TEMP              
	                                   ,PS_Z_PUF_DAT.Z_NOTIFY_ROLE         
	                                   ,PS_Z_PUF_DAT.Z_PD_FUNC2            
	                                   ,PS_Z_PUF_DAT.POSN_DESCR            
	                                   ,PS_Z_PUF_DAT.DATE1                 
	                                   ,PS_Z_PUF_DAT.DATE2                 
	                                   ,PS_Z_PUF_DAT.DATE3                 
	                                   ,PS_Z_PUF_DAT.DATE4                 
	                                   ,PS_Z_PUF_DAT.TRANSACTION_NAME      
	                                   ,PS_Z_PUF_DAT.WF_STATUS             
	                                   ,PS_Z_PUF_DAT.UPD_BY_USERID         
	                                   ,PS_Z_PUF_DAT.UPD_DTTM              
	                                   ,PS_Z_PUF_DAT.ORIGINATOR_ID         
	                                   ,PS_Z_PUF_DAT.CREATED_DTTM          
	                                   ,PS_Z_PUF_DAT.COMMENTS              
	                                   ,PS_Z_PUF_DAT.FTE                   
	                                   ,PS_Z_PUF_DAT.BUDGETED_POSN         
	                                   ,PS_Z_PUF_DAT.POSN_STATUS           
	                                   ,PS_Z_PUF_DAT.GVT_ORG_TTL_DESCR     
	                                   ,PS_Z_PUF_DAT.EMPLID                
	                                   ,PS_Z_PUF_DAT.EMPL_RCD              
	                                   ,PS_Z_PUF_DAT.EFFSEQ                
	                                   ,PS_Z_PUF_DAT.NEW_EFFDT             
	                                   ,PS_Z_PUF_DAT.EFF_STATUS            
	                                   ,PS_Z_PUF_DAT.BUSINESS_UNIT         
	                                   ,PS_Z_PUF_DAT.JOBCODE               
	                                   ,PS_Z_PUF_DAT.SUPV_LVL_ID           
	                                   ,PS_Z_PUF_DAT.GVT_PAY_PLAN          
	                                   ,PS_Z_PUF_DAT.SAL_ADMIN_PLAN                   
	                                   ,PS_Z_PUF_DAT.GVT_OCC_SERIES        
	                                   ,PS_Z_PUF_DAT.GVT_ORG_TTL_CD        
	                                   ,PS_Z_PUF_DAT.GVT_POSN_OCCUPIED     
	                                   ,PS_Z_PUF_DAT.GVT_COMP_LEVEL        
	                                   ,PS_Z_PUF_DAT.GVT_TARGET_GRADE      
	                                   ,PS_Z_PUF_DAT.GRADE    
	                                   ,PS_Z_MSS_RECRUIT.Z_RECRUIT_IND                             
	                                   ,PS_Z_MSS_RECRUIT.Z_RECRUIT_INIT                                   
	                                   ,PS_Z_MSS_RECRUIT.Z_RECRUIT_CANCEL                               
	                                   ,PS_Z_MSS_RECRUIT.CREATEDTTM                                          
	                                   ,PS_Z_MSS_RECRUIT.CREATEOPRID                               
	                                   ,PS_Z_MSS_RECRUIT.LASTUPDDTTM                               
	                                   ,PS_Z_MSS_RECRUIT.LASTUPDOPRID                              
	                                   ,PS_Z_PUF_XREF.EOAWTHREAD_ID                                
	                                   ,PS_Z_PUF_XREF.EOAWPRCS_ID                                  
	                                   ,PS_Z_PUF_XREF.EOAWDEFN_ID                                  
	                                   ,PS_Z_PUF_XREF.ORIGINATORID                                 
	                                   ,PS_Z_PUF_XREF.EOAWREQUESTOR_ID                             
	                                   ,PS_Z_PUF_XREF.RECNAME                                      
	                                   ,PS_Z_PUF_XREF.EOAWTHREAD_STATUS                            
	                                   ,PS_Z_PUF_XREF.EOAWPARENT_THREAD                            
	                                   ,PS_Z_PUF_XREF.EOAWDTTM_MODIFIED                            
	                                   ,PS_Z_PUF_XREF.COMMENTS                                     
	                                   ,PS_AUDIT_Z_PUF_DAT_APPR.AUDIT_OPRID                                  
	                                   ,PS_AUDIT_Z_PUF_DAT_APPR.AUDIT_STAMP                                  
	                                   ,PS_AUDIT_Z_PUF_DAT_APPR.AUDIT_ACTN                                                                  
	                                   ,PS_AUDIT_Z_PUF_DAT_LAT.AUDIT_OPRID                                
	                                   ,PS_AUDIT_Z_PUF_DAT_LAT.AUDIT_STAMP                                
	                                   ,PS_AUDIT_Z_PUF_DAT_LAT.AUDIT_ACTN 
	                                   ,PS_AUDIT_Z_MSS_REC_APPR.AUDIT_OPRID                                  
	                                   ,PS_AUDIT_Z_MSS_REC_APPR.AUDIT_STAMP                                  
	                                   ,PS_AUDIT_Z_MSS_REC_APPR.AUDIT_ACTN                                                               
	                                   ,CASE WHEN PS_Z_MSS_RECRUIT.Z_RECRUIT_CANCEL = 'Y' THEN PS_AUDIT_Z_MSS_REC_CANCEL.AUDIT_OPRID  ELSE NULL  END                         
	                                   ,CASE WHEN PS_Z_MSS_RECRUIT.Z_RECRUIT_CANCEL = 'Y' THEN PS_AUDIT_Z_MSS_REC_CANCEL.AUDIT_STAMP  ELSE NULL  END                              
	                                   ,CASE WHEN PS_Z_MSS_RECRUIT.Z_RECRUIT_CANCEL = 'Y' THEN PS_AUDIT_Z_MSS_REC_CANCEL.AUDIT_ACTN   ELSE NULL  END  
	                                   ,PS_AUDIT_Z_MSS_REC_LAT.AUDIT_OPRID                                
	                                   ,PS_AUDIT_Z_MSS_REC_LAT.AUDIT_STAMP                                
	                                   ,PS_AUDIT_Z_MSS_REC_LAT.AUDIT_ACTN 
	                                   ,PS_AUDIT_Z_MSS_REC_LAT_APPR.AUDIT_STAMP  
	                                   ,ZDEPT.Z_TEXT30_5      
	                                   ,nhrdw_get_gsa_region('GSASH',PS_Z_PUF_DAT.DEPTID )  
	                                   ,DEPT.DESCR      
	                                   ,DEPT.GVT_DESCR40
	                                   ,DEPT.GVT_PAR_LINE2         
	                                   ,DEPT.GVT_PAR_LINE3         
	                                   ,DEPT.GVT_PAR_LINE4         
	                                   ,DEPT.GVT_PAR_LINE5         
	                                   ,DEPT.GVT_PAR_DESCR2        
	                                   ,DEPT.GVT_PAR_DESCR3        
	                                   ,DEPT.GVT_PAR_DESCR4        
	                                   ,DEPT.GVT_PAR_DESCR5  
	                                   ,ZPOS.EFFDT             
	                                   ,ZPOS.Z_TEXT254_4        
	                                   ,ZPOS.Z_TEXT254_3  
	                                   ,CASE WHEN ZPOS.Z_TEXT254_4 = 'SF52' THEN ZPOS.Z_TEXT254_3   
	                                         WHEN ZPOS.Z_TEXT254_4 = 'NEW' THEN CONCAT(ZPOS.Z_TEXT254_3 ,'C')  
	                                         WHEN ZPOS.Z_TEXT254_4 = 'PUF' THEN CONCAT(ZPOS.Z_TEXT254_3 ,'U') ELSE NULL END       
	                                   ,ZPOS.Z_PD_FUNC                           
	                                   ,ZPOS.Z_ACCT_CD     
	                                   ,TOPOS.ACTION        
	                                   ,TOPOS.ACTION_REASON 
	                                   ,TOPOS.EFFDT                       
	                                   ,TOPOS.GVT_PAY_PLAN                                                 
	                                   ,TOPOS.GRADE                                                        
	                                   ,TOPOS.GVT_TARGET_GRADE                                             
	                                   ,TOPOS.SUPV_LVL_ID                                                                           
	                                   ,TOSUP.DESCR                                                                                 
	                                   ,TOPOS.DESCRLONG                                                                             
	                                   ,TOPOS.DESCRSHORT                                                                            
	                                   ,TOPOS.DESCR                                                                                 
	                                   ,TOPOS.GVT_POSN_SENS_CD                                                                      
	                                   ,TOSEN.XLATLONGNAME                                                                          
	                                   ,TOPOS.GVT_OCC_SERIES                                                                        
	                                   ,TOOCC.GVT_DESCR40	                                                                         
	                                   ,TOOCC.GVT_DESCR70	                                                                         
	                                   ,TOOCC.GVT_PATCOB_CD	                                                                       
	                                   ,TOPAT.XLATLONGNAME                                                                          
	                                   ,TOOCC.GVT_FUNC_CLASS_REQ  
	                                   ,TOOCA.MCO_GROUP                                                                             
	                                   ,TOOCA.MCO_ABBREVIATION                                                                      
	                                   ,TOOCA.OCCUPATIONAL_SERIES_GROUP                                                             
	                                   ,TOOCA.BPR_GROUP                                                                             
	                                   ,TOOCA.MCO_OCO_MSO_TYPE                                                                      
	                                   ,TOOCA.MISSION_FUNCTIONAL_GROUP                                                              
	                                   ,TOPOS.GVT_ORG_TTL_DESCR                                              
	                                   ,TOPOS.GVT_ORG_TTL_CD     
	                                   ,CASE WHEN TOPOS.BUSINESS_UNIT in ('GSA01','GSA02') and substr(ZPOS.Z_PD_FUNC,1,1) = 'X' THEN 'Y' ELSE 'N' END   
	                                   ,senscd.X_FIELDVALUE
	                                   ,invest.SHORT_DESC                                                                                            
	                                   ,case when senscd.X_FIELDVALUE = 'T1'  then 'T1-NACI'
	                                         when senscd.X_FIELDVALUE = 'T2S' then 'T2S'
	                                         when senscd.X_FIELDVALUE = 'T3'  then 'T3-ANACI,NACLC Initial'
	                                         when senscd.X_FIELDVALUE = 'T4'  then 'T4-BI'
	                                         when senscd.X_FIELDVALUE = 'T5'  then 'T5-SSBI'
	                                       else null end  
	                                   ,LOC.GVT_GEOLOC_CD	                        	                                               
	                                   ,GEOTAB.GVT_ST_CNTRY_DESCR		                                                               
	                                   ,GEOTAB.CITY	         		                      		                                         
	                                   ,GEOTAB.STATE	         		                   		                                             
	                                   ,GEOTAB.COUNTY	         		                                                                 
	                                   ,GEOTAB.COUNTRY                                                                              
	                                   ,COALESCE(todsrc.X_FIELDVALUE,todsr.X_FIELDVALUE)  	                                         
	                                   ,togsr.SHORT_DESC   	                                                                       
	                                   ,GEOTAB.GVT_MSA	        	                    	                                             
	                                   ,GEOTAB.GVT_CMSA	        	                  	                                             
	                                   ,GEOTAB.GVT_LEOPAY_AREA		                                                                   
	                                   ,LEOAREA.EFFDT	                              	                                             
	                                   ,LEOAREA.DESCR                                                                               
	                                   ,LEOAREA.GVT_LEO_PCT                                                                         
	                                   ,GEOTAB.GVT_LOCALITY_AREA		                	                                               
	                                   ,LOCAREA.EFFDT                                                                               
	                                   ,LOCAREA.DESCR                                                                               
	                                   ,LOCAREA.GVT_LOCALITY_PCT                                                                    
	                                   ,LOCAREA.GVT_IGA_PCT                	                                                       
	                                   ,PYPCT.Z_FOR_DIFF_PCT     
	                                   ,JOB.EMPLID           
	                                   ,JOB.EMPL_RCD         
	                                   ,JOB.NAME        
	                                   ,JOB.EMAIL_ADDR       
	                                   ,JOB.GVT_WIP_STATUS                         
	                                   ,NULL                 
	                                   ,JOB.GVT_STATUS_TYPE                        
	                                   ,NULL                  
	                                   ,JOB.GVT_NOA_CODE                                                        
	                                   ,JOB.EFFDT                                  
	                                   ,JOB.EFFSEQ    
	                                   ,FUTJOB.EMPLID           
	                                   ,FUTJOB.EMPL_RCD            
	                                   ,FUTJOB.GVT_WIP_STATUS                         
	                                   ,NULL                 
	                                   ,FUTJOB.GVT_STATUS_TYPE                        
	                                   ,NULL                  
	                                   ,FUTJOB.GVT_NOA_CODE                                                        
	                                   ,FUTJOB.EFFDT                                  
	                                   ,FUTJOB.EFFSEQ  
	                                   ,COALESCE(SF50COR.SF50_TRANSACTION_CONTROL_ID,SF50.SF50_TRANSACTION_CONTROL_ID)
	                                   ,sf50.TRANSACTION_STATUS
	                                   ,PS_Z_PUF_DAT.Z_ADMIN_POC                    
	                                   ,oprzadm.OPRDEFNDESC                               
	                                   ,oprzadm.EMPLID                                    
	                                   ,oprzadm.EMAILID                                   
	                                   ,PS_Z_PUF_DAT.Z_ALT_HIRE_MGR                 
	                                   ,oprzalt.OPRDEFNDESC                               
	                                   ,oprzalt.EMPLID                                    
	                                   ,oprzalt.EMAILID                                   
	                                   ,PS_Z_PUF_DAT.Z_HR_SPECIALIST                                           
	                                   ,case when PS_AUDIT_Z_MSS_REC_APPR.AUDIT_STAMP IS NULL OR PS_AUDIT_Z_MSS_REC_APPR.AUDIT_STAMP < '2022-08-01' then star.HR_CONSULTANT  else oprzhrs.OPRDEFNDESC end    
	                                   ,oprzhrs.EMPLID                                    
	                                   ,oprzhrs.EMAILID                                   
	                                   ,PS_Z_PUF_DAT.Z_NRC_SPECIALIST                   
	                                   ,case when PS_AUDIT_Z_MSS_REC_APPR.AUDIT_STAMP IS NULL OR PS_AUDIT_Z_MSS_REC_APPR.AUDIT_STAMP < '2022-08-01' then star.NRC_CONSULTANT  else oprznrc.OPRDEFNDESC end    
	                                   ,oprznrc.EMPLID                                    
	                                   ,oprznrc.EMAILID                                   
	                       FROM        PS_Z_PUF_DAT
	                                   INNER JOIN PS_Z_PUF_XREF        ON     PS_Z_PUF_XREF.TRANSACTION_NBR     = PS_Z_PUF_DAT.TRANSACTION_NBR   AND PS_Z_PUF_XREF.EOAWPRCS_ID LIKE '%MSSUpdPosn'  
	                                   INNER JOIN PS_Z_MSS_RECRUIT     ON     PS_Z_MSS_RECRUIT.TRANSACTION_NBR       = PS_Z_PUF_DAT.TRANSACTION_NBR   AND PS_Z_MSS_RECRUIT.Z_TRANS_TYPE =  'PUF'
	                                   LEFT  JOIN PS_AUDIT_Z_PUF_DAT    PS_AUDIT_Z_PUF_DAT_LAT        ON     PS_AUDIT_Z_PUF_DAT_LAT.TRANSACTION_NBR      = PS_Z_PUF_DAT.TRANSACTION_NBR    
	                                                                                                  AND    PS_AUDIT_Z_PUF_DAT_LAT.AUDIT_STAMP   = ( SELECT MAX(PS_AUDIT_Z_PUF_DAT_LAT_ED.AUDIT_STAMP) FROM PS_AUDIT_Z_PUF_DAT PS_AUDIT_Z_PUF_DAT_LAT_ED
	                                                                                                                                                         WHERE    PS_Z_PUF_DAT.TRANSACTION_NBR      = PS_AUDIT_Z_PUF_DAT_LAT_ED.TRANSACTION_NBR )
	                                   LEFT  JOIN PS_AUDIT_Z_PUF_DAT    PS_AUDIT_Z_PUF_DAT_APPR       ON     PS_AUDIT_Z_PUF_DAT_APPR.TRANSACTION_NBR     = PS_Z_PUF_DAT.TRANSACTION_NBR    AND PS_AUDIT_Z_PUF_DAT_APPR.AUDIT_ACTN    = 'A'     
	                                                                                                  AND    PS_AUDIT_Z_PUF_DAT_APPR.AUDIT_STAMP   = ( SELECT MAX(PS_AUDIT_Z_PUF_DAT_APPR_ED.AUDIT_STAMP) FROM PS_AUDIT_Z_PUF_DAT PS_AUDIT_Z_PUF_DAT_APPR_ED
	                                                                                                                                                         WHERE       PS_AUDIT_Z_PUF_DAT_APPR_ED.AUDIT_ACTN    = 'A'
	                                                                                                                                                                AND  PS_Z_PUF_DAT.TRANSACTION_NBR      = PS_AUDIT_Z_PUF_DAT_APPR_ED.TRANSACTION_NBR )
	                                   LEFT  JOIN PS_AUDIT_Z_MSS_REC    PS_AUDIT_Z_MSS_REC_LAT        ON     PS_AUDIT_Z_MSS_REC_LAT.TRANSACTION_NBR      = PS_Z_PUF_DAT.TRANSACTION_NBR   AND PS_AUDIT_Z_MSS_REC_LAT.Z_TRANS_TYPE = 'PUF' 
	                                                                                                  AND    PS_AUDIT_Z_MSS_REC_LAT.AUDIT_STAMP   = ( SELECT MAX(PS_AUDIT_Z_MSS_REC_LAT_ED.AUDIT_STAMP) FROM PS_AUDIT_Z_MSS_REC PS_AUDIT_Z_MSS_REC_LAT_ED
	                                                                                                                                                         WHERE    PS_Z_PUF_DAT.TRANSACTION_NBR      = PS_AUDIT_Z_MSS_REC_LAT_ED.TRANSACTION_NBR 
	                                                                                                                                                         AND      PS_AUDIT_Z_MSS_REC_LAT_ED.Z_TRANS_TYPE = 'PUF'   )
	                                   LEFT  JOIN PS_AUDIT_Z_MSS_REC    PS_AUDIT_Z_MSS_REC_CANCEL     ON     PS_AUDIT_Z_MSS_REC_CANCEL.TRANSACTION_NBR   = PS_Z_PUF_DAT.TRANSACTION_NBR AND PS_AUDIT_Z_MSS_REC_CANCEL.AUDIT_ACTN    = 'C' AND PS_AUDIT_Z_MSS_REC_CANCEL.Z_TRANS_TYPE = 'PUF'  AND  PS_AUDIT_Z_MSS_REC_CANCEL.Z_RECRUIT_CANCEL   = 'Y'          
	                                                                                                  AND    PS_AUDIT_Z_MSS_REC_CANCEL.AUDIT_STAMP   = ( SELECT MIN(PS_AUDIT_Z_MSS_REC_CANCEL_ED.AUDIT_STAMP) FROM PS_AUDIT_Z_MSS_REC PS_AUDIT_Z_MSS_REC_CANCEL_ED
	                                                                                                                                                         WHERE       PS_AUDIT_Z_MSS_REC_CANCEL_ED.AUDIT_ACTN    = 'C'
	                                                                                                                                                                AND  PS_AUDIT_Z_MSS_REC_CANCEL_ED.Z_RECRUIT_CANCEL   = 'Y'          
	                                                                                                                                                                AND  PS_AUDIT_Z_MSS_REC_CANCEL_ED.Z_TRANS_TYPE = 'PUF'   
	                                                                                                                                                                AND  PS_AUDIT_Z_MSS_REC_CANCEL_ED.TRANSACTION_NBR      = PS_Z_PUF_DAT.TRANSACTION_NBR
	                                                                                                                                                                AND  NOT EXISTS ( SELECT 'X' FROM PS_AUDIT_Z_MSS_REC PS_AUDIT_Z_MSS_REC_CANCEL_EX
	                                                                                                                                                                                   WHERE       PS_AUDIT_Z_MSS_REC_CANCEL_EX.AUDIT_ACTN    = 'C'                                      
	                                                                                                                                                                                          AND  PS_AUDIT_Z_MSS_REC_CANCEL_EX.Z_RECRUIT_CANCEL     = 'N'                                 
	                                                                                                                                                                                          AND  PS_AUDIT_Z_MSS_REC_CANCEL_EX.Z_TRANS_TYPE     = 'PUF'                                 
	                                                                                                                                                                                          AND  PS_AUDIT_Z_MSS_REC_CANCEL_EX.TRANSACTION_NBR      = PS_Z_PUF_DAT.TRANSACTION_NBR
	                                                                                                                                                                                          AND  PS_AUDIT_Z_MSS_REC_CANCEL_ED.AUDIT_STAMP > PS_AUDIT_Z_MSS_REC_CANCEL.AUDIT_STAMP  )   
	                                                                                                                                                                                )                                                                                                       
	                                   LEFT  JOIN PS_AUDIT_Z_MSS_REC    PS_AUDIT_Z_MSS_REC_APPR       ON     PS_AUDIT_Z_MSS_REC_APPR.TRANSACTION_NBR     = PS_Z_PUF_DAT.TRANSACTION_NBR    AND PS_AUDIT_Z_MSS_REC_APPR.AUDIT_ACTN    = 'A'   AND PS_AUDIT_Z_MSS_REC_APPR.Z_TRANS_TYPE = 'PUF'    
	                                                                                                  AND    PS_AUDIT_Z_MSS_REC_APPR.AUDIT_STAMP   = ( SELECT MAX(PS_AUDIT_Z_MSS_REC_APPR_ED.AUDIT_STAMP) FROM PS_AUDIT_Z_MSS_REC PS_AUDIT_Z_MSS_REC_APPR_ED
	                                                                                                                                                         WHERE       PS_AUDIT_Z_MSS_REC_APPR_ED.AUDIT_ACTN    = 'A'
	                                                                                                                                                                AND  PS_AUDIT_Z_MSS_REC_APPR_ED.Z_TRANS_TYPE = 'PUF'    
	                                                                                                                                                                AND  PS_Z_PUF_DAT.TRANSACTION_NBR     = PS_AUDIT_Z_MSS_REC_APPR_ED.TRANSACTION_NBR )
	                                   LEFT  JOIN PS_AUDIT_Z_MSS_REC    PS_AUDIT_Z_MSS_REC_LAT_APPR   ON     PS_AUDIT_Z_MSS_REC_LAT_APPR.TRANSACTION_NBR   = PS_Z_PUF_DAT.TRANSACTION_NBR  AND PS_AUDIT_Z_MSS_REC_LAT_APPR.Z_TRANS_TYPE = 'PUF' 
	                                                                                                          AND PS_AUDIT_Z_MSS_REC_LAT_APPR.AUDIT_ACTN    = 'C' AND PS_AUDIT_Z_MSS_REC_LAT_APPR.Z_RECRUIT_CANCEL   = 'N'     
	                                                                                                  AND    PS_AUDIT_Z_MSS_REC_LAT_APPR.AUDIT_STAMP       = ( SELECT    MIN(PS_AUDIT_Z_MSS_REC_CANCEL_ED.AUDIT_STAMP) FROM PS_AUDIT_Z_MSS_REC PS_AUDIT_Z_MSS_REC_CANCEL_ED
	                                                                                                                                                             WHERE   PS_AUDIT_Z_MSS_REC_CANCEL_ED.AUDIT_ACTN    = 'C'
	                                                                                                                                                                AND  PS_AUDIT_Z_MSS_REC_CANCEL_ED.Z_RECRUIT_CANCEL   = 'N'            
	                                                                                                                                                                AND  PS_AUDIT_Z_MSS_REC_CANCEL_ED.Z_TRANS_TYPE = 'PUF'   
	                                                                                                                                                                AND  PS_AUDIT_Z_MSS_REC_CANCEL_ED.TRANSACTION_NBR = PS_Z_PUF_DAT.TRANSACTION_NBR      
	                                                                                                                                                                AND  PS_AUDIT_Z_MSS_REC_CANCEL_ED.AUDIT_STAMP >= PS_AUDIT_Z_MSS_REC_CANCEL.AUDIT_STAMP  )
	                                   LEFT   JOIN PS_DEPT_TBL          DEPT  on DEPT.deptid   = PS_Z_PUF_DAT.deptid and DEPT.SETID   = 'GSASH' and DEPT.EFFDT =  (SELECT MAX(DEP_ED.EFFDT) FROM PS_DEPT_TBL DEP_ED
	                                                                                                                                               WHERE DEP_ED.SETID  = 'GSASH'
	                                                                                                                                                 AND DEP_ED.DEPTID = PS_Z_PUF_DAT.deptid
	                                                                                                                                                 AND DEP_ED.EFFDT <= COALESCE(PS_AUDIT_Z_MSS_REC_APPR.AUDIT_STAMP,PS_Z_PUF_DAT.REQUEST_DT ))  
	                                   LEFT OUTER JOIN PS_Z_DEPT_TBL ZDEPT ON ZDEPT.SETID = 'GSASH' AND ZDEPT.DEPTID = PS_Z_PUF_DAT.DEPTID                    
	                                                                          AND   ZDEPT.EFFDT = 
	                                                                                        (SELECT MAX(ZDEPT_ED.EFFDT) FROM ps_dept_tbl ZDEPT_ED 
	                                                                                          WHERE ZDEPT_ED.DEPTID = PS_Z_PUF_DAT.DEPTID
	                                                                                            AND ZDEPT_ED.SETID  = 'GSASH'                     
	                                                                                            AND ZDEPT_ED.EFFDT <= COALESCE(PS_AUDIT_Z_MSS_REC_APPR.AUDIT_STAMP,PS_Z_PUF_DAT.REQUEST_DT ))
	                                  LEFT OUTER JOIN ps_location_tbl     LOC     ON  LOC.LOCATION = PS_Z_PUF_DAT.LOCATION                              
	                                                                               AND LOC.SETID    = 'GSASH'       
	                                  	                                           AND LOC.EFFDT    = (SELECT MAX(LOC_ED.EFFDT) 
	                                  	                                                                  FROM ps_location_tbl LOC_ED              
	                                  		                                                              	WHERE LOC_ED.LOCATION  = PS_Z_PUF_DAT.LOCATION                
	                                                                                                        AND LOC_ED.SETID     = 'GSASH'                                                  
	                                  		                                                                	AND LOC_ED.EFFDT <=COALESCE(PS_AUDIT_Z_MSS_REC_APPR.AUDIT_STAMP,PS_Z_PUF_DAT.REQUEST_DT )   ) 
	                                  LEFT OUTER JOIN  PS_GVT_GEOLOC_TBL GEOTAB on GEOTAB.GVT_GEOLOC_CD = LOC.GVT_GEOLOC_CD
	                                  	                                      AND GEOTAB.EFFDT = (SELECT MAX(GEOTAB_ED.EFFDT) FROM PS_GVT_GEOLOC_TBL GEOTAB_ED
	                                                                                                WHERE GEOTAB_ED.GVT_GEOLOC_CD = LOC.GVT_GEOLOC_CD
	                                                                                                AND   GEOTAB_ED.EFFDT     <= COALESCE(PS_AUDIT_Z_MSS_REC_APPR.AUDIT_STAMP,PS_Z_PUF_DAT.REQUEST_DT ) )                            
	                                 LEFT OUTER JOIN  nhrdw_custom_xlatitem todsr on  todsr.FIELDNAME  = 'GSA_DUTY_STATION_REGION' and todsr.FIELDVALUE = SUBSTR(LOC.GVT_GEOLOC_CD,1,2) and  todsr.X_FIELDNAME    = 'GSA_REGION'
	                                                                         AND todsr.EFFDT =(SELECT MAX(todsr_ED.EFFDT) FROM nhrdw_custom_xlatitem todsr_ED
	                                                                                           WHERE todsr_ED.FIELDVALUE = SUBSTR(LOC.GVT_GEOLOC_CD,1,2)
			                                                                                     AND todsr_ED.X_FIELDNAME  = 'GSA_REGION' 
			                                                                                     and todsr_ED.FIELDNAME    = 'GSA_DUTY_STATION_REGION'
	                                                                                             AND todsr_ED.EFFDT       <= COALESCE(PS_AUDIT_Z_MSS_REC_APPR.AUDIT_STAMP,PS_Z_PUF_DAT.REQUEST_DT ))
	                                 LEFT OUTER JOIN nhrdw_custom_xlatitem todsrc on todsrc.FIELDNAME      = 'GSA_DUTY_STATION_REGION_BY_CODE' AND todsrc.FIELDVALUE     = LOC.GVT_GEOLOC_CD AND todsrc.X_FIELDNAME    = 'GSA_REGION'
	                                           AND todsrc.EFFDT =
	                                                              (SELECT MAX(xlat_ED.EFFDT) FROM nhrdw_custom_xlatitem xlat_ED
	                                                               WHERE xlat_ED.FIELDVALUE     = LOC.GVT_GEOLOC_CD
		                                                	            AND xlat_ED.FIELDNAME      = 'GSA_DUTY_STATION_REGION_BY_CODE'
		                                                             	and xlat_ED.X_FIELDNAME    = 'GSA_REGION'
	                                                                AND xlat_ED.EFFDT       <= COALESCE(PS_AUDIT_Z_MSS_REC_APPR.AUDIT_STAMP,PS_Z_PUF_DAT.REQUEST_DT ))                           
	                                  LEFT OUTER JOIN  nhrdw_custom_xlatitem togsr on  togsr.FIELDNAME  = 'GSA_REGION' and togsr.FIELDVALUE = COALESCE(todsrc.X_FIELDVALUE,todsr.X_FIELDVALUE)
	                                                             AND togsr.EFFDT =(SELECT MAX(togsr_ED.EFFDT) FROM nhrdw_custom_xlatitem togsr_ED
	                                                                               WHERE togsr_ED.FIELDVALUE = COALESCE(todsrc.X_FIELDVALUE,todsr.X_FIELDVALUE)
			                                                                         AND togsr_ED.FIELDNAME  = 'GSA_REGION' 
	                                                                                 AND togsr_ED.EFFDT       <= COALESCE(PS_AUDIT_Z_MSS_REC_APPR.AUDIT_STAMP,PS_Z_PUF_DAT.REQUEST_DT ))	
	                                  LEFT OUTER JOIN   PS_GVT_LEOAREA_TBL LEOAREA ON LEOAREA.GVT_LEOPAY_AREA = GEOTAB.GVT_LEOPAY_AREA
	                                                                            AND LEOAREA.EFFDT = (SELECT MAX(LEOAREA_ED.EFFDT) 
	                                                                                                 FROM   PS_GVT_LEOAREA_TBL LEOAREA_ED
	                                                                                                WHERE   LEOAREA_ED.GVT_LEOPAY_AREA = GEOTAB.GVT_LEOPAY_AREA
	                                                                                                  AND   LEOAREA_ED.EFFDT <= COALESCE(PS_AUDIT_Z_MSS_REC_APPR.AUDIT_STAMP,PS_Z_PUF_DAT.REQUEST_DT ) )      	         
	                                  LEFT OUTER JOIN  PS_GVT_LOCAREA_TBL LOCAREA ON  LOCAREA.GVT_LOCALITY_AREA = GEOTAB.GVT_LOCALITY_AREA 
	                                                                           AND  LOCAREA.EFFDT = (SELECT MAX(LOCAREA_ED.EFFDT) 
	                                                                                                 FROM   PS_GVT_LOCAREA_TBL LOCAREA_ED 
	                                                                                                 WHERE  LOCAREA_ED.GVT_LOCALITY_AREA = GEOTAB.GVT_LOCALITY_AREA
	                                                                                                   AND    LOCAREA_ED.EFFDT <= COALESCE(PS_AUDIT_Z_MSS_REC_APPR.AUDIT_STAMP,PS_Z_PUF_DAT.REQUEST_DT ) ) 
	                                  LEFT OUTER JOIN PS_Z_LOC_PYPCT_TBL   PYPCT ON    PYPCT.LOCATION = LOC.LOCATION                              
	                                                                               AND PYPCT.SETID    = LOC.SETID  
	                                                                               AND PYPCT.eff_status = 'A'
	                                                                               AND PYPCT.ERNCD    = 'COL'         
	                                  	                                           AND PYPCT.EFFDT    = (SELECT MAX(PYPCT_ED.EFFDT) 
	                                  	                                                                  FROM PS_Z_LOC_PYPCT_TBL PYPCT_ED             
	                                  		                                                              	WHERE PYPCT_ED.LOCATION  = PS_Z_PUF_DAT.LOCATION                          
	                                                                                                        AND PYPCT_ED.SETID     = 'GSASH'    
	                                                                                                        AND PYPCT_ED.eff_status = 'A'
	                                                                                                        AND PYPCT_ED.ERNCD    = 'COL'                                                   
	                                  		                                                                	AND PYPCT_ED.EFFDT <= COALESCE(PS_AUDIT_Z_MSS_REC_APPR.AUDIT_STAMP,PS_Z_PUF_DAT.REQUEST_DT ) )                                   		                                                                	
	                                   LEFT OUTER JOIN  PS_Z_POSITION_DATA ZPOS on  ZPOS.position_nbr = PS_Z_PUF_DAT.position_nbr and ZPOS.Z_TEXT254_3 = PS_Z_PUF_DAT.TRANSACTION_NBR AND ZPOS.Z_TEXT254_4 = 'PUF'                         
	                      		                           AND ZPOS.EFFDT  =                                      
	                      		                              (SELECT MIN(ZPOS_ED.EFFDT) FROM PS_Z_POSITION_DATA ZPOS_ED
	                      		                               WHERE ZPOS_ED.position_nbr = PS_Z_PUF_DAT.position_nbr          
	                      		                               AND  ZPOS_ED.Z_TEXT254_3 = PS_Z_PUF_DAT.TRANSACTION_NBR 
	                      		                               AND ZPOS_ED.Z_TEXT254_4 = 'PUF')
	--                      		                               AND ZPOS_ED.EFFDT >= COALESCE(DATE_FORMAT(PS_AUDIT_Z_MSS_REC_APPR.AUDIT_STAMP,'%Y-%m-%d'),PS_Z_PUF_DAT.REQUEST_DT ) ) 	
	                                   LEFT OUTER JOIN  PS_POSITION_DATA TOPOS on  TOPOS.position_nbr = PS_Z_PUF_DAT.position_nbr               
	                      		                           AND TOPOS.EFFDT  =                                      
	                      		                              (SELECT MAX(POS_ED.EFFDT) FROM PS_POSITION_DATA POS_ED
	                      		                               WHERE POS_ED.position_nbr = PS_Z_PUF_DAT.position_nbr          
	                      		                               AND POS_ED.EFFDT <= ZPOS.EFFDT ) 	
	                                  left outer join nhrdw_custom_xlatitem senscd on senscd.FIELDVALUE = TOPOS.gvt_posn_sens_cd and senscd.FIELDNAME  = 'GVT_POSN_SENS_CD' 
	                                                              AND senscd.EFFDT =
	                                                                      (SELECT MAX(xlat_ED.EFFDT) FROM nhrdw_custom_xlatitem xlat_ED
	                                                                       WHERE xlat_ED.FIELDVALUE = TOPOS.gvt_posn_sens_cd 
	                             		                                        AND xlat_ED.FIELDNAME  = 'GVT_POSN_SENS_CD'  
	                                                                         AND xlat_ED.EFFDT      <= TOPOS.EFFDT)
	                                  left outer join nhrdw_custom_xlatitem invest on invest.FIELDVALUE = senscd.X_FIELDVALUE and invest.FIELDNAME  = senscd.X_FIELDNAME
	                                                              AND invest.EFFDT =
	                                                                      (SELECT MAX(xlat_ED.EFFDT) FROM nhrdw_custom_xlatitem xlat_ED
	                                                                       WHERE xlat_ED.FIELDVALUE = senscd.X_FIELDVALUE
	                             		                                        AND xlat_ED.FIELDNAME  = senscd.X_FIELDNAME
	                                                                         AND xlat_ED.EFFDT      <= TOPOS.EFFDT)
	                                  LEFT OUTER JOIN nhrdw_occ_series_addl_info tooca on tooca.GVT_OCC_SERIES=topos.GVT_OCC_SERIES  and tooca.SETID = dept.SETID                                  
	                                                                         and tooca.EFFDT = (SELECT MAX(tooca_ed.EFFDT)
	                                                  FROM  nhrdw_occ_series_addl_info tooca_ed
	                                                  WHERE  tooca_ed.SETID          = dept.SETID
	                                                  AND    tooca_ed.GVT_OCC_SERIES = topos.GVT_OCC_SERIES    
	                                                  AND    tooca_ed.EFFDT <= topos.effdt )  
	                                   LEFT OUTER JOIN ps_gvt_occupation  toocc ON toocc.GVT_OCC_SERIES = topos.GVT_OCC_SERIES                                                               
	                                    	                                          AND  toocc.EFFDT =                                                                        
	                                                                                             (SELECT MAX(toocc_ed.EFFDT) FROM ps_gvt_occupation toocc_ed            
	                                                                                             WHERE toocc_ed.GVT_OCC_SERIES = topos.GVT_OCC_SERIES                   
	                                                                                               AND toocc_ed.EFFDT     <= topos.effdt )                                      
	                                   LEFT OUTER JOIN PS_SET_CNTRL_REC TOSPC ON       TOSPC.SETCNTRLVALUE = topos.BUSINESS_UNIT
	                                                                  AND TOSPC.RECNAME = 'SUPVSR_LVL_TBL'  
	                                   LEFT OUTER JOIN PS_SUPVSR_LVL_TBL TOSUP ON              TOSUP.SUPV_LVL_ID = topos.SUPV_LVL_ID  and TOSUP.SETID = TOSPC.setid
	                                                                                            AND TOSUP.EFFDT =
	                                                                                                 ( SELECT MAX(TOSUP_ED.EFFDT) FROM PS_SUPVSR_LVL_TBL TOSUP_ED
	                                                                                                   WHERE TOSUP_ED.SETID = TOSPC.setid
	                                                                                                     AND TOSUP_ED.SUPV_LVL_ID = topos.SUPV_LVL_ID
	                                                                                                     AND TOSUP_ED.EFFDT <= topos.effdt )  
	                                   LEFT OUTER JOIN  psxlatitem topat on  topat.FIELDNAME  = 'GVT_PATCOB_CD' and topat.FIELDVALUE = TOOCC.GVT_PATCOB_CD	
	                                                                           AND topat.EFFDT =(SELECT MAX(xlat_ED.EFFDT) FROM psxlatitem xlat_ED
	                                                                                             WHERE xlat_ED.FIELDVALUE = TOOCC.GVT_PATCOB_CD	
			                                                                                       AND xlat_ED.FIELDNAME  = 'GVT_PATCOB_CD' 
	                                                                                               AND xlat_ED.EFFDT       <= topos.effdt)			
	                                   LEFT OUTER JOIN  psxlatitem tosen on  tosen.FIELDNAME  = 'GVT_POSN_SENS_CD' and tosen.FIELDVALUE = topos.GVT_POSN_SENS_CD
	                                                                           AND tosen.EFFDT =(SELECT MAX(xlat_ED.EFFDT) FROM psxlatitem xlat_ED
	                                                                                             WHERE xlat_ED.FIELDVALUE = topos.GVT_POSN_SENS_CD
			                                                                                       AND xlat_ED.FIELDNAME  = 'GVT_POSN_SENS_CD' 
	                                                                                               AND xlat_ED.EFFDT       <= topos.effdt)																					
	                                   LEFT OUTER JOIN PS_GVT_POI_TBL POI on POI.GVT_POI= PS_Z_PUF_DAT.GVT_POI                 
	                                                          AND POI.EFFDT=                                 
	                                                                (SELECT MAX(topoi_ed.EFFDT)                
	                                                                 FROM   PS_GVT_POI_TBL topoi_ed            
	                                                                 WHERE  topoi_ed.GVT_POI   = PS_Z_PUF_DAT.GVT_POI 
	                                                                 AND    topoi_ed.EFFDT    <= COALESCE(PS_AUDIT_Z_MSS_REC_APPR.AUDIT_STAMP,PS_Z_PUF_DAT.REQUEST_DT ) )
	                                LEFT OUTER JOIN nhrdw_hrlinks_employee_completed_history job on job.POSITION_NBR = PS_Z_PUF_DAT.REPORTS_TO
	                            	                	AND job.LATEST_HIRE_DATE = (SELECT MAX(J_ET.LATEST_HIRE_DATE) FROM nhrdw_hrlinks_employee_completed_history J_ET                                                                                                           
	                            	                                 		WHERE J_ET.POSITION_NBR = PS_Z_PUF_DAT.REPORTS_TO                                                                                                                                                                                                                                                       
	                                                                    AND J_ET.SETID_DEPT = job.SETID_DEPT 
	                                                                  ) 
	                            		                 AND job.EFFDT =                                                                                                                                                      
	                                                          			(SELECT MAX(J_ED.EFFDT) FROM nhrdw_hrlinks_employee_completed_history J_ED                                                                                                            
	                                                             			WHERE J_ED.POSITION_NBR = PS_Z_PUF_DAT.REPORTS_TO            
	                                                             	--		  AND J_ED.EMPLID       = job.EMPLID                                                                                                          
	                            	                                --  		AND J_ED.EMPL_RCD       = job.EMPL_RCD   
	                            	                                  		AND J_ED.LATEST_HIRE_DATE = job.LATEST_HIRE_DATE
	                                                                    AND J_ED.SETID_DEPT = job.SETID_DEPT                                                                                                                       			                                                                                                                                    
	                            			                                  AND J_ED.EFFDT <= COALESCE(PS_AUDIT_Z_MSS_REC_APPR.AUDIT_STAMP,PS_Z_PUF_DAT.REQUEST_DT ))                                                                                                                             
	                            	                	AND job.EFFSEQ = (SELECT MAX(J_ES.EFFSEQ) FROM nhrdw_hrlinks_employee_completed_history J_ES                                                                                                           
	                            	                                 		WHERE J_ES.EMPLID       = J_ES.EMPLID    
	                            	                                 		  AND J_ES.POSITION_NBR = PS_Z_PUF_DAT.REPORTS_TO                                                                                                                             
	                                                                		AND J_ES.EMPL_RCD     = J_ES.EMPL_RCD                                                                                                                             
	                                                                    AND J_ES.SETID_DEPT   = job.SETID_DEPT 
	                                                                    AND J_ES.EFFDT        = JOB.EFFDT
	                                                                    AND J_ES.LATEST_HIRE_DATE = job.LATEST_HIRE_DATE 
	                                                                  )  
	/*
	                                 LEFT OUTER JOIN nhrdw_hrlinks_employee_all_history futjob on futjob.GVT_SF52_NBR = CONCAT(PS_Z_PUF_DAT.TRANSACTION_NBR,'U')
	                            		                 AND futjob.EFFDT =                                                                                                                                                      
	                                                          			(SELECT MIN(J_ED.EFFDT) FROM nhrdw_hrlinks_employee_all_history J_ED                                                                                                            
	                                                             			WHERE J_ED.GVT_SF52_NBR = CONCAT(PS_Z_PUF_DAT.TRANSACTION_NBR,'U')
	                                                             --			  AND J_ED.EMPLID         = job.EMPLID                                                                                                              
	                            	                               --   		AND J_ED.EMPL_RCD       = job.EMPL_RCD                                                                                                                      			                                                                                                                                    
	                            			                                  AND J_ED.EFFDT <= COALESCE(PS_AUDIT_Z_MSS_REC_APPR.AUDIT_STAMP,PS_Z_PUF_DAT.REQUEST_DT )) 
	                            	                	AND futjob.EFFSEQ = (SELECT MAX(J_ES.EFFSEQ) FROM nhrdw_hrlinks_employee_all_history J_ES                                                                                                           
	                            	                                 		WHERE J_ES.EMPLID       = futjob.EMPLID    
	                            	                                 		  AND J_ES.GVT_SF52_NBR = CONCAT(PS_Z_PUF_DAT.TRANSACTION_NBR,'U')                                                                                                                   
	                                                                		AND J_ES.EMPL_RCD     = futjob.EMPL_RCD                                                                                                                             
	                                                                    AND J_ES.SETID_DEPT   = futjob.SETID_DEPT 
	                                                                    AND J_ES.EFFDT        = futjob.EFFDT
	                                                                  ) 
	*/
	/*
	                                 LEFT OUTER JOIN nhrdw_hrlinks_employee_all_history futjob on futjob.POSITION_NBR = PS_Z_PUF_DAT.POSITION_NBR
	                            		                 AND futjob.EFFDT =                                                                                                                                                      
	                                                          			(SELECT MIN(J_ED.EFFDT) FROM nhrdw_hrlinks_employee_all_history J_ED                                                                                                            
	                                                             			WHERE J_ED.POSITION_NBR = ZPOS.POSITION_NBR
	                                                             --			  AND J_ED.EMPLID         = job.EMPLID                                                                                                              
	                            	                               --   		AND J_ED.EMPL_RCD       = job.EMPL_RCD                                                                                                                      			                                                                                                                                    
	                            			                                  AND J_ED.EFFDT >= COALESCE(PS_AUDIT_Z_MSS_REC_APPR.AUDIT_STAMP,PS_Z_PUF_DAT.REQUEST_DT )) 
	                            		                 AND futjob.EMPLID =                                                                                                                                                      
	                                                          			(SELECT MAX(J_ED.EMPLID) FROM nhrdw_hrlinks_employee_all_history J_ED                                                                                                            
	                                                             			WHERE J_ED.POSITION_NBR = PS_Z_PUF_DAT.POSITION_NBR
	                                                             --			  AND J_ED.EMPLID         = job.EMPLID                                                                                                              
	                            	                               --   		AND J_ED.EMPL_RCD       = job.EMPL_RCD                                                                                                                      			                                                                                                                                    
	                            			                                  AND J_ED.EFFDT = futjob.EFFDT ) 
	                            	                	AND futjob.EFFSEQ = (SELECT MAX(J_ES.EFFSEQ) FROM nhrdw_hrlinks_employee_all_history J_ES                                                                                                           
	                            	                                 		WHERE J_ES.EMPLID       = futjob.EMPLID    
	                            	                                 		  AND J_ES.POSITION_NBR = PS_Z_PUF_DAT.POSITION_NBR                                                                                                                  
	                                                                		AND J_ES.EMPL_RCD     = futjob.EMPL_RCD                                                                                                                             
	                                                                    AND J_ES.SETID_DEPT   = futjob.SETID_DEPT 
	                                                                    AND J_ES.EFFDT        = futjob.EFFDT
	                                                                  ) 
	*/
	                                  LEFT OUTER JOIN  PS_Z_T38_JOB ON PS_Z_T38_JOB.Z_TRANS_TYPE = 'PUF' and PS_Z_T38_JOB.Z_TRANS_NBR  = PS_Z_PUF_DAT.TRANSACTION_NBR  
	                                                 AND EXISTS ( SELECT 'X' FROM PS_GVT_JOB GJ
	                            	                                 		WHERE GJ.EMPLID       = PS_Z_T38_JOB.EMPLID    
	                                                                		AND GJ.EMPL_RCD     = PS_Z_T38_JOB.EMPL_RCD                                                                                                                             
	                            	                                  		AND GJ.EFFSEQ       = PS_Z_T38_JOB.EFFSEQ          
	                            	                                  		AND GJ.POSITION_NBR = PS_Z_PUF_DAT.POSITION_NBR
	                                                                    AND GJ.EFFDT        = PS_Z_T38_JOB.EFFDT
	                                                                    AND GJ.GVT_WIP_STATUS IN ('PRO','COR','WIP','INI')
	                                                             )  
	                            		                 AND PS_Z_T38_JOB.EFFDT =                                                                                                                                                      
	                                                          			(SELECT MIN(J_ED.EFFDT) FROM PS_Z_T38_JOB J_ED                                                                                                            
	                                                             			WHERE J_ED.Z_TRANS_TYPE = 'PUF'
	                            	                                  		AND J_ED.Z_TRANS_NBR  = PS_Z_PUF_DAT.TRANSACTION_NBR
	                            	                                  		AND J_ED.EFFDT          >= COALESCE(PS_AUDIT_Z_MSS_REC_APPR.AUDIT_STAMP,PS_Z_PUF_DAT.REQUEST_DT )   
	                            	                                  ) 
	/*
	                            		                 AND PS_Z_T38_JOB.EFFDT =                                                                                                                                                      
	                                                          			(SELECT MAX(J_ED.EFFDT) FROM PS_Z_T38_JOB J_ED                                                                                                            
	                                                             			WHERE J_ED.EMPLID         = PS_Z_T38_JOB.EMPLID                                                                                                           
	                            	                                  		AND J_ED.EMPL_RCD       = PS_Z_T38_JOB.EMPL_RCD   
	                            	                                  		AND J_ED.Z_TRANS_TYPE = 'PUF'
	                            	                                  		AND J_ED.Z_TRANS_NBR  = PS_Z_PUF_DAT.TRANSACTION_NBR
	                            	                                  		AND J_ED.EFFDT          >= COALESCE(PS_AUDIT_Z_MSS_REC_APPR.AUDIT_STAMP,PS_Z_PUF_DAT.REQUEST_DT )   
	                            	                                  )  		                                                                                                            			                                                                                                                                    
	*/
	                            	                	AND PS_Z_T38_JOB.EFFSEQ = (SELECT MAX(J_ES.EFFSEQ) FROM PS_Z_T38_JOB J_ES                                                                                                           
	                            	                                 		WHERE J_ES.EMPLID       = PS_Z_T38_JOB.EMPLID    
	                                                                		AND J_ES.EMPL_RCD     = PS_Z_T38_JOB.EMPL_RCD                                                                                                                             
	                            	                                  		AND J_ES.Z_TRANS_TYPE = 'PUF'
	                            	                                  		AND J_ES.Z_TRANS_NBR  = PS_Z_PUF_DAT.TRANSACTION_NBR
	                                                                    AND J_ES.EFFDT        = PS_Z_T38_JOB.EFFDT
	                                                                  ) 
	                                  LEFT OUTER JOIN  nhrdw_hrlinks_employee_all_history futjob on futjob.EMPLID = PS_Z_T38_JOB.EMPLID AND futjob.EMPL_RCD       = PS_Z_T38_JOB.EMPL_RCD  AND  futjob.EFFDT = PS_Z_T38_JOB.EFFDT AND futjob.EFFSEQ = PS_Z_T38_JOB.EFFSEQ
	/*
	                            		                 AND futjob.EFFDT =                                                                                                                                                      
	                                                          			(SELECT MIN(J_ED.EFFDT) FROM nhrdw_hrlinks_employee_all_history J_ED                                                                                                            
	                                                             			WHERE J_ED.EMPLID         = PS_Z_T38_JOB.EMPLID                                                                                                           
	                            	                                  		AND J_ED.EMPL_RCD       = PS_Z_T38_JOB.EMPL_RCD      
	                            	                                  		AND J_ED.EFFDT          >= COALESCE(PS_AUDIT_Z_MSS_REC_APPR.AUDIT_STAMP,PS_Z_PUF_DAT.REQUEST_DT )  
	                            	                                  )  		                                                                                                            			                                                                                                                                    
	                            	                	AND futjob.EFFSEQ = (SELECT MAX(J_ES.EFFSEQ) FROM nhrdw_hrlinks_employee_all_history J_ES                                                                                                           
	                            	                                 		WHERE J_ES.EMPLID       = PS_Z_T38_JOB.EMPLID    
	                                                                		AND J_ES.EMPL_RCD     = PS_Z_T38_JOB.EMPL_RCD                                                                                                                             
	                                                                    AND J_ES.SETID_DEPT   = futjob.SETID_DEPT 
	                                                                    AND J_ES.EFFDT        = futjob.EFFDT
	                                                                  ) 
	*/
	                                 LEFT OUTER JOIN  NHRDW_SF50_TRANSACTION sf50 on sf50.EMPLID = PS_Z_T38_JOB.EMPLID AND sf50.EMPL_RCD       = PS_Z_T38_JOB.EMPL_RCD  AND  sf50.EFFDT = PS_Z_T38_JOB.EFFDT AND sf50.EFFSEQ = PS_Z_T38_JOB.EFFSEQ
	                                 LEFT OUTER JOIN  NHRDW_SF50_TRANSACTION sf50cor  on sf50cor.EMPLID = PS_Z_T38_JOB.EMPLID AND sf50cor.EMPL_RCD       = PS_Z_T38_JOB.EMPL_RCD  AND  sf50cor.EFFDT = sf50.CORRECTED_ACTION_EFFDT AND sf50cor.EFFSEQ = sf50.CORRECTED_ACTION_EFFSEQ
	                                 LEFT OUTER JOIN  NHRDW_STAR_RECRUIT_ACTION star  on star.RPA_NUMBER  = concat(PS_Z_PUF_DAT.TRANSACTION_NBR,'U')
	                            	                	AND star.LASTUPDATETIMESTAMP = (SELECT MAX(J_STAR.LASTUPDATETIMESTAMP) FROM NHRDW_STAR_RECRUIT_ACTION J_STAR                                                                                                         
	                            	                                 	                	WHERE J_STAR.RPA_NUMBER       = star.RPA_NUMBER   )                                                     
	                                 LEFT OUTER JOIN psoprdefn oprzadm on oprzadm.OPRID = PS_Z_PUF_DAT.Z_ADMIN_POC
	                                 LEFT OUTER JOIN psoprdefn oprzalt on oprzalt.OPRID = PS_Z_PUF_DAT.Z_ALT_HIRE_MGR
	                                 LEFT OUTER JOIN psoprdefn oprzhrs on oprzhrs.OPRID = PS_Z_PUF_DAT.Z_HR_SPECIALIST
	                                 LEFT OUTER JOIN psoprdefn oprznrc on oprznrc.OPRID = PS_Z_PUF_DAT.Z_NRC_SPECIALIST
	                       ;    
	                      -- Populate SF52 Requests

	                       call nhrdw_process_log_trk (-7001, 'I', 'Refresh SF52 Requests :  SF52 Requests' );
	                                                       
	                       INSERT INTO NEW_HRDW.NHRDW_SF52_REQUESTS
	                           (  
	                                    CADW_TRANSACTION_NBR                
	                                   ,TRANSACTION_TYPE                     
	                                   ,TRANSACTION_NBR                                                          
	                                   ,TRANSACTION_STATUS_CODE
	                                   ,TRANSACTION_STATUS_DESCR
	                                   ,REQ_FOURDIGIT_FISCAL_YEAR_OF_REQUEST_DT
	                                   ,REQ_FISCAL_YEAR_ACTION_REQUEST_DT                  
	                                   ,REQ_EMPLID                 
	                                   ,REQ_EMPL_RCD               
	                                   ,REQ_ACTION_DT_SS           
	                                   ,REQ_EFFSEQ                 
	                                   ,REQ_ACTION                 
	                                   ,REQ_ACTION_REASON          
	                                   ,REQ_GVT_NOA_CODE           
	                                   ,REQ_Z_AWARD_AMT            
	                                   ,REQ_Z_AWARD_HRS            
	                                   ,REQ_POSITION_NBR           
	                                   ,REQ_JOBCODE                
	                                   ,REQ_DEPTID                 
	                                   ,REQ_LOCATION               
	                                   ,REQ_Z_MSS_GRADE            
	                                   ,REQ_STEP                   
	                                   ,REQ_Z_PD_FUNC              
	                                   ,REQ_GVT_PAR_NTE_DATE       
	                                   ,REQ_Z_ACCT_CD              
	                                   ,REQ_REG_TEMP               
	                                   ,REQ_BARG_UNIT              
	                                   ,REQ_Z_PD_CSBASEID          
	                                   ,REQ_GVT_WORK_SCHED         
	                                   ,REQ_Z_PD_FUNC2             
	                                   ,REQ_GVT_POI                
	                                   ,REQ_REPORTS_TO             
	                                   ,REQ_STD_HOURS              
	                                   ,REQ_EFF_STATUS             
	                                   ,REQ_TRANSACTION_NAME       
	                                   ,REQ_WF_STATUS              
	                                   ,REQ_UPD_BY_USERID          
	                                   ,REQ_UPD_DTTM               
	                                   ,REQ_ORIGINATOR_ID          
	                                   ,REQ_CREATED_DTTM           
	                                   ,REQ_COMMENTS     
	                                   ,REQ_GVT_POI_DESCR                                 
	                                   ,REQ_XREF_EOAWTHREAD_ID        
	                                   ,REQ_XREF_EOAWPRCS_ID          
	                                   ,REQ_XREF_EOAWDEFN_ID            
	                                   ,REQ_XREF_ORIGINATORID           
	                                   ,REQ_XREF_EOAWREQUESTOR_ID      
	                                   ,REQ_XREF_RECNAME              
	                                   ,REQ_XREF_EOAWTHREAD_STATUS    
	                                   ,REQ_XREF_EOAWPARENT_THREAD    
	                                   ,REQ_XREF_EOAWDTTM_MODIFIED    
	                                   ,REQ_XREF_COMMENTS             
	                                   ,REQ_APPR_AUDIT_OPRID          
	                                   ,REQ_APPR_AUDIT_STAMP          
	                                   ,REQ_APPR_AUDIT_ACTN                    
	                                   ,REQ_LATEST_AUDIT_OPRID        
	                                   ,REQ_LATEST_AUDIT_STAMP        
	                                   ,REQ_LATEST_AUDIT_ACTN     
	                                   ,REQ_DEPT_BUSINESS_LINE
	                                   ,REQ_GSA_DEPT_REGION 
	                                   ,REQ_DEPT_DESCR      
	                                   ,REQ_DEPT_GVT_DESCR40
	                                   ,REQ_GVT_PAR_LINE2      
	                                   ,REQ_GVT_PAR_LINE3      
	                                   ,REQ_GVT_PAR_LINE4      
	                                   ,REQ_GVT_PAR_LINE5      
	                                   ,REQ_GVT_PAR_DESCR2     
	                                   ,REQ_GVT_PAR_DESCR3     
	                                   ,REQ_GVT_PAR_DESCR4     
	                                   ,REQ_GVT_PAR_DESCR5 
	                                   ,REQ_Z_POSITION_EFFDT   
	                                   ,REQ_Z_POSITION_TRANS_TYPE       
	                                   ,REQ_Z_POSITION_TRANSACTION_NBR  
	                                   ,REQ_Z_POSITION_CADW_TRANSACTION_NBR 
	                                   ,REQ_Z_POSITION_Z_PD_FUNC                       
	                                   ,REQ_Z_POSITION_Z_ACCT_CD 
	                                   ,REQ_POS_ACTION        
	                                   ,REQ_POS_ACTION_REASON 
	                                   ,REQ_POS_EFFDT                      
	                                   ,REQ_POS_GVT_PAY_PLAN                           
	                                   ,REQ_POS_GRADE                                  
	                                   ,REQ_POS_GVT_TARGET_GRADE                       
	                                   ,REQ_POS_SUPV_LVL_ID                            
	                                   ,REQ_POS_SUPV_LVL_ID_DESCR                      
	                                   ,REQ_POS_DESCRLONG                              
	                                   ,REQ_POS_DESCRSHORT                             
	                                   ,REQ_POS_DESCR                                  
	                                   ,REQ_POS_GVT_POSN_SENS_CD                       
	                                   ,REQ_POS_GVT_POSN_SENS_CD_DESCR                 
	                                   ,REQ_POS_GVT_OCC_SERIES                         
	                                   ,REQ_POS_GVT_OCC_SERIES_DESCR40                 
	                                   ,REQ_POS_GVT_OCC_SERIES_DESCR70                 
	                                   ,REQ_POS_GVT_OCC_SERIES_PATCOB_CD               
	                                   ,REQ_POS_GVT_OCC_SERIES_PATCOB_CD_DESCR         
	                                   ,REQ_POS_GVT_OCC_SERIES_FUNC_CLASS_REQ          
	                                   ,REQ_POS_MCO_GROUP                              
	                                   ,REQ_POS_MCO_ABBREVIATION                       
	                                   ,REQ_POS_OCCUPATIONAL_SERIES_GROUP              
	                                   ,REQ_POS_BPR_GROUP                              
	                                   ,REQ_POS_MCO_OCO_MSO_TYPE                       
	                                   ,REQ_POS_MISSION_FUNCTIONAL_GROUP               
	                                   ,REQ_POS_GVT_ORG_TTL_DESCR                      
	                                   ,REQ_POS_GVT_ORG_TTL_CD                         
	                                   ,REQ_POS_GSA_EXECUTIVE_RESOURCES_FLAG	 
	                                   ,REQ_POS_INVESTIGATION_TYPE                          
	                                   ,REQ_POS_INVESTIGATION_TYPE_DESCR
	                                   ,REQ_POS_STAFFING_INVESTIGATION_TYPE          
	                                   ,REQ_GVT_GEOLOC_CD                               
	                                   ,REQ_GEOLOC_GVT_ST_CNTRY_DESCR                   
	                                   ,REQ_GEOLOC_CITY                                 
	                                   ,REQ_GEOLOC_STATE                                
	                                   ,REQ_GEOLOC_COUNTY                               
	                                   ,REQ_GEOLOC_COUNTRY                              
	                                   ,REQ_GEOLOC_GSA_REGION                           
	                                   ,REQ_GEOLOC_GSA_REGION_DESCR                     
	                                   ,REQ_GVT_MSA                                     
	                                   ,REQ_GVT_CMSA                                    
	                                   ,REQ_GVT_LEOPAY_AREA                             
	                                   ,REQ_GVT_LEOPAY_AREA_EFFDT                       
	                                   ,REQ_GVT_LEOPAY_AREA_DESCR                       
	                                   ,REQ_GVT_LEO_PCT                                 
	                                   ,REQ_GVT_LOCALITY_AREA                           
	                                   ,REQ_GVT_LOCALITY_AREA_EFFDT                     
	                                   ,REQ_GVT_LOCALITY_AREA_DESCR                     
	                                   ,REQ_GVT_LOCALITY_PCT                            
	                                   ,REQ_GVT_IGA_PCT                                 
	                                   ,REQ_NFCOLA_PERCENT   
	                                   ,REQ_REPORTS_TO_EMPLID           
	                                   ,REQ_REPORTS_TO_EMPL_RCD         
	                                   ,REQ_REPORTS_TO_EMPL_NAME        
	                                   ,REQ_REPORTS_TO_EMAIL_ADDR       
	                                   ,REQ_REPORTS_TO_GVT_WIP_STATUS                           
	                                   ,REQ_REPORTS_TO_GVT_WIP_STATUS_DESCR                     
	                                   ,REQ_REPORTS_TO_GVT_STATUS_TYPE                          
	                                   ,REQ_REPORTS_TO_GVT_STATUS_TYPE_DESCR                    
	                                   ,REQ_REPORTS_TO_GVT_NOA_CODE                                                          
	                                   ,REQ_REPORTS_TO_EFFDT                                    
	                                   ,REQ_REPORTS_TO_EFFSEQ                         
	                                   ,ACTION_EMPLID           
	                                   ,ACTION_EMPL_RCD          
	                                   ,ACTION_GVT_WIP_STATUS                     
	                                   ,ACTION_GVT_WIP_STATUS_DESCR               
	                                   ,ACTION_GVT_STATUS_TYPE                    
	                                   ,ACTION_GVT_STATUS_TYPE_DESCR              
	                                   ,ACTION_GVT_NOA_CODE                                                    
	                                   ,ACTION_EFFDT                              
	                                   ,ACTION_EFFSEQ   
	                                   ,SF50_TRANSACTION_CONTROL_ID  
	                                   ,CADW_SF50_TRANSACTION_STATUS
	                            )
	                         SELECT 
	                                     PS_Z_MSS_DAT.TRANSACTION_NBR  
	                                   ,'SF52'                  
	                                   ,PS_Z_MSS_DAT.TRANSACTION_NBR        
	                                   ,CASE WHEN PS_Z_MSS_SF52_XREF.EOAWTHREAD_STATUS = 'D' THEN 'DEN'
	                                         WHEN PS_Z_MSS_SF52_XREF.EOAWTHREAD_STATUS = 'P' THEN 'PEN'
	                                         WHEN FUTJOB.GVT_WIP_STATUS IN ('PRO','COR')  THEN 'PRO'
	                                         WHEN FUTJOB.GVT_WIP_STATUS IN ('WIP','INI')  THEN 'WIP'
	                                         WHEN FUTJOB.GVT_WIP_STATUS IS NULL           THEN 'APP'   ELSE 'APP' END    
	                                   ,CASE WHEN PS_Z_MSS_SF52_XREF.EOAWTHREAD_STATUS = 'D' THEN 'Denied'
	                                         WHEN PS_Z_MSS_SF52_XREF.EOAWTHREAD_STATUS = 'P' THEN 'Pending'
	                                         WHEN FUTJOB.GVT_WIP_STATUS IN ('PRO','COR')  THEN 'Completed'
	                                         WHEN FUTJOB.GVT_WIP_STATUS IN ('WIP','INI')  THEN 'Work-in-Progress'
	                                         WHEN FUTJOB.GVT_WIP_STATUS IS NULL           THEN 'Approved'  ELSE 'Approved' END  
	                                   ,YEAR(DATE_FORMAT(DATE_ADD( PS_Z_MSS_DAT.ACTION_DT_SS ,INTERVAL 3 MONTH) ,'%Y-09-30')) FOURDIGIT_FISCAL_YEAR_OF_EFFDT
	                                   ,CONCAT('FY',SUBSTR(YEAR(DATE_FORMAT(DATE_ADD( PS_Z_MSS_DAT.ACTION_DT_SS ,INTERVAL 3 MONTH) ,'%Y-09-30')),3,2)) FISCAL_YEAR_ACTION_EFFDT
	                                   ,PS_Z_MSS_DAT.EMPLID                 
	                                   ,PS_Z_MSS_DAT.EMPL_RCD               
	                                   ,PS_Z_MSS_DAT.ACTION_DT_SS           
	                                   ,PS_Z_MSS_DAT.EFFSEQ                 
	                                   ,PS_Z_MSS_DAT.ACTION                 
	                                   ,PS_Z_MSS_DAT.ACTION_REASON          
	                                   ,PS_Z_MSS_DAT.GVT_NOA_CODE           
	                                   ,PS_Z_MSS_DAT.Z_AWARD_AMT            
	                                   ,PS_Z_MSS_DAT.Z_AWARD_HRS            
	                                   ,PS_Z_MSS_DAT.POSITION_NBR           
	                                   ,PS_Z_MSS_DAT.JOBCODE                
	                                   ,PS_Z_MSS_DAT.DEPTID                 
	                                   ,PS_Z_MSS_DAT.LOCATION               
	                                   ,PS_Z_MSS_DAT.Z_MSS_GRADE            
	                                   ,PS_Z_MSS_DAT.STEP                   
	                                   ,PS_Z_MSS_DAT.Z_PD_FUNC              
	                                   ,PS_Z_MSS_DAT.GVT_PAR_NTE_DATE       
	                                   ,PS_Z_MSS_DAT.Z_ACCT_CD              
	                                   ,PS_Z_MSS_DAT.REG_TEMP               
	                                   ,PS_Z_MSS_DAT.BARG_UNIT              
	                                   ,PS_Z_MSS_DAT.Z_PD_CSBASEID          
	                                   ,PS_Z_MSS_DAT.GVT_WORK_SCHED         
	                                   ,PS_Z_MSS_DAT.Z_PD_FUNC2             
	                                   ,PS_Z_MSS_DAT.GVT_POI                
	                                   ,PS_Z_MSS_DAT.REPORTS_TO             
	                                   ,PS_Z_MSS_DAT.STD_HOURS              
	                                   ,PS_Z_MSS_DAT.EFF_STATUS             
	                                   ,PS_Z_MSS_DAT.TRANSACTION_NAME       
	                                   ,PS_Z_MSS_DAT.WF_STATUS              
	                                   ,PS_Z_MSS_DAT.UPD_BY_USERID          
	                                   ,PS_Z_MSS_DAT.UPD_DTTM               
	                                   ,PS_Z_MSS_DAT.ORIGINATOR_ID          
	                                   ,PS_Z_MSS_DAT.CREATED_DTTM           
	                                   ,PS_Z_MSS_DAT.COMMENTS   
	                                   ,POI.DESCR                            
	                                   ,PS_Z_MSS_SF52_XREF.EOAWTHREAD_ID                                
	                                   ,PS_Z_MSS_SF52_XREF.EOAWPRCS_ID                                  
	                                   ,PS_Z_MSS_SF52_XREF.EOAWDEFN_ID                                  
	                                   ,PS_Z_MSS_SF52_XREF.ORIGINATORID                                 
	                                   ,PS_Z_MSS_SF52_XREF.EOAWREQUESTOR_ID                             
	                                   ,PS_Z_MSS_SF52_XREF.RECNAME                                      
	                                   ,PS_Z_MSS_SF52_XREF.EOAWTHREAD_STATUS                            
	                                   ,PS_Z_MSS_SF52_XREF.EOAWPARENT_THREAD                            
	                                   ,PS_Z_MSS_SF52_XREF.EOAWDTTM_MODIFIED                            
	                                   ,PS_Z_MSS_SF52_XREF.COMMENTS                                     
	                                   ,PS_AUDIT_Z_MSS_DAT_APPR.AUDIT_OPRID                                  
	                                   ,PS_AUDIT_Z_MSS_DAT_APPR.AUDIT_STAMP                                  
	                                   ,PS_AUDIT_Z_MSS_DAT_APPR.AUDIT_ACTN                                                                   
	                                   ,PS_AUDIT_Z_MSS_DAT_LAT.AUDIT_OPRID                                
	                                   ,PS_AUDIT_Z_MSS_DAT_LAT.AUDIT_STAMP                                
	                                   ,PS_AUDIT_Z_MSS_DAT_LAT.AUDIT_ACTN 
	                                   ,ZDEPT.Z_TEXT30_5      
	                                   ,nhrdw_get_gsa_region('GSASH',PS_Z_MSS_DAT.DEPTID )  
	                                   ,DEPT.DESCR      
	                                   ,DEPT.GVT_DESCR40
	                                   ,DEPT.GVT_PAR_LINE2         
	                                   ,DEPT.GVT_PAR_LINE3         
	                                   ,DEPT.GVT_PAR_LINE4         
	                                   ,DEPT.GVT_PAR_LINE5         
	                                   ,DEPT.GVT_PAR_DESCR2        
	                                   ,DEPT.GVT_PAR_DESCR3        
	                                   ,DEPT.GVT_PAR_DESCR4        
	                                   ,DEPT.GVT_PAR_DESCR5  
	                                   ,ZPOS.EFFDT        
	                                   ,ZPOS.Z_TEXT254_4                                                
	                                   ,ZPOS.Z_TEXT254_3  
	                                   ,CASE WHEN ZPOS.Z_TEXT254_4 = 'SF52' THEN ZPOS.Z_TEXT254_3   
	                                         WHEN ZPOS.Z_TEXT254_4 = 'NEW' THEN CONCAT(ZPOS.Z_TEXT254_3 ,'C')  
	                                         WHEN ZPOS.Z_TEXT254_4 = 'PUF' THEN CONCAT(ZPOS.Z_TEXT254_3 ,'U') ELSE NULL END       
	                                   ,ZPOS.Z_PD_FUNC                           
	                                   ,ZPOS.Z_ACCT_CD     
	                                   ,TOPOS.ACTION        
	                                   ,TOPOS.ACTION_REASON 
	                                   ,TOPOS.EFFDT                       
	                                   ,TOPOS.GVT_PAY_PLAN                                                 
	                                   ,TOPOS.GRADE                                                        
	                                   ,TOPOS.GVT_TARGET_GRADE                                             
	                                   ,TOPOS.SUPV_LVL_ID                                                                           
	                                   ,TOSUP.DESCR                                                                                 
	                                   ,TOPOS.DESCRLONG                                                                             
	                                   ,TOPOS.DESCRSHORT                                                                            
	                                   ,TOPOS.DESCR                                                                                 
	                                   ,TOPOS.GVT_POSN_SENS_CD                                                                      
	                                   ,TOSEN.XLATLONGNAME                                                                          
	                                   ,TOPOS.GVT_OCC_SERIES                                                                        
	                                   ,TOOCC.GVT_DESCR40	                                                                         
	                                   ,TOOCC.GVT_DESCR70	                                                                         
	                                   ,TOOCC.GVT_PATCOB_CD	                                                                       
	                                   ,TOPAT.XLATLONGNAME                                                                          
	                                   ,TOOCC.GVT_FUNC_CLASS_REQ  
	                                   ,TOOCA.MCO_GROUP                                                                             
	                                   ,TOOCA.MCO_ABBREVIATION                                                                      
	                                   ,TOOCA.OCCUPATIONAL_SERIES_GROUP                                                             
	                                   ,TOOCA.BPR_GROUP                                                                             
	                                   ,TOOCA.MCO_OCO_MSO_TYPE                                                                      
	                                   ,TOOCA.MISSION_FUNCTIONAL_GROUP                                                              
	                                   ,TOPOS.GVT_ORG_TTL_DESCR                                              
	                                   ,TOPOS.GVT_ORG_TTL_CD     
	                                   ,CASE WHEN TOPOS.BUSINESS_UNIT in ('GSA01','GSA02') and substr(ZPOS.Z_PD_FUNC,1,1) = 'X' THEN 'Y' ELSE 'N' END   
	                                   ,senscd.X_FIELDVALUE
	                                   ,invest.SHORT_DESC                                                                                            
	                                   ,case when senscd.X_FIELDVALUE = 'T1'  then 'T1-NACI'
	                                         when senscd.X_FIELDVALUE = 'T2S' then 'T2S'
	                                         when senscd.X_FIELDVALUE = 'T3'  then 'T3-ANACI,NACLC Initial'
	                                         when senscd.X_FIELDVALUE = 'T4'  then 'T4-BI'
	                                         when senscd.X_FIELDVALUE = 'T5'  then 'T5-SSBI'
	                                       else null end 
	                                   ,LOC.GVT_GEOLOC_CD	                        	                                               
	                                   ,GEOTAB.GVT_ST_CNTRY_DESCR		                                                               
	                                   ,GEOTAB.CITY	         		                      		                                         
	                                   ,GEOTAB.STATE	         		                   		                                             
	                                   ,GEOTAB.COUNTY	         		                                                                 
	                                   ,GEOTAB.COUNTRY                                                                              
	                                   ,COALESCE(todsrc.X_FIELDVALUE,todsr.X_FIELDVALUE)  	                                         
	                                   ,togsr.SHORT_DESC   	                                                                       
	                                   ,GEOTAB.GVT_MSA	        	                    	                                             
	                                   ,GEOTAB.GVT_CMSA	        	                  	                                             
	                                   ,GEOTAB.GVT_LEOPAY_AREA		                                                                   
	                                   ,LEOAREA.EFFDT	                              	                                             
	                                   ,LEOAREA.DESCR                                                                               
	                                   ,LEOAREA.GVT_LEO_PCT                                                                         
	                                   ,GEOTAB.GVT_LOCALITY_AREA		                	                                               
	                                   ,LOCAREA.EFFDT                                                                               
	                                   ,LOCAREA.DESCR                                                                               
	                                   ,LOCAREA.GVT_LOCALITY_PCT                                                                    
	                                   ,LOCAREA.GVT_IGA_PCT                	                                                       
	                                   ,PYPCT.Z_FOR_DIFF_PCT     
	                                   ,JOB.EMPLID           
	                                   ,JOB.EMPL_RCD                                                            
	                                   ,JOB.NAME        
	                                   ,JOB.EMAIL_ADDR       
	                                   ,JOB.GVT_WIP_STATUS                         
	                                   ,NULL                 
	                                   ,JOB.GVT_STATUS_TYPE                        
	                                   ,NULL                  
	                                   ,JOB.GVT_NOA_CODE                                                        
	                                   ,JOB.EFFDT                                  
	                                   ,JOB.EFFSEQ    
	                                   ,FUTJOB.EMPLID           
	                                   ,FUTJOB.EMPL_RCD            
	                                   ,FUTJOB.GVT_WIP_STATUS                         
	                                   ,NULL                 
	                                   ,FUTJOB.GVT_STATUS_TYPE                        
	                                   ,NULL                  
	                                   ,FUTJOB.GVT_NOA_CODE                                                        
	                                   ,FUTJOB.EFFDT                                  
	                                   ,FUTJOB.EFFSEQ  
	                                   ,COALESCE(SF50COR.SF50_TRANSACTION_CONTROL_ID,SF50.SF50_TRANSACTION_CONTROL_ID)
	                                   ,sf50.TRANSACTION_STATUS
	                       FROM        PS_Z_MSS_DAT
	                                   INNER JOIN PS_Z_MSS_SF52_XREF   ON     PS_Z_MSS_SF52_XREF.TRANSACTION_NBR     =  PS_Z_MSS_DAT.TRANSACTION_NBR   AND PS_Z_MSS_SF52_XREF.EOAWPRCS_ID LIKE '%MSSInitiateSF52'  
	                                   LEFT  JOIN PS_AUDIT_Z_MSS_DAT    PS_AUDIT_Z_MSS_DAT_LAT        ON     PS_AUDIT_Z_MSS_DAT_LAT.TRANSACTION_NBR      =  PS_Z_MSS_DAT.TRANSACTION_NBR    
	                                                                                                  AND    PS_AUDIT_Z_MSS_DAT_LAT.AUDIT_STAMP   = ( SELECT MAX(PS_AUDIT_Z_MSS_DAT_LAT_ED.AUDIT_STAMP) FROM PS_AUDIT_Z_MSS_DAT PS_AUDIT_Z_MSS_DAT_LAT_ED
	                                                                                                                                                         WHERE     PS_Z_MSS_DAT.TRANSACTION_NBR      = PS_AUDIT_Z_MSS_DAT_LAT_ED.TRANSACTION_NBR )
	                                   LEFT  JOIN PS_AUDIT_Z_MSS_DAT    PS_AUDIT_Z_MSS_DAT_APPR       ON     PS_AUDIT_Z_MSS_DAT_APPR.TRANSACTION_NBR     =  PS_Z_MSS_DAT.TRANSACTION_NBR    AND PS_AUDIT_Z_MSS_DAT_APPR.AUDIT_ACTN    = 'A'     
	                                                                                                  AND    PS_AUDIT_Z_MSS_DAT_APPR.AUDIT_STAMP   = ( SELECT MAX(PS_AUDIT_Z_MSS_DAT_APPR_ED.AUDIT_STAMP) FROM PS_AUDIT_Z_MSS_DAT PS_AUDIT_Z_MSS_DAT_APPR_ED
	                                                                                                                                                         WHERE       PS_AUDIT_Z_MSS_DAT_APPR_ED.AUDIT_ACTN    = 'A'
	                                                                                                                                                                AND   PS_Z_MSS_DAT.TRANSACTION_NBR      = PS_AUDIT_Z_MSS_DAT_APPR_ED.TRANSACTION_NBR )
	                                   LEFT   JOIN PS_DEPT_TBL          DEPT  on DEPT.deptid   =  PS_Z_MSS_DAT.deptid and DEPT.SETID   = 'GSASH' and DEPT.EFFDT =  (SELECT MAX(DEP_ED.EFFDT) FROM PS_DEPT_TBL DEP_ED
	                                                                                                                                               WHERE DEP_ED.SETID  = 'GSASH'
	                                                                                                                                                 AND DEP_ED.DEPTID =  PS_Z_MSS_DAT.deptid
	                                                                                                                                                 AND DEP_ED.EFFDT <= PS_Z_MSS_DAT.ACTION_DT_SS)  
	                                   LEFT OUTER JOIN PS_Z_DEPT_TBL ZDEPT ON ZDEPT.SETID = 'GSASH' AND ZDEPT.DEPTID =  PS_Z_MSS_DAT.DEPTID                    
	                                                                          AND   ZDEPT.EFFDT = 
	                                                                                        (SELECT MAX(ZDEPT_ED.EFFDT) FROM ps_dept_tbl ZDEPT_ED 
	                                                                                          WHERE ZDEPT_ED.DEPTID =  PS_Z_MSS_DAT.DEPTID
	                                                                                            AND ZDEPT_ED.SETID  = 'GSASH'                     
	                                                                                            AND ZDEPT_ED.EFFDT <= PS_Z_MSS_DAT.ACTION_DT_SS)
	                                  LEFT OUTER JOIN ps_location_tbl     LOC     ON  LOC.LOCATION =  PS_Z_MSS_DAT.LOCATION                              
	                                                                               AND LOC.SETID    = 'GSASH'       
	                                  	                                           AND LOC.EFFDT    = (SELECT MAX(LOC_ED.EFFDT) 
	                                  	                                                                  FROM ps_location_tbl LOC_ED              
	                                  		                                                              	WHERE LOC_ED.LOCATION  =  PS_Z_MSS_DAT.LOCATION                
	                                                                                                        AND LOC_ED.SETID     = 'GSASH'                                                  
	                                  		                                                                	AND LOC_ED.EFFDT <=PS_Z_MSS_DAT.ACTION_DT_SS   ) 
	                                  LEFT OUTER JOIN  PS_GVT_GEOLOC_TBL GEOTAB on GEOTAB.GVT_GEOLOC_CD = LOC.GVT_GEOLOC_CD
	                                  	                                      AND GEOTAB.EFFDT = (SELECT MAX(GEOTAB_ED.EFFDT) FROM PS_GVT_GEOLOC_TBL GEOTAB_ED
	                                                                                                WHERE GEOTAB_ED.GVT_GEOLOC_CD = LOC.GVT_GEOLOC_CD
	                                                                                                AND   GEOTAB_ED.EFFDT     <= PS_Z_MSS_DAT.ACTION_DT_SS )                            
	                                 LEFT OUTER JOIN  nhrdw_custom_xlatitem todsr on  todsr.FIELDNAME  = 'GSA_DUTY_STATION_REGION' and todsr.FIELDVALUE = SUBSTR(LOC.GVT_GEOLOC_CD,1,2) and  todsr.X_FIELDNAME    = 'GSA_REGION'
	                                                                         AND todsr.EFFDT =(SELECT MAX(todsr_ED.EFFDT) FROM nhrdw_custom_xlatitem todsr_ED
	                                                                                           WHERE todsr_ED.FIELDVALUE = SUBSTR(LOC.GVT_GEOLOC_CD,1,2)
			                                                                                     AND todsr_ED.X_FIELDNAME  = 'GSA_REGION' 
			                                                                                     and todsr_ED.FIELDNAME    = 'GSA_DUTY_STATION_REGION'
	                                                                                             AND todsr_ED.EFFDT       <= PS_Z_MSS_DAT.ACTION_DT_SS)
	                                 LEFT OUTER JOIN nhrdw_custom_xlatitem todsrc on todsrc.FIELDNAME      = 'GSA_DUTY_STATION_REGION_BY_CODE' AND todsrc.FIELDVALUE     = LOC.GVT_GEOLOC_CD AND todsrc.X_FIELDNAME    = 'GSA_REGION'
	                                           AND todsrc.EFFDT =
	                                                              (SELECT MAX(xlat_ED.EFFDT) FROM nhrdw_custom_xlatitem xlat_ED
	                                                               WHERE xlat_ED.FIELDVALUE     = LOC.GVT_GEOLOC_CD
		                                                	            AND xlat_ED.FIELDNAME      = 'GSA_DUTY_STATION_REGION_BY_CODE'
		                                                             	and xlat_ED.X_FIELDNAME    = 'GSA_REGION'
	                                                                AND xlat_ED.EFFDT       <= PS_Z_MSS_DAT.ACTION_DT_SS)                           
	                                  LEFT OUTER JOIN  nhrdw_custom_xlatitem togsr on  togsr.FIELDNAME  = 'GSA_REGION' and togsr.FIELDVALUE = COALESCE(todsrc.X_FIELDVALUE,todsr.X_FIELDVALUE)
	                                                             AND togsr.EFFDT =(SELECT MAX(togsr_ED.EFFDT) FROM nhrdw_custom_xlatitem togsr_ED
	                                                                               WHERE togsr_ED.FIELDVALUE = COALESCE(todsrc.X_FIELDVALUE,todsr.X_FIELDVALUE)
			                                                                         AND togsr_ED.FIELDNAME  = 'GSA_REGION' 
	                                                                                 AND togsr_ED.EFFDT       <= PS_Z_MSS_DAT.ACTION_DT_SS)	
	                                  LEFT OUTER JOIN   PS_GVT_LEOAREA_TBL LEOAREA ON LEOAREA.GVT_LEOPAY_AREA = GEOTAB.GVT_LEOPAY_AREA
	                                                                            AND LEOAREA.EFFDT = (SELECT MAX(LEOAREA_ED.EFFDT) 
	                                                                                                 FROM   PS_GVT_LEOAREA_TBL LEOAREA_ED
	                                                                                                WHERE   LEOAREA_ED.GVT_LEOPAY_AREA = GEOTAB.GVT_LEOPAY_AREA
	                                                                                                  AND   LEOAREA_ED.EFFDT <= PS_Z_MSS_DAT.ACTION_DT_SS )      	         
	                                  LEFT OUTER JOIN  PS_GVT_LOCAREA_TBL LOCAREA ON  LOCAREA.GVT_LOCALITY_AREA = GEOTAB.GVT_LOCALITY_AREA 
	                                                                           AND  LOCAREA.EFFDT = (SELECT MAX(LOCAREA_ED.EFFDT) 
	                                                                                                 FROM   PS_GVT_LOCAREA_TBL LOCAREA_ED 
	                                                                                                 WHERE  LOCAREA_ED.GVT_LOCALITY_AREA = GEOTAB.GVT_LOCALITY_AREA
	                                                                                                   AND    LOCAREA_ED.EFFDT <= PS_Z_MSS_DAT.ACTION_DT_SS ) 
	                                  LEFT OUTER JOIN PS_Z_LOC_PYPCT_TBL   PYPCT ON    PYPCT.LOCATION = LOC.LOCATION                              
	                                                                               AND PYPCT.SETID    = LOC.SETID  
	                                                                               AND PYPCT.eff_status = 'A'
	                                                                               AND PYPCT.ERNCD    = 'COL'         
	                                  	                                           AND PYPCT.EFFDT    = (SELECT MAX(PYPCT_ED.EFFDT) 
	                                  	                                                                  FROM PS_Z_LOC_PYPCT_TBL PYPCT_ED             
	                                  		                                                              	WHERE PYPCT_ED.LOCATION  =  PS_Z_MSS_DAT.LOCATION                          
	                                                                                                        AND PYPCT_ED.SETID     = 'GSASH'    
	                                                                                                        AND PYPCT_ED.eff_status = 'A'
	                                                                                                        AND PYPCT_ED.ERNCD    = 'COL'                                                   
	                                  		                                                                	AND PYPCT_ED.EFFDT <= PS_Z_MSS_DAT.ACTION_DT_SS )                                   		                                                                	
	                                   LEFT OUTER JOIN  PS_Z_POSITION_DATA ZPOS on  ZPOS.position_nbr =  PS_Z_MSS_DAT.position_nbr and ZPOS.Z_TEXT254_3 =  PS_Z_MSS_DAT.TRANSACTION_NBR AND ZPOS.Z_TEXT254_4 = 'NEW'                         
	                      		                           AND ZPOS.EFFDT  =                                      
	                      		                              (SELECT MIN(ZPOS_ED.EFFDT) FROM PS_Z_POSITION_DATA ZPOS_ED
	                      		                               WHERE ZPOS_ED.position_nbr =  PS_Z_MSS_DAT.position_nbr          
	                      		                               AND  ZPOS_ED.Z_TEXT254_3 =  PS_Z_MSS_DAT.TRANSACTION_NBR 
	                      		                               AND ZPOS_ED.Z_TEXT254_4 = 'NEW'   )
	--                      		                               AND ZPOS_ED.EFFDT >= PS_Z_MSS_DAT.ACTION_DT_SS ) 	
	                                   LEFT OUTER JOIN  PS_POSITION_DATA TOPOS on  TOPOS.position_nbr =  PS_Z_MSS_DAT.position_nbr               
	                      		                           AND TOPOS.EFFDT  =                                      
	                      		                              (SELECT MAX(POS_ED.EFFDT) FROM PS_POSITION_DATA POS_ED
	                      		                               WHERE POS_ED.position_nbr =  PS_Z_MSS_DAT.position_nbr          
	                      		                               AND POS_ED.EFFDT <= ZPOS.EFFDT ) 	
	                                  left outer join nhrdw_custom_xlatitem senscd on senscd.FIELDVALUE = TOPOS.gvt_posn_sens_cd and senscd.FIELDNAME  = 'GVT_POSN_SENS_CD' 
	                                                              AND senscd.EFFDT =
	                                                                      (SELECT MAX(xlat_ED.EFFDT) FROM nhrdw_custom_xlatitem xlat_ED
	                                                                       WHERE xlat_ED.FIELDVALUE = TOPOS.gvt_posn_sens_cd 
	                             		                                        AND xlat_ED.FIELDNAME  = 'GVT_POSN_SENS_CD'  
	                                                                         AND xlat_ED.EFFDT      <= TOPOS.EFFDT)
	                                  left outer join nhrdw_custom_xlatitem invest on invest.FIELDVALUE = senscd.X_FIELDVALUE and invest.FIELDNAME  = senscd.X_FIELDNAME
	                                                              AND invest.EFFDT =
	                                                                      (SELECT MAX(xlat_ED.EFFDT) FROM nhrdw_custom_xlatitem xlat_ED
	                                                                       WHERE xlat_ED.FIELDVALUE = senscd.X_FIELDVALUE
	                             		                                        AND xlat_ED.FIELDNAME  = senscd.X_FIELDNAME
	                                                                         AND xlat_ED.EFFDT      <= TOPOS.EFFDT)
	                                  LEFT OUTER JOIN nhrdw_occ_series_addl_info tooca on tooca.GVT_OCC_SERIES=topos.GVT_OCC_SERIES  and tooca.SETID = dept.SETID                                  
	                                                                         and tooca.EFFDT = (SELECT MAX(tooca_ed.EFFDT)
	                                                  FROM  nhrdw_occ_series_addl_info tooca_ed
	                                                  WHERE  tooca_ed.SETID          = dept.SETID
	                                                  AND    tooca_ed.GVT_OCC_SERIES = topos.GVT_OCC_SERIES    
	                                                  AND    tooca_ed.EFFDT <= topos.effdt )  
	                                   LEFT OUTER JOIN ps_gvt_occupation  toocc ON toocc.GVT_OCC_SERIES = topos.GVT_OCC_SERIES                                                               
	                                    	                                          AND  toocc.EFFDT =                                                                        
	                                                                                             (SELECT MAX(toocc_ed.EFFDT) FROM ps_gvt_occupation toocc_ed            
	                                                                                             WHERE toocc_ed.GVT_OCC_SERIES = topos.GVT_OCC_SERIES                   
	                                                                                               AND toocc_ed.EFFDT     <= topos.effdt )                                      
	                                   LEFT OUTER JOIN PS_SET_CNTRL_REC TOSPC ON       TOSPC.SETCNTRLVALUE = topos.BUSINESS_UNIT
	                                                                  AND TOSPC.RECNAME = 'SUPVSR_LVL_TBL'  
	                                   LEFT OUTER JOIN PS_SUPVSR_LVL_TBL TOSUP ON              TOSUP.SUPV_LVL_ID = topos.SUPV_LVL_ID  and TOSUP.SETID = TOSPC.setid
	                                                                                            AND TOSUP.EFFDT =
	                                                                                                 ( SELECT MAX(TOSUP_ED.EFFDT) FROM PS_SUPVSR_LVL_TBL TOSUP_ED
	                                                                                                   WHERE TOSUP_ED.SETID = TOSPC.setid
	                                                                                                     AND TOSUP_ED.SUPV_LVL_ID = topos.SUPV_LVL_ID
	                                                                                                     AND TOSUP_ED.EFFDT <= topos.effdt )  
	                                   LEFT OUTER JOIN  psxlatitem topat on  topat.FIELDNAME  = 'GVT_PATCOB_CD' and topat.FIELDVALUE = TOOCC.GVT_PATCOB_CD	
	                                                                           AND topat.EFFDT =(SELECT MAX(xlat_ED.EFFDT) FROM psxlatitem xlat_ED
	                                                                                             WHERE xlat_ED.FIELDVALUE = TOOCC.GVT_PATCOB_CD	
			                                                                                       AND xlat_ED.FIELDNAME  = 'GVT_PATCOB_CD' 
	                                                                                               AND xlat_ED.EFFDT       <= topos.effdt)			
	                                   LEFT OUTER JOIN  psxlatitem tosen on  tosen.FIELDNAME  = 'GVT_POSN_SENS_CD' and tosen.FIELDVALUE = topos.GVT_POSN_SENS_CD
	                                                                           AND tosen.EFFDT =(SELECT MAX(xlat_ED.EFFDT) FROM psxlatitem xlat_ED
	                                                                                             WHERE xlat_ED.FIELDVALUE = topos.GVT_POSN_SENS_CD
			                                                                                       AND xlat_ED.FIELDNAME  = 'GVT_POSN_SENS_CD' 
	                                                                                               AND xlat_ED.EFFDT       <= topos.effdt)																					
	                                   LEFT OUTER JOIN PS_GVT_POI_TBL POI on POI.GVT_POI=  PS_Z_MSS_DAT.GVT_POI                 
	                                                          AND POI.EFFDT=                                 
	                                                                (SELECT MAX(topoi_ed.EFFDT)                
	                                                                 FROM   PS_GVT_POI_TBL topoi_ed            
	                                                                 WHERE  topoi_ed.GVT_POI   =  PS_Z_MSS_DAT.GVT_POI 
	                                                                 AND    topoi_ed.EFFDT    <= PS_Z_MSS_DAT.ACTION_DT_SS )
	                                LEFT OUTER JOIN nhrdw_hrlinks_employee_completed_history job on job.POSITION_NBR =  PS_Z_MSS_DAT.REPORTS_TO
	                            	                	AND job.LATEST_HIRE_DATE = (SELECT MAX(J_ET.LATEST_HIRE_DATE) FROM nhrdw_hrlinks_employee_completed_history J_ET                                                                                                           
	                            	                                 		WHERE J_ET.POSITION_NBR =  PS_Z_MSS_DAT.REPORTS_TO                                                                                                                                                                                                                                                       
	                                                                    AND J_ET.SETID_DEPT = job.SETID_DEPT 
	                                                                  ) 
	                            		                 AND job.EFFDT =                                                                                                                                                      
	                                                          			(SELECT MAX(J_ED.EFFDT) FROM nhrdw_hrlinks_employee_completed_history J_ED                                                                                                            
	                                                             			WHERE J_ED.POSITION_NBR =  PS_Z_MSS_DAT.REPORTS_TO            
	                                                             	--		  AND J_ED.EMPLID       = job.EMPLID                                                                                                          
	                            	                                --  		AND J_ED.EMPL_RCD       = job.EMPL_RCD   
	                            	                                  		AND J_ED.LATEST_HIRE_DATE = job.LATEST_HIRE_DATE
	                                                                    AND J_ED.SETID_DEPT = job.SETID_DEPT                                                                                                                       			                                                                                                                                    
	                            			                                  AND J_ED.EFFDT <= PS_Z_MSS_DAT.ACTION_DT_SS)                                                                                                                             
	                            	                	AND job.EFFSEQ = (SELECT MAX(J_ES.EFFSEQ) FROM nhrdw_hrlinks_employee_completed_history J_ES                                                                                                           
	                            	                                 		WHERE J_ES.EMPLID       = J_ES.EMPLID    
	                            	                                 		  AND J_ES.POSITION_NBR =  PS_Z_MSS_DAT.REPORTS_TO                                                                                                                             
	                                                                		AND J_ES.EMPL_RCD     = J_ES.EMPL_RCD                                                                                                                             
	                                                                    AND J_ES.SETID_DEPT   = job.SETID_DEPT 
	                                                                    AND J_ES.EFFDT        = JOB.EFFDT
	                                                                    AND J_ES.LATEST_HIRE_DATE = job.LATEST_HIRE_DATE 
	                                                                  )  
	                                  LEFT OUTER JOIN  PS_Z_T38_JOB ON PS_Z_T38_JOB.Z_TRANS_TYPE = 'SF52' and PS_Z_T38_JOB.Z_TRANS_NBR  = PS_Z_MSS_DAT.TRANSACTION_NBR
	                                                 AND EXISTS ( SELECT 'X' FROM PS_GVT_JOB GJ
	                            	                                 		WHERE GJ.EMPLID       = PS_Z_T38_JOB.EMPLID    
	                                                                		AND GJ.EMPL_RCD     = PS_Z_T38_JOB.EMPL_RCD                                                                                                                             
	                            	                                  		AND GJ.EFFSEQ       = PS_Z_T38_JOB.EFFSEQ          
	                                                                    AND GJ.EFFDT        = PS_Z_T38_JOB.EFFDT
	                                                                    AND GJ.GVT_WIP_STATUS IN ('PRO','COR','WIP','INI')
	                                                             )  
	                            		                 AND PS_Z_T38_JOB.EFFDT =                                                                                                                                                      
	                                                          			(SELECT MIN(J_ED.EFFDT) FROM PS_Z_T38_JOB J_ED                                                                                                            
	                                                             			WHERE J_ED.Z_TRANS_TYPE = 'SF52'
	                            	                                  		AND J_ED.Z_TRANS_NBR  = PS_Z_MSS_DAT.TRANSACTION_NBR
	                            	                                  		AND J_ED.EFFDT          >= PS_Z_MSS_DAT.ACTION_DT_SS     
	                            	                                  ) 
	                            		                 AND PS_Z_T38_JOB.EMPLID =                                                                                                                                                      
	                                                          			(SELECT MAX(J_EX.EMPLID) FROM PS_Z_T38_JOB J_EX                                                                                                            
	                                                             			WHERE J_EX.Z_TRANS_TYPE = 'SF52'
	                            	                                  		AND J_EX.Z_TRANS_NBR  = PS_Z_MSS_DAT.TRANSACTION_NBR
	                            	                                  		AND J_EX.EFFDT          = PS_Z_T38_JOB.EFFDT
	                            	                                  ) 
	/*
	                            		                 AND PS_Z_T38_JOB.EFFDT =                                                                                                                                                      
	                                                          			(SELECT MAX(J_ED.EFFDT) FROM PS_Z_T38_JOB J_ED                                                                                                            
	                                                             			WHERE J_ED.EMPLID         = PS_Z_T38_JOB.EMPLID                                                                                                           
	                            	                                  		AND J_ED.EMPL_RCD       = PS_Z_T38_JOB.EMPL_RCD   
	                            	                                  		AND J_ED.Z_TRANS_TYPE = 'SF52'
	                            	                                  		AND J_ED.Z_TRANS_NBR  = PS_Z_MSS_DAT.TRANSACTION_NBR
	                            	                                  		AND J_ED.EFFDT          >= PS_Z_MSS_DAT.ACTION_DT_SS   
	                            	                                  )  		                                                                                                            			                                                                                                                                    
	*/
	                            	                	AND PS_Z_T38_JOB.EFFSEQ = (SELECT MAX(J_ES.EFFSEQ) FROM PS_Z_T38_JOB J_ES                                                                                                           
	                            	                                 		WHERE J_ES.EMPLID       = PS_Z_T38_JOB.EMPLID    
	                                                                		AND J_ES.EMPL_RCD     = PS_Z_T38_JOB.EMPL_RCD                                                                                                                             
	                            	                                  		AND J_ES.Z_TRANS_TYPE = 'SF52'
	                            	                                  		AND J_ES.Z_TRANS_NBR  = PS_Z_MSS_DAT.TRANSACTION_NBR
	                                                                    AND J_ES.EFFDT        = PS_Z_T38_JOB.EFFDT
	                                                                  ) 
	                                 LEFT OUTER JOIN nhrdw_hrlinks_employee_all_history futjob on futjob.EMPLID = PS_Z_MSS_DAT.EMPLID  AND futjob.EMPL_RCD = PS_Z_MSS_DAT.EMPL_RCD   AND  futjob.EFFDT = PS_Z_T38_JOB.EFFDT AND futjob.EFFSEQ = PS_Z_T38_JOB.EFFSEQ 

	/*                 
	                            		                 AND futjob.EFFDT =                                                                                                                                                      
	                                                          			(SELECT MIN(J_ED.EFFDT) FROM nhrdw_hrlinks_employee_all_history J_ED                                                                                                            
	                                                             			WHERE J_ED.GVT_SF52_NBR =  REPLACE(PS_Z_MSS_DAT.TRANSACTION_NBR,' ','')
	                                                             			  AND J_ED.EMPLID         = PS_Z_MSS_DAT.EMPLID                                                                                                              
	                            	                                  		AND J_ED.EMPL_RCD       = PS_Z_MSS_DAT.EMPL_RCD 
	                            	                                  		AND J_ED.SETID_DEPT     = futjob.SETID_DEPT                                                                                                                      			                                                                                                                                    
	                            			                                  AND J_ED.EFFDT >= PS_Z_MSS_DAT.ACTION_DT_SS) 
	                            	                	AND futjob.EFFSEQ = (SELECT MAX(J_ES.EFFSEQ) FROM nhrdw_hrlinks_employee_all_history J_ES                                                                                                           
	                            	                                 		WHERE J_ES.EMPLID       = PS_Z_MSS_DAT.EMPLID    
	                            	                                 		  AND J_ES.GVT_SF52_NBR = REPLACE(PS_Z_MSS_DAT.TRANSACTION_NBR,' ','')                                                                                                         
	                                                                		AND J_ES.EMPL_RCD     = PS_Z_MSS_DAT.EMPL_RCD                                                                                                                             
	                                                                    AND J_ES.SETID_DEPT   = futjob.SETID_DEPT 
	                                                                    AND J_ES.EFFDT        = futjob.EFFDT
	                                                                  ) 
	*/
	                                 LEFT OUTER JOIN  NHRDW_SF50_TRANSACTION sf50 on sf50.EMPLID = PS_Z_T38_JOB.EMPLID AND sf50.EMPL_RCD       = PS_Z_T38_JOB.EMPL_RCD  AND  sf50.EFFDT = PS_Z_T38_JOB.EFFDT AND sf50.EFFSEQ = PS_Z_T38_JOB.EFFSEQ
	                                 LEFT OUTER JOIN  NHRDW_SF50_TRANSACTION sf50cor  on sf50cor.EMPLID = PS_Z_T38_JOB.EMPLID AND sf50cor.EMPL_RCD       = PS_Z_T38_JOB.EMPL_RCD  AND  sf50cor.EFFDT = sf50.CORRECTED_ACTION_EFFDT AND sf50cor.EFFSEQ = sf50.CORRECTED_ACTION_EFFSEQ
	;       
                 
                      call nhrdw_process_log_trk (-7001, 'I', 'Refresh SF50 Transaction : Process Completed' );

  commit;  
                                                                                                                                                                                                                                                                                                                                                                                                                                                              
end$$
DELIMITER ;
